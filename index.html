<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TDTTI THURAVOOR - USS Portal</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
:root {
--primary: #4361ee; --secondary: #3f37c9; --accent: #4cc9f0;
--success: #4caf50; --error: #f44336; --bg: #f0f2f5;
--glass: rgba(255, 255, 255, 0.9); --shadow: 0 8px 32px rgba(0,0,0,0.1);
}
* { box-sizing: border-box; font-family: 'Noto Sans Malayalam', 'Noto Sans Arabic', 'Inter', sans-serif;
-webkit-tap-highlight-color: transparent;}

  

body {
margin: 0; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
background-attachment: fixed; min-height: 100vh; color: #333; display: flex; flex-direction: column;
}

.app-container { width:100%; max-width: 1200px; margin: 0 auto; padding: 15px; flex: 1; }

/* Requirement 1: Sticky Navigation */
.sticky-nav-wrapper {
position: sticky; top: 0; z-index: 9999;
background: rgba(245, 247, 250, 0.85); backdrop-filter: blur(12px);
margin: -15px -15px 15px -15px; padding: 15px 15px 5px 15px;
border-bottom: 1px solid rgba(0,0,0,0.05);
}

.glass-card { background: var(--glass); backdrop-filter: blur(10px); border-radius: 20px; border: 1px solid rgba(255,255,255,0.3); box-shadow: var(--shadow); padding: clamp(15px, 5vw, 30px); margin-bottom: 20px; }

.school-logo { width: 200px; height: 200px; margin: 0 auto 15px; background: #fff; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 10px rgba(0,0,0,0.1); overflow: hidden; }
.school-logo img { width: 90%; height: 90%; object-fit: contain; }

nav { display: none; gap: 10px; margin-bottom: 15px; justify-content: center; overflow-x: auto; padding-bottom: 5px; scrollbar-width: none; align-items: center;}
nav::-webkit-scrollbar { display: none; }

nav button { padding: 10px 20px; border: none; border-radius: 12px; cursor: pointer; background: white; color: var(--primary); font-weight: 600; transition: 0.3s; white-space: nowrap; box-shadow: 0 4px 6px rgba(0,0,0,0.05); font-size: clamp(0.8rem, 2.5vw, 1rem); }
nav button:hover, nav button.active-nav { background: var(--primary); color: white; }

/* Requirement 4: Timer in Nav */
#nav-timer {
display: none; background: green; color: #fff; padding: 8px 15px;
border-radius: 10px; font-weight: 800; font-family: monospace; font-size: 1.1rem;
border: 2px solid var(--accent);
}
.timer-warn { background: var(--error) !important; animation: blinker 1s linear infinite; }
@keyframes blinker { 50% { opacity: 0.5; } }

#user-profile { display: none; align-items: center; justify-content: space-between; background: var(--primary); color: white; padding: 10px 20px; border-radius: 15px; margin-bottom: 10px; }

.summary-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 12px; margin: 20px 0; }
@media (max-width: 480px) { .summary-grid { grid-template-columns: repeat(2, 1fr); } }
  /* Mobile First (phones) */
@media (max-width: 600px) {

  .app-container {
    padding: 10px;
  }

  .school-logo {
    width: 140px;
    height: 140px;
  }

  h1 {
    font-size: 1.3rem !important;
  }

  h3 {
    font-size: 1rem !important;
  }

  nav {
    flex-wrap: nowrap;
    justify-content: flex-start;
  }

  nav button {
    padding: 8px 14px;
    font-size: 0.75rem;
  }

  #nav-timer {
    font-size: 0.9rem;
    padding: 6px 10px;
  }

  .glass-card {
    border-radius: 16px;
    padding: 14px;
  }

  .summary-grid {
    grid-template-columns: repeat(2, 1fr);
  }

  table {
  width: auto;        /* or keep width: 100% */
  border-collapse: collapse;
  min-width: unset;   /* remove min-width */
  max-width: 100%;    /* prevent overflow */
}


  canvas {
    width: 100% !important;
  }
}

/* Tablets */
@media (min-width: 601px) and (max-width: 1024px) {

  .app-container {
    max-width: 95%;
  }

  nav button {
    font-size: 0.85rem;
  }

  .school-logo {
    width: 170px;
    height: 170px;
  }
}

/* Large Screens / Desktop */
@media (min-width: 1025px) {

  .app-container {
    max-width: 1200px;
  }

  nav {
    justify-content: center;
  }

}

canvas { width: 100% !important; height: auto !important; }

#msg-overlay { display: none; position: fixed; inset: 0; background: rgba(255,255,255,0.8); backdrop-filter: blur(8px); z-index: 100000; justify-content: center; align-items: center; flex-direction: column; padding: 20px; }
.spinner { width: 60px; height: 60px; border: 6px solid #f3f3f3; border-top: 6px solid var(--primary); border-radius: 50%; animation: spin 1s linear infinite; }
@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

input, select, textarea { width: 100%; padding: 14px; margin: 10px 0; border: 2px solid #eee; border-radius: 12px; font-size: 1rem; background: #fafafa; outline: none; }
.btn-main { width: 100%; padding: 16px; border: none; border-radius: 12px; background: var(--primary); color: white; font-size: 1.1rem; font-weight: 700; cursor: pointer; transition: 0.3s; }
.q-card { background: white; padding: 18px; border-radius: 15px; margin-bottom: 15px; border-left: 5px solid var(--primary); box-shadow: 0 2px 10px rgba(0,0,0,0.05); }


.tab { display: none; animation: fadeIn 0.4s ease; }
.active { display: block; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

/* Stylish grade badge */
.grade-badge { background: var(--accent); color: white; padding: 5px 15px; border-radius: 50px; font-weight: 800; font-size: 1.5rem; box-shadow: 0 4px 10px rgba(76, 201, 240, 0.4); }
.q-card input[type="radio"] {
display: none;
}

/* Make option fully clickable */
.option-label {
display: block;
padding: 14px;
margin: 6px 0;
background: #f9f9f9;
border-radius: 12px;
cursor: pointer;
font-size: 0.9rem;
border: 2px solid transparent;
transition: all 0.2s ease;
}

/* Hover / touch feedback */
.option-label:hover {
background: #eef2ff;
}

/* Selected option style */
.q-card input[type="radio"]:checked + .option-label {
background: #e0e7ff;
border-color: var(--primary);
font-weight: 700;
}
  .rtl-arabic {
  direction: rtl;
  text-align: right;
}
/* Responsive Table Container */


#attendance-table {
  width: 50%;
  border-collapse: collapse;
  font-size: 0.9rem;
  table-layout: fixed;
   
}




#attendance-table th, #attendance-table td {
  padding: 10px;
  border: 1px solid #ddd;
  text-align: left;
  white-space: nowrap; /* Prevent text wrap for better fitting */
  max-width: 1%; /* Helps columns shrink to fit content */
}

.table-container-attendance {
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
  max-width: 100%;
}


/* Smaller font and padding on very small screens */
@media (max-width: 480px) {
  #attendance-table th, #attendance-table td {
    padding: 8px 6px;
    font-size: 0.8rem;
  }
}

.table-container {
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
  border-radius: 15px;
  border: 1px solid #eee;
  background: white;
  max-width: 100%;
}

/* For the Global Performance Table specifically */
#ins-table {
  width: auto;         /* adapt to content */
  min-width: unset;    /* remove fixed min width */
  border-collapse: collapse;
  font-size: 0.9rem;
  table-layout: auto;
  max-width: 100%;
}

#ins-table th, #ins-table td {
  padding: 10px;
  border: 1px solid #ddd;
  text-align: center;
  white-space: nowrap;   /* Prevent text wrap */
}

/* Responsive font and padding for smaller screens */
@media (max-width: 480px) {
  #ins-table th, #ins-table td {
    padding: 6px 8px;
    font-size: 0.75rem;
  }
}

</style>
</head>
</head>
<body onload="checkPersistentLogin()">

<div id="msg-overlay">
<div id="loader-content">
<div class="spinner"></div>
<h3 id="loader-text" style="color: var(--primary);">Connecting...</h3>
</div>
<div id="status-content" style="display: none; text-align: center;" class="glass-card">
<div id="status-icon" style="font-size: 50px; margin-bottom: 10px;"></div>
<h2 id="status-title"></h2>
<p id="status-msg" style="margin-bottom: 20px;"></p>
<button class="btn-main" onclick="closeMsg()" style="width: auto; padding: 10px 30px;">Continue</button>
</div>
</div>

<div class="app-container">
<div id="sticky-header-container" class="sticky-nav-wrapper" style="display:none;">
<div id="user-profile">
<div style="display: flex; align-items: center; gap: 12px;">
<div style="width:40px; height:40px; background:white; color:var(--primary); border-radius:50%; display:flex; align-items:center; justify-content:center; font-weight:bold;" id="user-initial">?</div>
<div>
<div style="font-size: 0.65rem; opacity: 0.8; font-weight:700;">TDTTI THURAVOOR</div>
<div id="display-name" style="font-weight: 700; font-size: 1rem;">User</div>
</div>
</div>
<button onclick="logout()" style="background:transparent; border:1px solid white; color:white; border-radius:8px; padding:5px 12px; cursor:pointer; font-size:0.8rem;">LOGOUT</button>
</div>

<nav id="navbar">
<button id="nav-tab2" onclick="showTab('tab2')">Daily Exam</button>
<div id="nav-timer">15:00</div>
<button id="nav-tab3" onclick="showTab('tab3')">My Progress</button>
<button id="ins-nav" style="display:none;" onclick="showTab('tab5')">Inspirations</button>
<button id="admin-nav" style="display:none;" onclick="showTab('tab4')">Admin</button>
</nav>
</div>



<div id="tab1" class="tab active">
<div class="glass-card" style="max-width: 450px; margin: 40px auto; text-align: center;">
<div class="school-logo">
<img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhkek9231Po5qKTRbN726okbctluF2YgOX_RcMke2yCBQBj2JcXw4Uu2UhrrlTGgM_bfWeZGKkiB0qwlpq8kAgJWHeWM5fN_6eqkkE2zTJHd163AVjiiA5kmDz0pUYxEE_XqpSYYkDrl-rv-iA0XO_mkny4x4BZb27QCRcpsIp6-uMSQLY/s1600/Logo2.png" alt="TDTTI Logo">
</div>
<h1 style="color: var(--primary); margin: 0 0 5px 0; font-size: 1.6rem;">TDTTI THURAVOOR</h1>
<h3 style="color: var(--secondary); margin: 0 0 10px 0; font-weight: 600;">USS SCHOLARS 2025</h3>
<p style="color: #666; font-size:0.85rem; margin-bottom: 25px; border-top: 1px solid #eee; padding-top: 10px;">Sign In - USS Daily Training Portal</p>

<input type="text" id="uid" placeholder="User ID">
<input type="password" id="ups" placeholder="Password">

<label style="display: flex; align-items: center; justify-content: center; gap: 8px; font-size: 0.9rem; color: #666; cursor: pointer; margin-bottom: 15px;">
<input type="checkbox" id="keep-signed" style="width: auto; margin: 0;"> Keep me signed in
</label>

<button class="btn-main" onclick="handleLogin()">Enter Portal</button>
</div>
  
 


</div>

<div id="tab2" class="tab">
<div id="exam-form" class="glass-card">
<div style="background: #eef2ff; padding: 15px; border-radius: 12px; margin-bottom: 20px;">
<label style="font-weight: 700; color: var(--primary); font-size:0.9rem;">Select Language 1 to Start:</label>
<select id="lang-select" onchange="startExamWithTimer()">
<option value="" disabled selected>-- Choose Language --</option>
<option value="lang1_arb">Arabic</option>
<option value="lang1_skt">Sanskrit</option>
<option value="lang1_mal1">Malayalam I</option>
</select>
</div>
  
  
<div id="quiz-load"></div>
<button id="s-btn" class="btn-main" style="background: var(--success); display:none;" onclick="submitExam()">Submit Results</button>
</div>

<div id="exam-result-view" style="display:none;">
<div class="glass-card">
<h3 style="margin-top:0; color: var(--primary);">Performance Review</h3>
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; border-bottom: 1px solid #eee; padding-bottom: 15px; margin-bottom: 15px; font-size: 0.9rem;">
<div><b>Date:</b> <span id="res-date"></span></div>
<div><b>Name:</b> <span id="res-name"></span></div>
<div><b>Class:</b> <span id="res-cl"></span></div>
<div><b>Division:</b> <span id="res-dv"></span></div>
<div><b>Lang 1:</b> <span id="res-lang1"></span></div>
<div><b>User ID:</b> <span id="res-uid"></span></div>
</div>

<div style="display: flex; align-items: center; justify-content: space-between; background: #f8f9ff; padding: 15px; border-radius: 15px;">
<div>
<div style="font-size: 0.8rem; color: #666;">TOTAL SCORE</div>
<div style="font-size: 2.5rem; font-weight: 800; color: var(--primary);"><span id="res-total"></span>/24</div>
</div>
<div style="text-align: right;">
<div style="font-size: 0.8rem; color: #666; margin-bottom: 5px;">GRADE</div>
<div id="res-grade-badge" class="grade-badge"></div>
</div>
</div>
<div id="res-summary" class="summary-grid"></div>
</div>
<div class="glass-card">
<h4 style="margin-top:0;">Question Detail</h4>
<div id="res-review-list"></div>
</div>
<div style="display: flex; gap: 10px; margin-bottom: 30px;">
<button class="btn-main" onclick="tryQuizAgain()">Try Quiz Again</button>
<button class="btn-main" style="background:#666;" onclick="showTab('tab3')">Progress Chart</button>
</div>
</div>
</div>

<div id="tab3" class="tab">
  
<div class="glass-card" id="progress-summary-box" style="margin-bottom: 20px; border-left: 5px solid var(--accent);">
<h3 style="margin-top:0; color: var(--secondary);">Student Summary</h3>
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; font-size: 1rem;">
<p style="margin:0;"><b>Name:</b> <span id="summ-name"></span></p>
<p style="margin:0;"><b>Class:</b> <span id="summ-class"></span></p>
<p style="margin:0;"><b>Division:</b> <span id="summ-div"></span></p>
<p style="margin:0;"><b>Exams Attended:</b> <span id="summ-count" style="color:var(--primary); font-weight:700;">0</span></p>
<p style="margin:0; grid-column: span 2;"><b>Grand Total Score:</b> <span id="summ-grand" style="color:var(--success); font-weight:800; font-size:1.4rem;">0</span></p>
</div>
</div>
 
<div class="glass-card">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
      <h3 style="margin:0;">Growth Analysis</h3>
      <div style="background:var(--error); color:white; padding:5px 15px; border-radius:15px; font-weight:700; font-size:0.9rem;">
        Grade: <span id="p-grade"></span>
      </div>
    </div>
    <div style="position: relative; height:300px; width:100%;">
      <canvas id="chartArea"></canvas>
    </div>
  </div>

  <!-- New section for My Performance and Reviews -->
  <div class="glass-card" id="my-performance-reviews-box">
    <h3 style="margin-top:0; color: var(--primary);">My Performance and Reviews</h3>
    <div id="my-performance-reviews-list" style="max-height: 400px; overflow-y: auto;"></div>
  </div>
</div>

</div>

<div id="tab5" class="tab">
<div class="glass-card">
  <h3 style="margin-top:0; color: var(--primary);">Student Exams</h3>
  <label style="font-weight:700; font-size:0.9rem;">Select Student</label>
  <select id="student-select" onchange="loadStudentExams()"><option value="">-- Choose Student --</option></select>
  <div id="student-exam-list" style="margin-top:20px;"></div>
</div>
  
 <div class="glass-card">  
<h3 style="margin-top:0;">Global Performance</h3>
<div class="table-container">
  <table id="ins-table">
    <thead>
      <tr>
        <th onclick="sortTable(0)">Name â†‘â†“</th><th>Cls</th><th>Div</th><th>L1</th><th>M2</th><th>Mat</th><th>Eng</th><th>BS</th><th>SS</th><th>MA</th><th>CA</th>
        <th onclick="sortTable(11)">Exams â†‘â†“</th><th onclick="sortTable(12)">Total â†‘â†“</th><th onclick="sortTable(13)">Grd â†‘â†“</th>
      </tr>
    </thead>
    <tbody id="ins-body"></tbody>
  </table>
</div>

</div>
 

</div>

<div id="tab4" class="tab">
<div class="glass-card">
<h3>Add New Question</h3>
<div id="q-input-fields">
  <select id="qs">
<option value="lang1_arb">Arabic</option><option value="lang1_skt">Sanskrit</option><option value="lang1_mal1">Malayalam I</option>
<option value="mal2">Malayalam II</option><option value="maths">Maths</option><option value="eng">English</option>
<option value="bs">Basic Science</option><option value="ss">Social Science</option><option value="mental">Mental Ability</option><option value="current">Current Affairs</option>
</select>
<input type="text" id="qt" placeholder="Question Text">
<div style="display:grid; grid-template-columns: 1fr 1fr; gap: 10px;">
<input type="text" id="o1" placeholder="Option A">
<input type="text" id="o2" placeholder="Option B">
<input type="text" id="o3" placeholder="Option C">
<input type="text" id="o4" placeholder="Option D">
</div>
<input type="text" id="qa" placeholder="Correct Answer">

</div>
<button class="btn-main" onclick="makeQ()">Generate Code</button>
<textarea id="q-code" readonly style="margin-top:10px; height:80px;"></textarea>
</div>
  <div class="glass-card" style="300px: auto; margin: 10px auto;">
  <div style="display:flex; justify-content:space-between; align-items:center;">
    <h3 style="margin:0; color: var(--primary);">Attendance</h3>
    <button onclick="copyAttendanceTable()"
      style="padding:6px 14px; border-radius:8px; border:none;
             background:var(--secondary); color:white; font-weight:600; cursor:pointer;">
      Copy
    </button>
  </div>

  <div class="table-container-attendance">
    <table id="attendance-table"
      style="width:100%; border-collapse:collapse;">
      <thead>
        <tr style="background:#eef2ff;">
          <th onclick="sortAttendance(0)"
      style="cursor:pointer;">
      Student Name <span id="sort-name"></span>
    </th>

  <th onclick="sortAttendance(1)"
      style="cursor:pointer;">
    No. of Exams Attended <span id="sort-exams"></span>
  </th>

        </tr>
      </thead>
      <tbody id="attendance-body">
        <tr>
          <td colspan="2" style="padding:12px; text-align:center; color:#666;">
            Loading attendanceâ€¦
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

</div>
  
</div>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyvR2DNBQzwtDdt6KngGABQq1yC_73tEps4d0JvFIwGG6z8jt8y227Bf7SZg8TILVTI/exec";
  
const students = [
{id:"USS001", pass:"AF1", name:"AAISHA FIDHA", class:"7", div:"D", role:"student"},
{id:"USS002", pass:"ACS2", name:"AALIYA C S", class:"7", div:"D", role:"student"},
{id:"USS003", pass:"AK3", name:"ANANDHAKRISHNAN ", class:"7", div:"B", role:"student"},
{id:"USS004", pass:"AA4", name:"ANSHITHA ANEESH", class:"7", div:"B", role:"student"},
{id:"USS005", pass:"ATS5", name:"ANUSREE T S", class:"7", div:"B", role:"student"},
{id:"USS006", pass:"BSK6", name:"BHAGATH S KUMAR", class:"7", div:"B", role:"student"},
{id:"USS007", pass:"DTR7", name:"DEVANANDA T R", class:"7", div:"C", role:"student"},
{id:"USS008", pass:"FSKS8", name:"FATHIMATH SAHRA K S", class:"7", div:"D", role:"student"},
{id:"USS009", pass:"HNKS9", name:"HARI NARAYANAN K S", class:"7", div:"B", role:"student"},
{id:"USS010", pass:"KKN10", name:"KUNAL KIRAN NAGDA", class:"7", div:"B", role:"student"},
{id:"USS011", pass:"MNM11", name:"MALAVIKA N M", class:"7", div:"B", role:"student"},
{id:"USS012", pass:"MMH12", name:"MEENAKSHY M HEGDE", class:"7", div:"B", role:"student"},
{id:"USS013", pass:"PPS13", name:"PRATHITHA P SHENOY", class:"7", div:"B", role:"student"},
{id:"USS014", pass:"SS14", name:"SARANGI S", class:"7", div:"B", role:"student"},
{id:"USS015", pass:"SP15", name:"SREEBALA PRASANTH", class:"7", div:"B", role:"student"},
{id:"USS016", pass:"SH16", name:"SREEBHADRA H", class:"7", div:"B", role:"student"},
{id:"USS017", pass:"SSP17", name:"SUKESH S PAI", class:"7", div:"B", role:"student"},
{id:"USS018", pass:"VSB18", name:"VARALAKSHMY S BHAT", class:"7", div:"B", role:"student"},
{id:"USS019", pass:"VA", name:"AJITH V", class:"7", div:"E", role:"student"},
{id:"ADMIN", pass:"123456", name:"Teacher", class:"-", div:"-", role:"teacher"}
];

const masterBank = [

{"question":"Ø§Ù„Ù†Øµ Ø§Ù„Ø°ÙŠ ÙŠÙØ³ØªØ®Ø¯Ù… Ù„Ø¥ÙŠØµØ§Ù„ ÙÙƒØ±Ø© Ø£Ø®Ù„Ø§Ù‚ÙŠØ© Ø¨Ø·Ø±ÙŠÙ‚Ø© ØºÙŠØ± Ù…Ø¨Ø§Ø´Ø±Ø© Ù‡Ùˆ:","options":["Ø§Ù„Ù‚ØµØ© Ø§Ù„ÙˆØµÙÙŠØ©","Ø§Ù„Ù…Ù‚Ø§Ù„Ø© Ø§Ù„Ø¹Ù„Ù…ÙŠØ©","Ø§Ù„Ù‚ØµØ© Ø§Ù„Ø±Ù…Ø²ÙŠØ©","Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø¥Ø®Ø¨Ø§Ø±ÙŠ"],"answer":2,"subject":"lang1_arb"},
{"question":"Ø£ÙŠÙ‘Ù Ø§Ù„Ø¬Ù…Ù„ Ø§Ù„ØªØ§Ù„ÙŠØ© ØªÙØ¹Ø¨Ù‘ÙØ± Ø¹Ù† Ø£Ø³Ù„ÙˆØ¨ Ø§Ù„Ù†Ù‡ÙŠ ÙÙŠ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©ØŸ","options":["ÙŠØ°Ù‡Ø¨Ù Ø§Ù„ØªÙ„Ù…ÙŠØ°Ù Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø¯Ø±Ø³Ø©","Ù„Ø§ ØªÙÙ‡Ù…ÙÙ„Ù’ ÙˆØ§Ø¬Ø¨Ø§ØªÙÙƒ","Ù‡Ù„ Ù‚Ø±Ø£ØªÙŽ Ø§Ù„Ø¯Ø±Ø³ÙŽØŸ","Ù…Ø§ Ø£Ø¬Ù…Ù„ÙŽ Ø§Ù„ØµØ¯Ù‚ÙŽ!"],"answer":1,"subject":"lang1_arb"},
{"question":"ÙÙŠ Ø§Ù„Ø¬Ù…Ù„Ø©: Â«Ø§Ù„Ø·Ø§Ù„Ø¨Ù Ø§Ù„Ù…Ø¬ØªÙ‡Ø¯Ù Ù…Ø­Ø¨ÙˆØ¨ÙŒ Ø¹Ù†Ø¯ÙŽ Ø§Ù„Ù…Ø¹Ù„Ù…ÙŠÙ†Â» ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø¬ØªÙ‡Ø¯ Ù‡ÙŠ:","options":["Ø®Ø¨Ø±","Ù†Ø¹Øª","Ø¨Ø¯Ù„","Ø­Ø§Ù„"],"answer":1,"subject":"lang1_arb"},
{"question":"Ø£ÙŠÙ‘Ù Ù…Ù…Ø§ ÙŠÙ„ÙŠ ÙŠÙØ¹Ø¯Ù‘Ù Ù‚ÙŠÙ…Ø©Ù‹ ØªØ±Ø¨ÙˆÙŠØ©Ù‹ Ù…ØªÙƒØ±Ø±Ø©Ù‹ ÙÙŠ Ø¯Ø±ÙˆØ³ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠØ©ØŸ","options":["Ø§Ù„ØªÙØ§Ø®Ø± Ø¨Ø§Ù„Ù…Ø§Ù„","Ø§Ø­ØªØ±Ø§Ù… Ø§Ù„ÙˆÙ‚Øª","Ø­Ø¨Ù‘ Ø§Ù„Ù†Ø²Ø§Ø¹","Ø¥Ù‡Ù…Ø§Ù„ Ø§Ù„Ø¢Ø®Ø±ÙŠÙ†"],"answer":1,"subject":"lang1_arb"},
{"question":"Ø§Ø®ØªØ± Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„ØªÙŠ ØªØ¯Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠ Ø£ÙƒØ«Ø± Ù…Ù† ØºÙŠØ±Ù‡Ø§:","options":["Ø§Ù„ØªØ¹Ø§ÙˆÙ†","Ø§Ù„Ù…Ù†Ø§ÙØ³Ø©","Ø§Ù„Ø¹Ø²Ù„Ø©","Ø§Ù„Ø³ÙŠØ·Ø±Ø©"],"answer":0,"subject":"lang1_arb"},
{"question":"Ø£ÙŠÙ‘Ù Ø¹Ù†ÙˆØ§Ù†Ù Ø£Ù†Ø³Ø¨Ù Ù„Ù†ØµÙ‘Ù ÙŠØªØ­Ø¯Ù‘Ø« Ø¹Ù† Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ¦Ø© ÙˆØ§Ù„Ù…Ø­Ø§ÙØ¸Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø·Ø¨ÙŠØ¹Ø©ØŸ","options":["Ø­ÙŠØ§Ø© Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©","Ù†Ø¹Ù…Ù Ø§Ù„Ù„Ù‡ Ø¹Ù„ÙŠÙ†Ø§","ÙˆØ§Ø¬Ø¨Ù†Ø§ Ù†Ø­Ùˆ Ø§Ù„Ø¨ÙŠØ¦Ø©","Ø±Ø­Ù„Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø³ÙˆÙ‚"],"answer":2,"subject":"lang1_arb"},

{"question":"à¤¨à¤¿à¤®à¥à¤¨à¤²à¤¿à¤–à¤¿à¤¤à¥‡à¤·à¥ à¤•à¤ƒ à¤•à¤°à¥à¤¤à¤°à¤¿ à¤ªà¥à¤°à¤¯à¥‹à¤—à¥‡ à¤ªà¥à¤°à¤¯à¥à¤•à¥à¤¤à¤ƒ à¤µà¤¾à¤•à¥à¤¯à¤ƒ?","options":["à¤¬à¤¾à¤²à¤•à¥‡à¤¨ à¤ªà¥à¤¸à¥à¤¤à¤•à¤‚ à¤ªà¤ à¥à¤¯à¤¤à¥‡à¥¤","à¤¬à¤¾à¤²à¤•à¤ƒ à¤ªà¥à¤¸à¥à¤¤à¤•à¤‚ à¤ªà¤ à¤¤à¤¿à¥¤","à¤ªà¥à¤¸à¥à¤¤à¤•à¤®à¥ à¤¬à¤¾à¤²à¤•à¥‡à¤¨ à¤ªà¤ à¥à¤¯à¤¤à¥‡à¥¤","à¤ªà¥à¤¸à¥à¤¤à¤•à¤‚ à¤ªà¤ à¥à¤¯à¤¤à¥‡à¥¤"],"answer":1,"subject":"lang1_skt"},
{"question":"à¤µà¤¾à¤•à¥à¤¯à¥‡ â€” â€œà¤µà¤¿à¤¦à¥à¤¯à¤¯à¤¾ à¤µà¤¿à¤¨à¤¯à¤ƒ à¤¶à¥‹à¤­à¤¤à¥‡â€ à¤…à¤¸à¥à¤¯ à¤µà¤¾à¤•à¥à¤¯à¤¸à¥à¤¯ à¤®à¥à¤–à¥à¤¯à¤­à¤¾à¤µà¤ƒ à¤•à¤ƒ?","options":["à¤§à¤¨à¤¸à¥à¤¯ à¤®à¤¹à¤¤à¥à¤¤à¥à¤µà¤®à¥","à¤¬à¤²à¤¸à¥à¤¯ à¤ªà¥à¤°à¤­à¤¾à¤µà¤ƒ","à¤¶à¤¿à¤•à¥à¤·à¤¾à¤¯à¤¾à¤ƒ à¤¨à¥ˆà¤¤à¤¿à¤•à¤®à¥‚à¤²à¥à¤¯à¤®à¥","à¤ªà¥à¤°à¤¤à¤¿à¤¯à¥‹à¤—à¤¿à¤¤à¤¾à¤¯à¤¾à¤ƒ à¤†à¤µà¤¶à¥à¤¯à¤•à¤¤à¤¾"],"answer":2,"subject":"lang1_skt"},
{"question":"â€œà¤—à¤šà¥à¤›à¤¤à¤¿â€ à¤‡à¤¤à¤¿ à¤•à¥à¤°à¤¿à¤¯à¤¾à¤ªà¤¦à¤¸à¥à¤¯ à¤²à¤Ÿà¥-à¤²à¤•à¤¾à¤°à¥‡ à¤‰à¤¤à¥à¤¤à¤®à¤ªà¥à¤°à¥à¤·-à¤à¤•à¤µà¤šà¤¨-à¤°à¥‚à¤ªà¤‚ à¤•à¤¿à¤®à¥?","options":["à¤—à¤šà¥à¤›à¤¸à¤¿","à¤—à¤šà¥à¤›à¤¾à¤®à¤¿","à¤—à¤šà¥à¤›à¤¤à¤ƒ","à¤—à¤šà¥à¤›à¤¨à¥à¤¤à¤¿"],"answer":1,"subject":"lang1_skt"},
{"question":"à¤¨à¤¿à¤®à¥à¤¨à¤²à¤¿à¤–à¤¿à¤¤à¥‡à¤·à¥ à¤•à¤ƒ à¤¶à¤¬à¥à¤¦à¤ƒ à¤­à¤¾à¤µà¤µà¤¾à¤šà¤•-à¤¸à¤‚à¤œà¥à¤žà¤¾ à¤…à¤¸à¥à¤¤à¤¿?","options":["à¤¬à¤¾à¤²à¤•à¤ƒ","à¤—à¤®à¤¨à¤®à¥","à¤—à¥à¤°à¥à¤ƒ","à¤µà¥ƒà¤•à¥à¤·à¤ƒ"],"answer":1,"subject":"lang1_skt"},{"question":"à¤¯à¤¦à¤¿ à¤ªà¤¾à¤ à¥‡ â€œà¤ªà¤°à¥à¤¯à¤¾à¤µà¤°à¤£à¤¸à¤‚à¤°à¤•à¥à¤·à¤£à¤®à¥â€ à¤µà¤¿à¤·à¤¯à¤ƒ à¤µà¤°à¥à¤£à¤¿à¤¤à¤ƒ, à¤¤à¤°à¥à¤¹à¤¿ à¤®à¥à¤–à¥à¤¯à¤ƒ à¤‰à¤¦à¥à¤¦à¥‡à¤¶à¥à¤¯à¤ƒ à¤•à¤ƒ à¤­à¤µà¤¤à¤¿?","options":["à¤µà¤¨à¤µà¤¿à¤¨à¤¾à¤¶à¤¸à¥à¤¯ à¤¸à¤®à¤°à¥à¤¥à¤¨à¤®à¥","à¤ªà¥à¤°à¤•à¥ƒà¤¤à¥‡à¤ƒ à¤‰à¤ªà¤¯à¥‹à¤—à¤ƒ à¤•à¥‡à¤µà¤²à¤®à¥","à¤ªà¥à¤°à¤•à¥ƒà¤¤à¤¿à¤¸à¤‚à¤°à¤•à¥à¤·à¤£à¥‡ à¤›à¤¾à¤¤à¥à¤°à¤¾à¤£à¤¾à¤‚ à¤œà¤¾à¤—à¤°à¥‚à¤•à¤¤à¤¾","à¤‰à¤¦à¥à¤¯à¥‹à¤—à¤µà¤¿à¤•à¤¾à¤¸à¤¸à¥à¤¯ à¤ªà¥à¤°à¤¶à¤‚à¤¸à¤¾"],"answer":2,"subject":"lang1_skt"},
{"question":"à¤¨à¤¿à¤®à¥à¤¨à¤²à¤¿à¤–à¤¿à¤¤à¥‡à¤·à¥ à¤•à¤ƒ à¤¸à¥à¤­à¤¾à¤·à¤¿à¤¤à¤¸à¥à¤¯ à¤¸à¤¾à¤®à¤¾à¤¨à¥à¤¯à¤ƒ à¤¸à¤¨à¥à¤¦à¥‡à¤¶à¤ƒ?","options":["à¤¶à¥€à¤˜à¥à¤°à¤²à¤¾à¤­à¤ƒ à¤¶à¥à¤°à¥‡à¤·à¥à¤ à¤ƒ","à¤ªà¤°à¥‹à¤ªà¤•à¤¾à¤°à¤ƒ à¤ªà¥à¤£à¥à¤¯à¤¾à¤¯ à¤­à¤µà¤¤à¤¿","à¤¸à¥à¤µà¤¾à¤°à¥à¤¥à¤ƒ à¤à¤µ à¤œà¥€à¤µà¤¨à¤®à¥","à¤¬à¤²à¤‚ à¤¸à¤°à¥à¤µà¤¸à¥à¤¯ à¤•à¤¾à¤°à¤£à¤®à¥"],"answer":1,"subject":"lang1_skt"},

{"question":"à´’à´°àµ à´ªà´¾à´ à´¤àµà´¤à´¿àµ½ à´•à´¥à´¾à´ªà´¾à´¤àµà´°à´¤àµà´¤à´¿à´¨àµà´±àµ† à´®à´¨àµ‹à´­à´¾à´µà´‚ à´ªàµà´°à´µàµ¼à´¤àµà´¤à´¿à´•à´³à´¿à´²àµ‚à´Ÿàµ† à´µàµà´¯à´•àµà´¤à´®à´¾à´•àµà´•àµà´¨àµà´¨ à´°à´šà´¨à´¾à´¶àµˆà´²à´¿ à´à´¤à´¾à´£àµ?","options":["à´µà´¿à´µà´°à´£à´°àµ€à´¤à´¿","à´¸à´‚à´­à´¾à´·à´£à´°àµ€à´¤à´¿","à´†à´¨àµà´¤à´°à´¿à´•à´¸à´‚à´­à´¾à´·à´£à´‚","à´¸à´‚à´­à´µà´µà´¿à´µà´°à´£à´‚"],"answer":2,"subject":"lang1_mal1"},
{"question":"â€œà´®à´¨àµà´·àµà´¯à´¨àµà´‚ à´ªàµà´°à´•àµƒà´¤à´¿à´¯àµà´‚ à´¤à´®àµà´®à´¿à´²àµà´³àµà´³ à´¬à´¨àµà´§à´‚â€ à´Žà´¨àµà´¨ à´†à´¶à´¯à´‚ à´Šà´¨àµà´¨à´¿à´ªàµà´ªà´±à´¯àµà´¨àµà´¨ à´ªà´¾à´ à´¤àµà´¤à´¿à´¨àµà´±àµ† à´ªàµà´°à´§à´¾à´¨ à´²à´•àµà´·àµà´¯à´‚ à´à´¤àµ?","options":["à´ªàµà´°à´•àµƒà´¤à´¿à´¯àµà´Ÿàµ† à´†à´§à´¿à´ªà´¤àµà´¯à´‚ à´•à´¾à´£à´¿à´•àµà´•àµ½","à´®à´¨àµà´·àµà´¯à´¨àµà´±àµ† à´¸àµ—à´•à´°àµà´¯à´™àµà´™àµ¾ à´µàµ¼à´§à´¿à´ªàµà´ªà´¿à´•àµà´•àµ½","à´ªà´°à´¿à´¸àµà´¥à´¿à´¤à´¿à´¬àµ‹à´§à´‚ à´µà´³àµ¼à´¤àµà´¤àµ½","à´¸à´¾à´™àµà´•àµ‡à´¤à´¿à´•à´µà´¿à´¦àµà´¯à´¯àµà´Ÿàµ† à´ªàµà´°à´¾à´§à´¾à´¨àµà´¯à´‚"],"answer":2,"subject":"lang1_mal1"},
{"question":"à´’à´°àµ à´•à´µà´¿à´¤à´¯à´¿àµ½ à´ªàµà´°à´¤àµ€à´•à´‚ à´‰à´ªà´¯àµ‹à´—à´¿à´•àµà´•àµà´¨àµà´¨à´¤à´¿à´¨àµà´±àµ† à´ªàµà´°à´§à´¾à´¨ à´‰à´¦àµà´¦àµ‡à´¶àµà´¯à´‚ à´Žà´¨àµà´¤à´¾à´£àµ?","options":["à´µà´¾à´•àµà´•àµà´•à´³àµà´Ÿàµ† à´Žà´£àµà´£à´‚ à´µàµ¼à´§à´¿à´ªàµà´ªà´¿à´•àµà´•àµ½","à´†à´¶à´¯à´‚ à´†à´´à´¤àµà´¤à´¿àµ½ à´¸àµ‚à´šà´¿à´ªàµà´ªà´¿à´•àµà´•àµ½","à´µà´¾à´¯à´¨à´¾à´¸àµ—à´•à´°àµà´¯à´‚ à´•àµà´±à´¯àµà´•àµà´•àµ½","à´•à´¥à´¾à´ªà´°à´¿à´£à´¾à´®à´‚ à´µàµ‡à´—à´¤àµà´¤à´¿à´²à´¾à´•àµà´•àµ½"],"answer":1,"subject":"lang1_mal1"},
{"question":"â€œà´…à´µàµ» à´ªà´±à´žàµà´žà´¤àµ à´¹àµƒà´¦à´¯à´‚ à´¤àµŠà´Ÿàµà´Ÿàµâ€ à´Žà´¨àµà´¨ à´µà´¾à´•àµà´¯à´¤àµà´¤à´¿àµ½ à´‰à´ªà´¯àµ‹à´—à´¿à´šàµà´šà´¿à´°à´¿à´•àµà´•àµà´¨àµà´¨ à´­à´¾à´·à´¾à´ªàµà´°à´¯àµ‹à´—à´‚ à´à´¤àµ?","options":["à´¶à´¬àµà´¦à´¾à´²à´™àµà´•à´¾à´°à´‚","à´‰à´ªà´®","à´²à´¾à´•àµà´·à´£à´¿à´•à´ªàµà´°à´¯àµ‹à´—à´‚","à´¨àµ‡à´°àµ¼à´¤àµà´¥à´ªàµà´°à´¯àµ‹à´—à´‚"],"answer":2,"subject":"lang1_mal1"},
{"question":"à´’à´°àµ à´²àµ‡à´–à´¨à´‚ à´µà´¿à´²à´¯à´¿à´°àµà´¤àµà´¤àµ½ à´¸àµà´µà´­à´¾à´µà´®àµà´³àµà´³à´¤à´¾à´•àµà´•à´¾àµ» à´à´±àµà´±à´µàµà´‚ à´†à´µà´¶àµà´¯à´®à´¾à´¯ à´˜à´Ÿà´•à´‚ à´à´¤àµ?","options":["à´µàµà´¯à´•àµà´¤à´¿à´ªà´°à´®à´¾à´¯ à´…à´¨àµà´­à´µà´™àµà´™àµ¾ à´®à´¾à´¤àµà´°à´‚","à´¯àµà´•àµà´¤à´¿à´ªà´°à´®à´¾à´¯ à´µà´¾à´¦à´™àµà´™à´³àµà´‚ à´¤àµ†à´³à´¿à´µàµà´•à´³àµà´‚","à´¸à´‚à´­à´µà´™àµà´™à´³àµà´Ÿàµ† à´•àµà´°à´®à´¾à´¨àµà´¸à´°à´£à´‚","à´¸à´‚à´­à´¾à´·à´£à´™àµà´™à´³àµà´Ÿàµ† à´¸à´¾à´¨àµà´¨à´¿à´§àµà´¯à´‚"],"answer":1,"subject":"lang1_mal1"},{"question":"à´¸à´¾à´®àµ‚à´¹à´¿à´• à´µà´¿à´·à´¯à´™àµà´™àµ¾ à´•àµˆà´•à´¾à´°àµà´¯à´‚ à´šàµ†à´¯àµà´¯àµà´¨àµà´¨ à´ªà´¾à´ à´™àµà´™à´³à´¿àµ½ à´•à´¥à´¾à´ªà´¾à´¤àµà´°à´¸à´‚à´˜àµ¼à´·à´‚ à´‰àµ¾à´ªàµà´ªàµ†à´Ÿàµà´¤àµà´¤àµà´¨àµà´¨à´¤à´¿à´¨àµà´±àµ† à´ªàµà´°à´§à´¾à´¨ à´²à´•àµà´·àµà´¯à´‚ à´Žà´¨àµà´¤àµ?","options":["à´µà´¿à´¨àµ‹à´¦à´‚ à´¨àµ½à´•à´¾àµ» à´®à´¾à´¤àµà´°à´‚","à´•à´¥ à´¨àµ€à´Ÿàµà´Ÿà´¾àµ»","à´¸à´¾à´®àµ‚à´¹à´¿à´• à´ªàµà´°à´¶àµà´¨à´™àµà´™à´³àµà´Ÿàµ† à´¸à´™àµà´•àµ€àµ¼à´£àµà´£à´¤ à´•à´¾à´£à´¿à´•àµà´•à´¾àµ»","à´­à´¾à´·à´¾ à´µàµˆà´µà´¿à´§àµà´¯à´‚ à´ªàµà´°à´¦àµ¼à´¶à´¿à´ªàµà´ªà´¿à´•àµà´•à´¾àµ»"],"answer":2,"subject":"lang1_mal1"},

{"question":"à´’à´°àµ à´ªà´¾à´ à´¤àµà´¤à´¿àµ½ à´¸à´¾à´®àµ‚à´¹à´¿à´• à´…à´¸à´®à´¤àµà´µà´‚ à´¸àµ‚à´šà´¿à´ªàµà´ªà´¿à´•àµà´•à´¾àµ» à´Žà´´àµà´¤àµà´¤àµà´•à´¾à´°àµ» à´¸à´¾à´§à´¾à´°à´£à´¯à´¾à´¯à´¿ à´‰à´ªà´¯àµ‹à´—à´¿à´•àµà´•àµà´¨àµà´¨ à´°à´šà´¨à´¾à´°àµ€à´¤à´¿ à´à´¤àµ?","options":["à´ªàµà´°à´•àµƒà´¤à´¿à´µà´¿à´µà´°à´£à´‚","à´ªàµà´°à´¤àµ€à´•à´¾à´¤àµà´®à´• à´…à´µà´¤à´°à´£à´‚","à´šà´°à´¿à´¤àµà´°à´µà´¿à´µà´°à´£à´‚","à´¶à´¾à´¸àµà´¤àµà´°àµ€à´¯ à´µà´¿à´¶à´¦àµ€à´•à´°à´£à´‚"],"answer":1,"subject":"mal2"},
{"question":"â€œà´…à´µàµ¾ à´®àµ—à´¨à´‚à´•àµŠà´£àµà´Ÿàµ à´¤à´¨àµà´¨àµ† à´ªàµà´°à´¤à´¿à´·àµ‡à´§à´¿à´šàµà´šàµâ€ à´Žà´¨àµà´¨ à´µà´¾à´•àµà´¯à´¤àµà´¤à´¿àµ½ à´®àµ—à´¨à´‚ à´Žà´¨àµà´¨à´¤àµ à´à´¤àµ à´…àµ¼à´¤àµà´¥à´¤àµà´¤à´¿àµ½ à´‰à´ªà´¯àµ‹à´—à´¿à´šàµà´šà´¿à´°à´¿à´•àµà´•àµà´¨àµà´¨àµ?","options":["à´¨àµ‡à´°àµ¼à´¤àµà´¥à´¤àµà´¤à´¿àµ½","à´¶à´¬àµà´¦à´¾àµ¼à´¤àµà´¥à´¤àµà´¤à´¿àµ½","à´²à´¾à´•àµà´·à´£à´¿à´• à´…àµ¼à´¤àµà´¥à´¤àµà´¤à´¿àµ½","à´µàµà´¯à´¾à´•à´°à´£à´¾àµ¼à´¤àµà´¥à´¤àµà´¤à´¿àµ½"],"answer":2,"subject":"mal2"},
{"question":"à´’à´°àµ à´•à´µà´¿à´¤à´¯à´¿àµ½ à´µà´¿à´°àµà´¦àµà´§à´¾à´­à´¾à´¸à´‚ (Paradox) à´‰à´ªà´¯àµ‹à´—à´¿à´•àµà´•àµà´¨àµà´¨à´¤à´¿à´¨àµà´±àµ† à´ªàµà´°à´§à´¾à´¨ à´²à´•àµà´·àµà´¯à´‚ à´Žà´¨àµà´¤àµ?","options":["à´†à´¶à´¯à´‚ à´²à´³à´¿à´¤à´®à´¾à´•àµà´•à´¾àµ»","à´µà´¾à´¯à´¨à´•àµà´•à´¾à´°à´¨àµ† à´†à´¶à´¯à´•àµà´•àµà´´à´ªàµà´ªà´¤àµà´¤à´¿à´²à´¾à´•àµà´•à´¾àµ»","à´šà´¿à´¨àµà´¤à´¯àµ† à´‰à´£àµ¼à´¤àµà´¤à´¾àµ»","à´­à´¾à´·à´¯àµ† à´¦àµàµ¼à´¬à´²à´®à´¾à´•àµà´•à´¾àµ»"],"answer":2,"subject":"mal2"},
{"question":"à´’à´°àµ à´²àµ‡à´–à´¨à´‚ à´µà´¿à´®àµ¼à´¶à´¨à´¾à´¤àµà´®à´• à´¸àµà´µà´­à´¾à´µà´®àµà´³àµà´³à´¤à´¾à´•à´¾àµ» à´à´±àµà´±à´µàµà´‚ à´†à´µà´¶àµà´¯à´®à´¾à´¯ à´˜à´Ÿà´•à´‚ à´à´¤àµ?","options":["à´µà´¿à´•à´¾à´°à´¾à´§à´¿à´·àµà´ à´¿à´¤ à´…à´µà´¤à´°à´£à´‚","à´µàµà´¯à´•àµà´¤à´¿à´ªà´°à´®à´¾à´¯ à´…à´­à´¿à´ªàµà´°à´¾à´¯à´™àµà´™àµ¾ à´®à´¾à´¤àµà´°à´‚","à´¯àµà´•àµà´¤à´¿à´¸à´¹à´®à´¾à´¯ à´¨à´¿à´°àµ€à´•àµà´·à´£à´µàµà´‚ à´µà´¿à´¶à´•à´²à´¨à´µàµà´‚","à´µà´¿à´µà´°à´£à´™àµà´™à´³àµà´Ÿàµ† à´†à´µàµ¼à´¤àµà´¤à´¨à´‚"],"answer":2,"subject":"mal2"},{"question":"à´µà´¿à´¦àµà´¯à´¾à´­àµà´¯à´¾à´¸à´ªà´°à´®à´¾à´¯ à´ªà´¾à´ à´™àµà´™à´³à´¿àµ½ à´®àµ‚à´²àµà´¯à´¬àµ‹à´§à´‚ à´¶à´•àµà´¤à´¿à´ªàµà´ªàµ†à´Ÿàµà´¤àµà´¤àµà´¨àµà´¨à´¤à´¿à´¨à´¾à´¯à´¿ à´Žà´´àµà´¤àµà´¤àµà´•à´¾à´°àµ» à´•àµ‚à´Ÿàµà´¤à´²à´¾à´¯à´¿ à´Šà´¨àµà´¨àµ½ à´¨àµ½à´•àµà´¨àµà´¨à´¤àµ à´à´¤à´¿à´¨à´¾à´£àµ?","options":["à´µàµà´¯à´•àµà´¤à´¿à´—à´¤ à´µà´¿à´œà´¯à´‚","à´¸à´¾à´®àµ‚à´¹à´¿à´• à´‰à´¤àµà´¤à´°à´µà´¾à´¦à´¿à´¤àµà´µà´‚","à´®à´¤àµà´¸à´°à´®à´¨àµ‹à´­à´¾à´µà´‚","à´¸à´¾à´®àµà´ªà´¤àµà´¤à´¿à´• à´¨àµ‡à´Ÿàµà´Ÿà´‚"],"answer":1,"subject":"mal2"},
{"question":"à´¸à´®àµ‚à´¹à´®à´¾à´±àµà´±à´¤àµà´¤àµ† à´²à´•àµà´·àµà´¯à´®à´¿à´Ÿàµà´¨àµà´¨ à´ªà´¾à´ à´™àµà´™à´³à´¿àµ½ à´•à´¥à´¾à´ªà´¾à´¤àµà´°à´¤àµà´¤à´¿à´¨àµà´±àµ† à´ªà´°à´¿à´µàµ¼à´¤àµà´¤à´¨à´‚ à´‰àµ¾à´ªàµà´ªàµ†à´Ÿàµà´¤àµà´¤àµà´¨àµà´¨à´¤àµ à´Žà´¨àµà´¤àµà´•àµŠà´£àµà´Ÿàµ à´ªàµà´°à´§à´¾à´¨à´®à´¾à´£àµ?","options":["à´•à´¥ à´¨àµ€à´³à´¾àµ»","à´­à´¾à´·à´¾à´¸àµ—à´¨àµà´¦à´°àµà´¯à´‚ à´µàµ¼à´§à´¿à´•àµà´•à´¾àµ»","à´¸à´¾à´®àµ‚à´¹à´¿à´• à´¸à´¨àµà´¦àµ‡à´¶à´‚ à´µàµà´¯à´•àµà´¤à´®à´¾à´•àµà´•à´¾àµ»","à´¸à´‚à´­à´µà´•àµà´°à´®à´‚ à´µàµ‡à´—à´¤àµà´¤à´¿à´²à´¾à´•àµà´•à´¾àµ»"],"answer":2,"subject":"mal2"},

{"question":"A number when divided by 5 leaves remainder 2, and when divided by 7 leaves remainder 4. Which of the following is the smallest such number?","options":["9","12","37","39"],"answer":2,"subject":"maths"},
{"question":"A shopkeeper marks an article 25% more than its cost price and then gives a 10% discount. What is the overall gain or loss?","options":["12.5% gain","10% gain","12.5% loss","No gain, no loss"],"answer":0,"subject":"maths"},{"question":"In a sequence: 2, 6, 12, 20, 30, ? The next number is:","options":["40","41","42","44"],"answer":2,"subject":"maths"},
{"question":"A rectangular field has length twice its breadth. If the perimeter is 72 m, what is the area of the field?","options":["192 sq.m","216 sq.m","288 sq.m","324 sq.m"],"answer":2,"subject":"maths"},
{"question":"Three numbers are in the ratio 3 : 5 : 7. If their sum is 300, the largest number is:","options":["120","100","140","150"],"answer":1,"subject":"maths"},
{"question":"The HCF of two numbers is 12 and their LCM is 180. If one number is 36, the other number is:","options":["54","72","60","48"],"answer":3,"subject":"maths"},

{"question":"Choose the sentence with the correct spelling.","options":["Enviroment","Environmant","Environment","Envirronment"],"answer":2,"subject":"eng"},
{"question":"Which word is the noun in the sentence? â€œHonesty is the best policy.â€","options":["Honest","Best","Honesty","Is"],"answer":2,"subject":"eng"},
{"question":"Choose the correct plural form of the word â€œchild.â€","options":["Childs","Childes","Children","Childrens"],"answer":2,"subject":"eng"},
{"question":"Select the sentence written in the past tense.","options":["She sings well.","She is singing well.","She sang well.","She will sing well."],"answer":2,"subject":"eng"},
{"question":"Which sentence expresses a request?","options":["Close the door.","Can you close the door, please?","The door is closed.","You closed the door."],"answer":1,"subject":"eng"},
{"question":"Choose the word that is opposite in meaning to â€œbegin.â€","options":["Start","Open","Continue","End"],"answer":3,"subject":"eng"},

{"question":"Which gas do humans exhale while breathing?","options":["Oxygen","Carbon dioxide","Nitrogen","Hydrogen"],"answer":1,"subject":"bs"},
{"question":"The process of water vapor changing into liquid water is called:","options":["Evaporation","Condensation","Freezing","Melting"],"answer":1,"subject":"bs"},
{"question":"Which of the following is an insectivore?","options":["Crow","Spider","Tiger","Cow"],"answer":1,"subject":"bs"},{"question":"Which organ in humans produces insulin?","options":["Liver","Pancreas","Kidney","Heart"],"answer":1,"subject":"bs"},
{"question":"Which of the following changes is permanent?","options":["Melting ice","Boiling water","Rusting iron","Dissolving sugar in water"],"answer":2,"subject":"bs"},
{"question":"Which part of the human eye controls the amount of light entering?","options":["Cornea","Retina","Iris","Lens"],"answer":2,"subject":"bs"},

{"question":"1","options":["A","B","C","D"],"answer":0,"subject":"ss"},
{"question":"Who is known as the Father of the Indian Constitution?","options":["Jawaharlal Nehru","B. R. Ambedkar","Mahatma Gandhi","Sardar Patel"],"answer":1,"subject":"ss"},
{"question":"Which of the following rivers flows through Kerala?","options":["Ganga","Periyar","Yamuna","Godavari"],"answer":1,"subject":"ss"},
{"question":"Which type of government is India?","options":["Monarchy","Oligarchy","Dictatorship","Democracy"],"answer":3,"subject":"ss"},
{"question":"Kerala is famous for which traditional dance form?","options":["Bharatanatyam","Kathak","Kathakali","Kuchipudi"],"answer":2,"subject":"ss"},
{"question":"Which planet is known as the Red Planet?","options":["Mars","Jupiter","Venus","Mercury"],"answer":0,"subject":"ss"},
{"question":"Who was the first Prime Minister of India?","options":["Mahatma Gandhi","Jawaharlal Nehru","Sardar Vallabhbhai Patel","Subhas Chandra Bose"],"answer":1,"subject":"ss"},

{"question":"Find the next number in the sequence: 2, 4, 8, 16, ?","options":["20","24","32","36"],"answer":2,"subject":"mental"},
{"question":"A shop sells pencils at 5 for â‚¹10. How much will 20 pencils cost?","options":["â‚¹30","â‚¹40","â‚¹50","â‚¹60"],"answer":1,"subject":"mental"},
{"question":"If 6 workers can complete a task in 12 days, how many days will 4 workers take to complete the same task?","options":["22 days","28 days","24 days","20 days"],"answer":3,"subject":"mental"},
{"question":"Which figure completes the pattern? â–², â–²â–², â–²â–²â–², ?","options":["â–²â–²â–²â–²â–²","â–²â–²â–²â–²","â–²â–²â–²â–²â–²â–²â–²","â–²â–²â–²â–²â–²"],"answer":1,"subject":"mental"},
{"question":"A cube has 6 faces. How many edges does it have?","options":["8","10","12","14"],"answer":2,"subject":"mental"},{"question":"If a clock shows 3:15, what is the angle between the hour and minute hands?","options":["0Â°","90Â°","52.5Â°","7.5Â°"],"answer":3,"subject":"mental"},

{"question":"Which Indian city is known as the â€œSilicon Valley of Indiaâ€?","options":["Mumbai","Hyderabad","Bengaluru","Pune"],"answer":2,"subject":"current"},
{"question":"Which country hosted the 2024 Summer Olympics?","options":["Japan","USA","France","China"],"answer":2,"subject":"current"},
{"question":"The Kudumbashree mission in Kerala primarily focuses on:","options":["Education","Women empowerment and poverty eradication","Health services","Tourism development"],"answer":1,"subject":"current"},
{"question":"Who is the current President of India (2026)?","options":["Ram Nath Kovind","Narendra Modi","Amith Sha","Droupadi Murmu"],"answer":3,"subject":"current"},
{"question":"Which initiative is related to clean energy promotion in India?","options":["Digital India","Swachh Bharat Mission","National Solar Mission","Make in India"],"answer":2,"subject":"current"},
{"question":"Which Indian space mission successfully demonstrated human spaceflight capability?","options":["Chandrayaan-3","Gaganyaan","Mars Orbiter Mission","Astrosat"],"answer":1,"subject":"current"},

];

let user = null; let examQs = []; let myChart = null;
let examTimer = null; let timeLeft = 900; 

function checkPersistentLogin() {
const savedUser = localStorage.getItem('uss_user');
if(savedUser) {
user = JSON.parse(savedUser);
finalizeLogin();
}
}

function showLoading(txt) {
document.getElementById('loader-text').innerText = txt;
document.getElementById('loader-content').style.display = 'flex';
document.getElementById('status-content').style.display = 'none';
document.getElementById('msg-overlay').style.display = 'flex';
}

function showStatus(title, msg, type = 'success') {
document.getElementById('loader-content').style.display = 'none';
document.getElementById('status-content').style.display = 'block';
document.getElementById('status-icon').innerText = (type === 'success' ? "" : "");
document.getElementById('status-title').innerText = title;
document.getElementById('status-title').style.color = (type === 'success' ? "var(--success)" : "var(--error)");
document.getElementById('status-msg').innerText = msg;
}

function closeMsg() { document.getElementById('msg-overlay').style.display = 'none'; }

function handleLogin() {
showLoading("Syncing...");
const idInput = document.getElementById('uid').value.toUpperCase().trim();
const passInput = document.getElementById('ups').value.trim();
const keep = document.getElementById('keep-signed').checked;

user = students.find(s => s.id === idInput && s.pass === passInput);
if(user) {
if(keep) localStorage.setItem('uss_user', JSON.stringify(user));
finalizeLogin();
} else { showStatus("", "Invalid Credentials", ""); }
}

function finalizeLogin() {
  document.getElementById('sticky-header-container').style.display = 'block';
  document.getElementById('user-profile').style.display = 'flex';
  document.getElementById('display-name').innerText = user.name;
  document.getElementById('user-initial').innerText = user.name.charAt(0);
  document.getElementById('tab1').classList.remove('active');
  document.getElementById('navbar').style.display = 'flex';

  /* ðŸ” ROLE-BASED NAV */
  if (user.role === 'teacher') {
    document.getElementById('admin-nav').style.display = 'block';
    document.getElementById('ins-nav').style.display = 'block';
  } else {
    document.getElementById('admin-nav').style.display = 'none';
    document.getElementById('ins-nav').style.display = 'none';
  }
  loadAttendance();   // âœ… ADD THIS
  showTab('tab2');
  closeMsg();
}
  function hideNavForExam() {
  document.querySelectorAll('#navbar button').forEach(b => {
    b.style.display = 'none';
  });
  document.getElementById('nav-timer').style.display = 'block';
}

function restoreNavAfterExam() {
  document.getElementById('nav-tab2').style.display = 'inline-block';
  document.getElementById('nav-tab3').style.display = 'inline-block';

  if (user.role === 'teacher') {
    document.getElementById('admin-nav').style.display = 'inline-block';
    document.getElementById('ins-nav').style.display = 'inline-block';
  }

  document.getElementById('nav-timer').style.display = 'none';
}
  
function logout() {
localStorage.removeItem('uss_user');
location.reload();
}

function showTab(tid) {
document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
document.querySelectorAll('nav button').forEach(b => b.classList.remove('active-nav'));
document.getElementById(tid).classList.add('active');
if(document.getElementById('nav-'+tid)) document.getElementById('nav-'+tid).classList.add('active-nav');
if(tid === 'tab3') loadProgress();
if(tid === 'tab5') loadInspirations();
window.scrollTo({top: 0, behavior: 'smooth'});
}

function startExamWithTimer() {
  generateExam();
  document.getElementById('s-btn').style.display = 'block';

  timeLeft = 900;
  hideNavForExam();

  if (examTimer) clearInterval(examTimer);

  examTimer = setInterval(() => {
    timeLeft--;
    let min = Math.floor(timeLeft / 60);
    let sec = timeLeft % 60;
    document.getElementById('nav-timer').innerText =
      `${min}:${sec < 10 ? '0' : ''}${sec}`;

    if (timeLeft === 180) {
      document.getElementById('nav-timer').classList.add('timer-warn');
    }

    if (timeLeft <= 0) {
      clearInterval(examTimer);
      submitExam();
    }
  }, 1000);
}

function tryQuizAgain() {
  document.getElementById('exam-result-view').style.display = 'none';
  document.getElementById('exam-form').style.display = 'block';
  document.getElementById('lang-select').value = "";
  document.getElementById('quiz-load').innerHTML = "";
  document.getElementById('s-btn').style.display = 'none';

  restoreNavAfterExam();
  document.getElementById('nav-timer').classList.remove('timer-warn');
}

function generateExam() {
const lang = document.getElementById('lang-select').value;
const subs = [lang, 'mal2', 'maths', 'eng', 'bs', 'ss', 'mental', 'current'];
examQs = [];
subs.forEach(s => {
let pool = masterBank.filter(q => q.subject === s);
pool.sort(() => 0.5 - Math.random());
examQs.push(...pool.slice(0, 3));
});
renderExam();
}

function renderExam() {
let h = "";
examQs.forEach((q, i) => {

const isArabic = q.subject === "lang1_arb";
const rtlClass = isArabic ? "rtl-arabic" : "";

h += `
<div class="q-card ${rtlClass}">
<div style="font-size:0.7rem; color:var(--primary); font-weight:800; text-transform:uppercase;">
${q.subject}
</div>
<p class="${rtlClass}" style="font-weight:600; margin:10px 0;">
${i+1}. ${q.question}
</p>
`;

q.options.forEach((o, j) => {
h += `
<div class="${rtlClass}">
<input type="radio" id="q${i}_opt${j}" name="qz${i}" value="${o}">
<label for="q${i}_opt${j}" class="option-label ${rtlClass}">

${o}
</label>
</div>
`;
});

h += `</div>`;
});

document.getElementById('quiz-load').innerHTML = h || "Exam data missing...";
}

async function submitExam() {
  clearInterval(examTimer);
  restoreNavAfterExam();
  document.getElementById('nav-timer').classList.remove('timer-warn');
showLoading("Syncing...");
let sc = {lang1:0, mal2:0, maths:0, eng:0, bs:0, ss:0, mental:0, current:0};
let total = 0; let reviewHTML = "";

examQs.forEach((q, i) => {
  const sel = document.querySelector(`input[name="qz${i}"]:checked`);

  const uAnsIndex = sel ? parseInt(sel.id.split("_opt")[1], 10) : -1;
  const correctIndex = q.answer;

  const isCorrect = uAnsIndex === correctIndex;
  const userAnswerText = uAnsIndex >= 0 ? q.options[uAnsIndex] : "None";
  const correctAnswerText = q.options[correctIndex];

  if (isCorrect) {
    total++;

    // Normalize subject key
    let key = q.subject.startsWith("lang1_") ? "lang1" : q.subject;

    if (sc.hasOwnProperty(key)) {
      sc[key] += 1;
    } else {
      console.warn("Unknown subject:", q.subject);
    }
  }

  reviewHTML += `
    <div style="padding:12px; margin-bottom:8px; background:#fff; border:1px solid #eee; border-radius:10px;">
      <p style="margin:0 0 5px 0; font-size:0.9rem;">
        <b>Q${i+1}.</b> ${q.question}
      </p>

      <p style="margin:2px 0; font-size:0.85rem;">
        Your Answer:
        <span style="color:${isCorrect ? 'var(--success)' : 'var(--error)'}; font-weight:700;">
          ${userAnswerText}
        </span>
      </p>

      <p style="margin:2px 0; font-size:0.85rem;">
        Correct Answer:
        <span style="color:var(--success); font-weight:700;">
          ${correctAnswerText}
        </span>
      </p>
    </div>
  `;
});


try {
const dStr = new Date().toLocaleDateString('en-GB');
const perc = (total/24)*100;
const grade = getGrade(perc);
const reviewObj = {
  date: dStr,
  total: total,
  grade: grade,
  scores: sc
};

// save to localStorage
let history = JSON.parse(localStorage.getItem("uss_reviews") || "[]");
history.push(reviewObj);
localStorage.setItem("uss_reviews", JSON.stringify(history));


await fetch(SCRIPT_URL, { method: "POST", body: JSON.stringify({
name: user.name, class: user.class, division: user.div, date: dStr, scores: sc, total: total
})});

document.getElementById('exam-form').style.display = 'none';
document.getElementById('exam-result-view').style.display = 'block';

document.getElementById('res-date').innerText = dStr;
document.getElementById('res-name').innerText = user.name;
document.getElementById('res-cl').innerText = user.class;
document.getElementById('res-dv').innerText = user.div;
document.getElementById('res-uid').innerText = user.id;
document.getElementById('res-lang1').innerText = document.getElementById('lang-select').value.split('_')[1].toUpperCase();
document.getElementById('res-total').innerText = total;
document.getElementById('res-grade-badge').innerText = grade;

let sumHTML = "";
for(let s in sc) { sumHTML += `<div style="background:white; padding:10px; border-radius:10px; border-bottom:3px solid var(--accent); text-align:center;"><div style="font-size:0.6rem; color:#888;">${s.toUpperCase()}</div><div style="font-weight:700;">${sc[s]}/3</div></div>`; }
document.getElementById('res-summary').innerHTML =
  renderPerformanceCard(reviewObj);

document.getElementById('res-review-list').innerHTML = reviewHTML;
closeMsg();
} catch(e) { showStatus("Error", "Check Connection", "error"); }
}

async function loadProgress() {
  if(SCRIPT_URL === "YOUR_WEB_APP_URL") return;
  showLoading("Syncing...");
  try {
    const res = await fetch(`${SCRIPT_URL}?name=${user.name}`);
    const data = await res.json();

    document.getElementById('summ-name').innerText = user.name;
    document.getElementById('summ-class').innerText = user.class;
    document.getElementById('summ-div').innerText = user.div;

    if(data.length > 0) {
      const values = data.map(r => r[13]);
      const grandTotal = values.reduce((a, b) => a + b, 0);
      const avg = (grandTotal / (data.length * 24)) * 100;

      document.getElementById('summ-count').innerText = data.length;
      document.getElementById('summ-grand').innerText = grandTotal;
      document.getElementById('p-grade').innerText = getGrade(avg);

      if(myChart) myChart.destroy();
      myChart = new Chart(document.getElementById('chartArea'), {
        type: 'line',
        data: { labels: data.map(r => lockExamDateTime(r[0])), datasets: [{ label: 'Score', data: values, borderColor: '#4361ee', tension: 0.4, fill: true, backgroundColor: 'rgba(67,97,238,0.1)' }] },
        options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } } }
      });
    } else {
      document.getElementById('summ-count').innerText = 0;
      document.getElementById('summ-grand').innerText = 0;
      document.getElementById('p-grade').innerText = '';
      if(myChart) myChart.destroy();
    }

    // Render "My Performance and Reviews" with server data, last exam first
    const reviewBox = document.getElementById("my-performance-reviews-list");
    if (data.length === 0) {
      reviewBox.innerHTML = "<p style='color:#666; font-size:0.9rem;'>No exams attempted yet.</p>";
    } else {
      let html = "";
      // Iterate reversed (last exam first)
      for (let i = data.length -1; i >= 0; i--) {
        const r = data[i];
        const examNum = data.length - i;
        const date = lockExamDateTime(r[0]);
        const scores = {
          lang1: r[5], mal2: r[6], maths: r[7], eng: r[8],
          bs: r[9], ss: r[10], mental: r[11], current: r[12]
        };
        const total = r[13];
        const grade = getGrade((total / 24) * 100);
        let grid = "";
        for (const [key, val] of Object.entries(scores)) {
          grid += `
            <div style="background:#fff; padding:8px; border-radius:10px; border-bottom:3px solid var(--accent); text-align:center;">
              <div style="font-size:0.6rem; color:#888;">${key.toUpperCase()}</div>
              <div style="font-weight:700;">${val}/3</div>
            </div>`;
        }
        html += `
          <div class="glass-card" style="margin-bottom:15px;">
            <div style="display:flex; justify-content:space-between; align-items:center;">
              <b>Exam ${examNum}</b>
              <span style="font-size:0.8rem; color:#666;">${date}</span>
            </div>
            <div style="margin:8px 0; font-size:0.9rem;">
              <b>Total:</b> ${total}/24 |
              <b>Grade:</b> <span style="color:var(--primary); font-weight:800;">${grade}</span>
            </div>
            <div class="summary-grid">${grid}</div>
          </div>`;
      }
      reviewBox.innerHTML = html;
    }

    closeMsg();
  } catch(e) {
    showStatus("Error", "Load Failed", "error");
  }
}


function renderPerformanceCard(review, index = null) {
  let grid = "";
  for (let s in review.scores) {
    grid += `
      <div style="background:white; padding:8px; border-radius:10px;
                  border-bottom:3px solid var(--accent); text-align:center;">
        <div style="font-size:0.6rem; color:#888;">${s.toUpperCase()}</div>
        <div style="font-weight:700;">${review.scores[s]}/3</div>
      </div>
    `;
  }

  return `
    <div class="glass-card" style="margin-bottom:15px;">
      <div style="display:flex; justify-content:space-between; align-items:center;">
        <b>Exam ${index !== null ? index + 1 : ""}</b>
        <span style="font-size:0.8rem; color:#666;">${review.date}</span>
      </div>

      <div style="margin:8px 0; font-size:0.9rem;">
        <b>Total:</b> ${review.total}/24 |
        <b>Grade:</b>
        <span style="color:var(--primary); font-weight:800;">
          ${review.grade}
        </span>
      </div>

      <div class="summary-grid">
        ${grid}
      </div>
    </div>
  `;
}


async function loadInspirations() {
if(SCRIPT_URL === "YOUR_WEB_APP_URL") return;
showLoading("Updating...");
const body = document.getElementById('ins-body');
try {
const res = await fetch(`${SCRIPT_URL}?type=allStudents`);
const data = await res.json();
const studentsMap = {};
data.forEach(row => {
const key = `${row[1]}-${row[2]}-${row[3]}`;
if(!studentsMap[key]) studentsMap[key] = { name: row[1], class: row[2], div: row[3], l1:0, m2:0, math:0, eng:0, bs:0, ss:0, ma:0, ca:0, total:0, exams:0 };
const s = studentsMap[key];
s.l1 += row[5]; s.m2 += row[6]; s.math += row[7]; s.eng += row[8];
s.bs += row[9]; s.ss += row[10]; s.ma += row[11]; s.ca += row[12];
s.total += row[13]; s.exams++;
});
populateStudentDropdown(data);
let h = "";
Object.values(studentsMap).forEach(s => {
const perc = (s.total / (s.exams * 24)) * 100;
h += `<tr><td style="font-weight:700;">${s.name}</td><td>${s.class}</td><td>${s.div}</td><td>${s.l1}</td><td>${s.m2}</td><td>${s.math}</td><td>${s.eng}</td><td>${s.bs}</td><td>${s.ss}</td><td>${s.ma}</td><td>${s.ca}</td><td>${s.exams}</td><td style="color:var(--primary); font-weight:700;">${s.total}</td><td>${getGrade(perc)}</td></tr>`;
});
body.innerHTML = h; closeMsg();
} catch(e) { showStatus("Error", "Load Error", "error"); }

  
}

function getGrade(p) {
if(p >= 80) return "A"; if(p >= 60) return "B"; if(p >= 40) return "C";
if(p >= 30) return "D"; if(p >= 29) return "E"; return "E";
}

function sortTable(n) {
const table = document.getElementById("ins-table");
let rows, switching, i, x, y, shouldSwitch, dir, switchcount = 0;
switching = true; dir = "desc";
while (switching) {
switching = false; rows = table.rows;
for (i = 1; i < (rows.length - 1); i++) {
shouldSwitch = false;
x = rows[i].getElementsByTagName("TD")[n];
y = rows[i + 1].getElementsByTagName("TD")[n];
let xVal = isNaN(x.innerText) ? x.innerText.toLowerCase() : parseFloat(x.innerText);
let yVal = isNaN(y.innerText) ? y.innerText.toLowerCase() : parseFloat(y.innerText);
if (dir == "asc") { if (xVal > yVal) { shouldSwitch = true; break; } }
else { if (xVal < yVal) { shouldSwitch = true; break; } }
}
if (shouldSwitch) { rows[i].parentNode.insertBefore(rows[i + 1], rows[i]); switching = true; switchcount ++; }
else { if (switchcount == 0 && dir == "desc") { dir = "asc"; switching = true; } }
}
}

function makeQ() {
    const qSub = document.getElementById('qs').value; 
    const qText = document.getElementById('qt').value;
    const opt1 = document.getElementById('o1').value;
    const opt2 = document.getElementById('o2').value;
    const opt3 = document.getElementById('o3').value;
    const opt4 = document.getElementById('o4').value;
    const qAnsIndex = parseInt(document.getElementById('qa').value, 10);

    // Validate answer index
    if (isNaN(qAnsIndex) || qAnsIndex < 0 || qAnsIndex > 3) {
        showStatus("Warning", "Correct answer must be 0, 1, 2, or 3", "error");
        return;
    }

    // Validate essential fields
    if(!qText || !opt1 || !opt2 || !opt3 || !opt4) {
        showStatus("Warning", "Please fill all question and option fields", "error");
        return;
    }

    // Create question object with answer as the index
    const q = {
        question: qText,
        options: [opt1, opt2, opt3, opt4],
        answer: qAnsIndex,   // Store index instead of option text
        subject: qSub
    };

    const generatedCode = JSON.stringify(q) + ",";
    const textArea = document.getElementById('q-code');
    textArea.value += generatedCode;

    // Copy to clipboard
    navigator.clipboard.writeText(textArea.value).then(() => {
        // Clear fields
        document.getElementById('qt').value = "";
        document.getElementById('o1').value = "";
        document.getElementById('o2').value = "";
        document.getElementById('o3').value = "";
        document.getElementById('o4').value = "";
        document.getElementById('qa').value = "";

        showStatus("Success", "Code generated and copied to clipboard!");
    }).catch(err => {
        showStatus("Copy Error", "Failed to auto-copy code.", "error");
    });
}

  
  function lockExamDateTime(value) {

  // Case 1: Google Sheets serial (number)
  if (typeof value === "number") {
    const date = new Date(Math.floor((value - 25569) * 86400 * 1000));
    const time = (value % 1) * 24 * 60 * 60 * 1000;
    return new Date(date.getTime() + time).toLocaleString("en-GB", {
      day: "2-digit",
      month: "short",
      year: "numeric",
      hour12: true
    });
  }

  // Case 2: ISO string with timezone (Z / +xx)
  if (typeof value === "string" && value.includes("T")) {
    const clean = value.replace("Z", "").split(".")[0];
    const [date, time] = clean.split("T");
    const [y, m, d] = date.split("-");
    const [h, min] = time.split(":");

    return new Date(y, m - 1, d, h, min).toLocaleString("en-GB", {
      day: "2-digit",
      month: "short",
      year: "numeric",
      hour12: true
    });
  }

  // Case 3: Plain string â†’ display as-is
  return value;
}
  
  
 function populateStudentDropdown(data) {
  const select = document.getElementById("student-select");
  select.innerHTML = `<option value="">-- Choose Student --</option>`;

  const seen = new Set();

  data.forEach(row => {
    const name = row[1];
    if (!seen.has(name)) {
      seen.add(name);
      const opt = document.createElement("option");
      opt.value = name;
      opt.textContent = name;
      select.appendChild(opt);
    }
  });
}
  
  let studentChart = null;

async function loadStudentExams() {
  const studentName = document.getElementById("student-select").value;
  if (!studentName) return;

  showLoading("Loading Student Exams...");

  try {
    const res = await fetch(`${SCRIPT_URL}?name=${studentName}`);
    const data = await res.json();

    const labels = [];
    const totals = [];
    let html = "";

    // Reverse order: latest exam first
// Reverse order: last exam first
const reversedData = [...data].reverse();

reversedData.forEach((r, i) => {
  const date = lockExamDateTime(r[4]);
  const scores = {
    L1: r[5], M2: r[6], Math: r[7], Eng: r[8],
    BS: r[9], SS: r[10], MA: r[11], CA: r[12]
  };
  const total = r[13];
  const grade = getGrade((total / 24) * 100);

  html += `
    <div class="glass-card">
      <b>Exam ${reversedData.length - i}</b> â€“ ${date}<br>
      <b>Total:</b> ${total}/24 |
      <b>Grade:</b>
      <span style="font-weight:800;color:var(--primary)">${grade}</span>

      <div class="summary-grid" style="margin-top:10px;">
        ${Object.entries(scores).map(([k,v]) => `
          <div style="background:#fff;padding:8px;border-radius:10px;text-align:center;">
            <div style="font-size:0.6rem;color:#888">${k}</div>
            <b>${v}</b>
          </div>
        `).join("")}
      </div>
    </div>
  `;
});

	
    document.getElementById("student-exam-list").innerHTML = html;

    if (studentChart) studentChart.destroy();
    studentChart = new Chart(
      document.getElementById("studentExamChart"), {
        type: "bar",
        data: {
          labels,
          datasets: [{
            label: "Total Score",
            data: totals,
            backgroundColor: "rgba(67,97,238,0.6)"
          }]
        },
        options: {
          responsive: true,
          plugins: { legend: { display: false } },
          scales: { y: { beginAtZero: true, max: 24 } }
        }
      }
    );

    closeMsg();
  } catch (e) {
    showStatus("Error", "Unable to load student exams", "error");
    console.log("RAW EXAM DATE:", r[0], typeof r[0]);
  }
}

  
  async function loadAttendance() {
  const tbody = document.getElementById("attendance-body");
  tbody.innerHTML = `
    <tr>
      <td colspan="2" style="padding:12px;text-align:center;">Loadingâ€¦</td>
    </tr>`;

  try {
    // Fetch all exam records
    const res = await fetch(`${SCRIPT_URL}?type=allStudents`);
    const data = await res.json();

    // Count exams per student name
    const examCount = {};
    data.forEach(row => {
      const name = row[1]; // student name
      examCount[name] = (examCount[name] || 0) + 1;
    });

    // Build table using const students
    let html = "";
    students
      .filter(s => s.role === "student")
      .forEach(s => {
        html += `
          <tr>
            <td style="padding:10px; border:1px solid #ddd; text-align:left;">
              ${s.name}
            </td>
            <td style="padding:10px; border:1px solid #ddd; text-align:center; font-weight:700;">
              ${examCount[s.name] || 0}
            </td>
          </tr>`;
      });

    tbody.innerHTML = html;

  } catch (e) {
    tbody.innerHTML = `
      <tr>
        <td colspan="2" style="padding:12px;color:red;text-align:center;">
          Failed to load attendance
        </td>
      </tr>`;
  }
}
  
  


 function copyAttendanceTable() {
  const rows = document.querySelectorAll("#attendance-table tr");
  let text = "";

  rows.forEach(row => {
    const cols = row.querySelectorAll("th, td");
    const line = Array.from(cols).map(c => c.innerText).join("\t");
    text += line + "\n";
  });

  navigator.clipboard.writeText(text).then(() => {
    alert("Attendance table copied!");
  });
}

let attendanceSort = {
  column: null,
  asc: true
};

function sortAttendance(colIndex) {
  const tbody = document.getElementById("attendance-body");
  const rows = Array.from(tbody.querySelectorAll("tr"));

  // Toggle sort direction
  if (attendanceSort.column === colIndex) {
    attendanceSort.asc = !attendanceSort.asc;
  } else {
    attendanceSort.column = colIndex;
    attendanceSort.asc = true;
  }

  rows.sort((a, b) => {
    let A = a.children[colIndex].innerText.trim();
    let B = b.children[colIndex].innerText.trim();

    // Number sort for exam count
    if (colIndex === 1) {
      A = Number(A);
      B = Number(B);
    } else {
      A = A.toLowerCase();
      B = B.toLowerCase();
    }

    if (A < B) return attendanceSort.asc ? -1 : 1;
    if (A > B) return attendanceSort.asc ? 1 : -1;
    return 0;
  });

  tbody.innerHTML = "";
  rows.forEach(r => tbody.appendChild(r));

  updateSortIcons();
}

  
function updateSortIcons() {
  document.getElementById("sort-name").innerText = "";
  document.getElementById("sort-exams").innerText = "â†•";

  const icon = attendanceSort.asc ? "" : "";
  if (attendanceSort.column === 0) {
    document.getElementById("sort-name").innerText = icon;
  }
  if (attendanceSort.column === 1) {
    document.getElementById("sort-exams").innerText = icon;
  }
}

  
  
</script>
</body>
</html>
