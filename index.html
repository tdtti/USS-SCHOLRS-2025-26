<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TDTTI THURAVOOR - USS Portal</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
:root {
--primary: #4361ee; --secondary: #3f37c9; --accent: #4cc9f0;
--success: #4caf50; --error: #f44336; --bg: #f0f2f5;
--glass: rgba(255, 255, 255, 0.9); --shadow: 0 8px 32px rgba(0,0,0,0.1);
}
* { box-sizing: border-box; font-family: 'Noto Sans Malayalam', 'Noto Sans Arabic', 'Inter', sans-serif;
-webkit-tap-highlight-color: transparent;}

  

body {
margin: 0; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
background-attachment: fixed; min-height: 100vh; color: #333; display: flex; flex-direction: column;
}

.app-container { width:100%; max-width: 1200px; margin: 0 auto; padding: 15px; flex: 1; }

/* Requirement 1: Sticky Navigation */
.sticky-nav-wrapper {
position: sticky; top: 0; z-index: 9999;
background: rgba(245, 247, 250, 0.85); backdrop-filter: blur(12px);
margin: -15px -15px 15px -15px; padding: 15px 15px 5px 15px;
border-bottom: 1px solid rgba(0,0,0,0.05);
}

.glass-card { background: var(--glass); backdrop-filter: blur(10px); border-radius: 20px; border: 1px solid rgba(255,255,255,0.3); box-shadow: var(--shadow); padding: clamp(15px, 5vw, 30px); margin-bottom: 20px; }

.school-logo { width: 200px; height: 200px; margin: 0 auto 15px; background: #fff; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 10px rgba(0,0,0,0.1); overflow: hidden; }
.school-logo img { width: 90%; height: 90%; object-fit: contain; }

nav { display: none; gap: 10px; margin-bottom: 15px; justify-content: center; overflow-x: auto; padding-bottom: 5px; scrollbar-width: none; align-items: center;}
nav::-webkit-scrollbar { display: none; }

nav button { padding: 10px 20px; border: none; border-radius: 12px; cursor: pointer; background: white; color: var(--primary); font-weight: 600; transition: 0.3s; white-space: nowrap; box-shadow: 0 4px 6px rgba(0,0,0,0.05); font-size: clamp(0.8rem, 2.5vw, 1rem); }
nav button:hover, nav button.active-nav { background: var(--primary); color: white; }

/* Requirement 4: Timer in Nav */
#nav-timer {
display: none; background: green; color: #fff; padding: 8px 15px;
border-radius: 10px; font-weight: 800; font-family: monospace; font-size: 1.1rem;
border: 2px solid var(--accent);
}
.timer-warn { background: var(--error) !important; animation: blinker 1s linear infinite; }
@keyframes blinker { 50% { opacity: 0.5; } }

#user-profile { display: none; align-items: center; justify-content: space-between; background: var(--primary); color: white; padding: 10px 20px; border-radius: 15px; margin-bottom: 10px; }

.summary-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 12px; margin: 20px 0; }
@media (max-width: 480px) { .summary-grid { grid-template-columns: repeat(2, 1fr); } }
  /* Mobile First (phones) */
@media (max-width: 600px) {

  .app-container {
    padding: 10px;
  }

  .school-logo {
    width: 140px;
    height: 140px;
  }

  h1 {
    font-size: 1.3rem !important;
  }

  h3 {
    font-size: 1rem !important;
  }

  nav {
    flex-wrap: nowrap;
    justify-content: flex-start;
  }

  nav button {
    padding: 8px 14px;
    font-size: 0.75rem;
  }

  #nav-timer {
    font-size: 0.9rem;
    padding: 6px 10px;
  }

  .glass-card {
    border-radius: 16px;
    padding: 14px;
  }

  .summary-grid {
    grid-template-columns: repeat(2, 1fr);
  }

  table {
  width: auto;        /* or keep width: 100% */
  border-collapse: collapse;
  min-width: unset;   /* remove min-width */
  max-width: 100%;    /* prevent overflow */
}


  canvas {
    width: 100% !important;
  }
}

/* Tablets */
@media (min-width: 601px) and (max-width: 1024px) {

  .app-container {
    max-width: 95%;
  }

  nav button {
    font-size: 0.85rem;
  }

  .school-logo {
    width: 170px;
    height: 170px;
  }
}

/* Large Screens / Desktop */
@media (min-width: 1025px) {

  .app-container {
    max-width: 1200px;
  }

  nav {
    justify-content: center;
  }

}

canvas { width: 100% !important; height: auto !important; }

#msg-overlay { display: none; position: fixed; inset: 0; background: rgba(255,255,255,0.8); backdrop-filter: blur(8px); z-index: 100000; justify-content: center; align-items: center; flex-direction: column; padding: 20px; }
.spinner { width: 60px; height: 60px; border: 6px solid #f3f3f3; border-top: 6px solid var(--primary); border-radius: 50%; animation: spin 1s linear infinite; }
@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

input, select, textarea { width: 100%; padding: 14px; margin: 10px 0; border: 2px solid #eee; border-radius: 12px; font-size: 1rem; background: #fafafa; outline: none; }
.btn-main { width: 100%; padding: 16px; border: none; border-radius: 12px; background: var(--primary); color: white; font-size: 1.1rem; font-weight: 700; cursor: pointer; transition: 0.3s; }
.q-card { background: white; padding: 18px; border-radius: 15px; margin-bottom: 15px; border-left: 5px solid var(--primary); box-shadow: 0 2px 10px rgba(0,0,0,0.05); }


.tab { display: none; animation: fadeIn 0.4s ease; }
.active { display: block; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

/* Stylish grade badge */
.grade-badge { background: var(--accent); color: white; padding: 5px 15px; border-radius: 50px; font-weight: 800; font-size: 1.5rem; box-shadow: 0 4px 10px rgba(76, 201, 240, 0.4); }
.q-card input[type="radio"] {
display: none;
}

/* Make option fully clickable */
.option-label {
display: block;
padding: 14px;
margin: 6px 0;
background: #f9f9f9;
border-radius: 12px;
cursor: pointer;
font-size: 0.9rem;
border: 2px solid transparent;
transition: all 0.2s ease;
}

/* Hover / touch feedback */
.option-label:hover {
background: #eef2ff;
}

/* Selected option style */
.q-card input[type="radio"]:checked + .option-label {
background: #e0e7ff;
border-color: var(--primary);
font-weight: 700;
}
  .rtl-arabic {
  direction: rtl;
  text-align: right;
}
/* Responsive Table Container */


#attendance-table {
  width: 50%;
  border-collapse: collapse;
  font-size: 0.9rem;
  table-layout: fixed;
   
}


#attendance-table th, #attendance-table td {
  padding: 10px;
  border: 1px solid #ddd;
  text-align: left;
  white-space: nowrap; /* Prevent text wrap for better fitting */
  max-width: 1%; /* Helps columns shrink to fit content */
}

.table-container-attendance {
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
  max-width: 100%;
}


/* Smaller font and padding on very small screens */
@media (max-width: 480px) {
  #attendance-table th, #attendance-table td {
    padding: 8px 6px;
    font-size: 0.8rem;
  }
}

.table-container {
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
  border-radius: 15px;
  border: 1px solid #eee;
  background: white;
  max-width: 100%;
}

/* For the Global Performance Table specifically */
#ins-table {
  width: auto;         /* adapt to content */
  min-width: unset;    /* remove fixed min width */
  border: 1px solid #ddd;
  border-collapse: collapse;
  font-size: 0.9rem;
  table-layout: auto;
  max-width: 100%;
}

#subjectwise-table {
  width: 100%;
  border-collapse: collapse;
}

#subjectwise-table th, #subjectwise-table td {
  border: 1px solid #ddd;
  padding: 8px;
  text-align: center;
  white-space: nowrap;
}

#subjectwise-table th {
  background-color: #eef2ff;
  font-weight: 700;
  cursor: pointer;
}

#ins-table th, #ins-table td {
  padding: 10px;
  border: 1px solid #ddd;
  text-align: center;
  white-space: nowrap;   /* Prevent text wrap */
}

/* Responsive font and padding for smaller screens */
@media (max-width: 480px) {
  #ins-table th, #ins-table td {
    padding: 6px 8px;
    font-size: 0.75rem;
  }
}

#res-summary {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(90px, 1fr));
  gap: 10px;
  padding: 10px 0;
}

#res-summary > div {
  background: white;
  padding: 8px 5px;
  border-radius: 10px;
  text-align: center;
  font-size: 0.9rem;
}

#res-summary > div > div:first-child {
  font-size: 0.65rem;
  color: #888;
  margin-bottom: 4px;
}

#res-summary > div > div:last-child {
  font-weight: 700;
  font-size: 1.1rem;
}

        
  #whatsapp-chat-button {
  position: fixed;
  bottom: 20px;
  right: 20px;
  background-color: #25D366;
  width: 56px;
  height: 56px;
  border-radius: 50%;
  box-shadow: 0 4px 12px rgba(0,0,0,0.3);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 99999;
  cursor: pointer;
  transition: background-color 0.3s ease;
}
#whatsapp-chat-button:hover {
  background-color: #128C7E;
}
#whatsapp-chat-button img {
  width: 28px;
  height: 28px;
}


  @media (min-width: 1025px) {
  /* Container constraint */
  .glass-card {
    max-width: 1200px;
    margin-left: auto;
    margin-right: auto;
    overflow-wrap: break-word;
  }

  /* Nav buttons shrink to fit */
  nav {
    max-width: 100%;
  }

  /* For inspiration and admin tabs, force horizontal padding and max width */
  #tab4, #tab5 {
    padding-left: 20px;
    padding-right: 20px;
    max-width: 1200px;
    margin: 0 auto;
    box-sizing: border-box;
  }
}
    

</style>



<body onload="checkPersistentLogin()">

<div id="msg-overlay">
<div id="loader-content">
<div class="spinner"></div>
<h3 id="loader-text" style="color: var(--primary);">Connecting...</h3>
</div>
<div id="status-content" style="display: none; text-align: center;" class="glass-card">
<div id="status-icon" style="font-size: 50px; margin-bottom: 10px;"></div>
<h2 id="status-title"></h2>
<p id="status-msg" style="margin-bottom: 20px;"></p>
<button class="btn-main" onclick="closeMsg()" style="width: auto; padding: 10px 30px;">Continue</button>
</div>
</div>

<div class="app-container">
<div id="sticky-header-container" class="sticky-nav-wrapper" style="display:none;">
<div id="user-profile">
<div style="display: flex; align-items: center; gap: 12px;">
<div style="width:40px; height:40px; background:white; color:var(--primary); border-radius:50%; display:flex; align-items:center; justify-content:center; font-weight:bold;" id="user-initial">?</div>
<div>
<div style="font-size: 0.65rem; opacity: 0.8; font-weight:700;">TDTTI THURAVOOR</div>
<div id="display-name" style="font-weight: 700; font-size: 1rem;">User</div>
</div>
</div>

<button onclick="logout()" style="background:transparent; border:1px solid white; color:white; border-radius:8px; padding:5px 12px; cursor:pointer; font-size:0.8rem;">LOGOUT</button>
</div>



<nav id="navbar">
<button id="nav-tab2" onclick="showTab('tab2')">Daily Exam</button>
<div id="nav-timer">15:00</div>
<button id="nav-tab3" onclick="showTab('tab3')">My Progress</button>
<button id="ins-nav" style="display:none;" onclick="showTab('tab5')">Inspirations</button>
<button id="admin-nav" style="display:none;" onclick="showTab('tab4')">Admin</button>
</nav>
</div>



<div id="tab1" class="tab active">
<div class="glass-card" style="max-width: 450px; margin: 40px auto; text-align: center;">
<div class="school-logo">
<img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhkek9231Po5qKTRbN726okbctluF2YgOX_RcMke2yCBQBj2JcXw4Uu2UhrrlTGgM_bfWeZGKkiB0qwlpq8kAgJWHeWM5fN_6eqkkE2zTJHd163AVjiiA5kmDz0pUYxEE_XqpSYYkDrl-rv-iA0XO_mkny4x4BZb27QCRcpsIp6-uMSQLY/s1600/Logo2.png" alt="TDTTI Logo">
</div>
<h1 style="color: var(--primary); margin: 0 0 5px 0; font-size: 1.6rem;">TDTTI THURAVOOR</h1>
<h3 style="color: var(--secondary); margin: 0 0 10px 0; font-weight: 600;">USS SCHOLARS 2025</h3>
<p style="color: #666; font-size:0.85rem; margin-bottom: 25px; border-top: 1px solid #eee; padding-top: 10px;">Sign In - USS Daily Training Portal</p>

<input type="text" id="uid" placeholder="User ID">
<input type="password" id="ups" placeholder="Password">

<label style="display: flex; align-items: center; justify-content: center; gap: 8px; font-size: 0.9rem; color: #666; cursor: pointer; margin-bottom: 15px;">
<input type="checkbox" id="keep-signed" style="width: auto; margin: 0;"> Keep me signed in
</label>

<button class="btn-main" onclick="handleLogin()">Enter Portal</button>
</div>
  
 


</div>

<div id="tab2" class="tab">
<div id="exam-form" class="glass-card">
<div style="background: #eef2ff; padding: 15px; border-radius: 12px; margin-bottom: 20px;">
<label style="font-weight: 700; color: var(--primary); font-size:0.9rem;">Select Language 1 to Start:</label>
<select id="lang-select" onchange="startExamWithTimer()">
<option value="" disabled selected>-- Choose Language --</option>
<option value="lang1_arb">Arabic</option>
<option value="lang1_skt">Sanskrit</option>
<option value="lang1_mal1">Malayalam I</option>
</select>
</div>
  
  
<div id="quiz-load"></div>
<button id="s-btn" class="btn-main" style="background: var(--success); display:none;" onclick="submitExam()">Submit Results</button>
</div>

<div id="exam-result-view" style="display:none;">
<div class="glass-card">
<h3 style="margin-top:0; color: var(--primary);">Performance Review</h3>
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; border-bottom: 1px solid #eee; padding-bottom: 15px; margin-bottom: 15px; font-size: 0.9rem;">
<div><b>Date:</b> <span id="res-date"></span></div>
<div><b>Name:</b> <span id="res-name"></span></div>
<div><b>Class:</b> <span id="res-cl"></span></div>
<div><b>Division:</b> <span id="res-dv"></span></div>
<div><b>Lang 1:</b> <span id="res-lang1"></span></div>
<div><b>User ID:</b> <span id="res-uid"></span></div>
</div>

<div style="display: flex; align-items: center; justify-content: space-between; background: #f8f9ff; padding: 15px; border-radius: 15px;">
<div>
<div style="font-size: 0.8rem; color: #666;">TOTAL SCORE</div>
<div style="font-size: 2.5rem; font-weight: 800; color: var(--primary);"><span id="res-total"></span>/24</div>
</div>
<div style="text-align: right;">
<div style="font-size: 0.8rem; color: #666; margin-bottom: 5px;">GRADE</div>
<div id="res-grade-badge" class="grade-badge"></div>
</div>
</div>
<div id="res-summary" class="summary-grid"></div>
</div>
<div class="glass-card">
<h4 style="margin-top:0;">Question Detail</h4>
<div id="res-review-list"></div>
</div>
<div style="display: flex; gap: 10px; margin-bottom: 30px;">
<button class="btn-main" onclick="tryQuizAgain()">Try Quiz Again</button>
<button class="btn-main" style="background:#666;" onclick="showTab('tab3')">Progress Chart</button>
</div>
</div>
</div>

<div id="tab3" class="tab">
  
<div class="glass-card" id="progress-summary-box" style="margin-bottom: 20px; border-left: 5px solid var(--accent);">
<h3 style="margin-top:0; color: var(--secondary);">Student Summary</h3>
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; font-size: 1rem;">
<p style="margin:0;"><b>Name:</b> <span id="summ-name"></span></p>
<p style="margin:0;"><b>Class:</b> <span id="summ-class"></span></p>
<p style="margin:0;"><b>Division:</b> <span id="summ-div"></span></p>
<p style="margin:0;"><b>Exams Attended:</b> <span id="summ-count" style="color:var(--primary); font-weight:700;">0</span></p>
<p style="margin:0; grid-column: span 2;"><b>Grand Total Score:</b> <span id="summ-grand" style="color:var(--success); font-weight:800; font-size:1.4rem;">0</span></p>
</div>
</div>

<div class="glass-card" style="margin-top: 20px;">
  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
    <h3 style="margin: 0; color: var(--primary);">Subject Progress</h3>
    <div id="subject-progress-exams-count" style="font-weight: 700; color: var(--secondary); font-size: 1rem;"></div>
  </div>
  <div style="position: relative; height: 300px; width: 100%;">
    <canvas id="subjectProgressChart"></canvas>
  </div>
</div>



 
<div class="glass-card">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
      <h3 style="margin:0;">Growth Analysis</h3>
      <div style="background:var(--error); color:white; padding:5px 15px; border-radius:15px; font-weight:700; font-size:0.9rem;">
        Grade: <span id="p-grade"></span>
      </div>
    </div>
    <div style="position: relative; height:300px; width:100%;">
      <canvas id="chartArea"></canvas>
    </div>
  </div>

  <!-- New section for My Performance and Reviews -->
  <div class="glass-card" id="my-performance-reviews-box">
    <h3 style="margin-top:0; color: var(--primary);">My Performance and Reviews</h3>
    <div id="my-performance-reviews-list" style="max-height: 400px; overflow-y: auto;"></div>
  </div>
</div>

</div>

<div id="tab5" class="tab">
  
  <!-- Add inside the tab5 div, before </div> -->
<div class="glass-card" style="margin-top: 20px;">
  <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
    <h3 style="margin:0; color: var(--primary);">Subject Pointer</h3>
    <div id="total-exams-count" style="font-weight: 700; color: var(--secondary); font-size: 1rem;"></div>
  </div>
  <div style="position: relative; height:300px; width: 100%;">
    <canvas id="subjectPointerChart"></canvas>
  </div>
</div>


  <div class="glass-card">
  <h3>Subjectwise Performance</h3>
  <label style="font-weight:700; font-size:0.9rem;">Select Subject</label>
  <select id="subjectwise-select" onchange="loadSubjectwiseData()">
    <option value="">-- Choose Subject --</option>
    <option value="lang1_arb">Arabic</option>
    <option value="lang1_skt">Sanskrit</option>
    <option value="lang1_mal1">Malayalam I</option>
    <option value="mal2">Malayalam II</option>
    <option value="maths">Maths</option>
    <option value="eng">English</option>
    <option value="bs">Basic Science</option>
    <option value="ss">Social Science</option>
    <option value="mental">Mental Ability</option>
    <option value="current">Current Affairs</option>
  </select>
  <div class="table-container" style="margin-top:15px;">
    <table id="subjectwise-table">
      <thead>
        <tr>
          <th onclick="sortSubjectwiseTable(0)" style="cursor:pointer;">Student Name ↑↓</th>
          <th onclick="sortSubjectwiseTable(1)" style="cursor:pointer;">No. of Exams ↑↓</th>
          <th onclick="sortSubjectwiseTable(2)" style="cursor:pointer;">Score ↑↓</th>
          <th onclick="sortSubjectwiseTable(3)" style="cursor:pointer;">Grade ↑↓</th>
        </tr>
      </thead>
      <tbody id="subjectwise-body">
        <tr><td colspan="4" style="text-align:center; padding:10px; color:#666;">Select a subject to view data</td></tr>
      </tbody>
    </table>
  </div>
</div>



<div class="glass-card">
  <h3 style="margin-top:0; color: var(--primary);">Student Exams</h3>
  <label style="font-weight:700; font-size:0.9rem;">Select Student</label>
  <select id="student-select" onchange="loadStudentExams()"><option value="">-- Choose Student --</option></select>
  <div id="student-exam-list" style="margin-top:20px;"></div>
</div>
  
 <div class="glass-card">  
<h3 style="margin-top:0;">Global Performance</h3>
<div class="table-container">
  <table id="ins-table">
    <thead>
      <tr>
        <th onclick="sortTable(0)">Name ↑↓</th><th>Cls</th><th>Div</th><th>L1</th><th>M2</th><th>Mat</th><th>Eng</th><th>BS</th><th>SS</th><th>MA</th><th>CA</th>
        <th onclick="sortTable(11)">Exams ↑↓</th><th onclick="sortTable(12)">Total ↑↓</th><th onclick="sortTable(13)">Grd ↑↓</th>
      </tr>
    </thead>
    <tbody id="ins-body"></tbody>
  </table>
</div>

</div>
 

</div>

<div id="tab4" class="tab">
<div class="glass-card">
<h3>Add New Question</h3>
<div id="q-input-fields">
  <select id="qs">
<option value="lang1_arb">Arabic</option><option value="lang1_skt">Sanskrit</option><option value="lang1_mal1">Malayalam I</option>
<option value="mal2">Malayalam II</option><option value="maths">Maths</option><option value="eng">English</option>
<option value="bs">Basic Science</option><option value="ss">Social Science</option><option value="mental">Mental Ability</option><option value="current">Current Affairs</option>
</select>
<input type="text" id="qt" placeholder="Question Text">
<div style="display:grid; grid-template-columns: 1fr 1fr; gap: 10px;">
<input type="text" id="o1" placeholder="Option A">
<input type="text" id="o2" placeholder="Option B">
<input type="text" id="o3" placeholder="Option C">
<input type="text" id="o4" placeholder="Option D">
</div>
<input type="text" id="qa" placeholder="Correct Answer">

</div>
<button class="btn-main" onclick="makeQ()">Generate Code</button>
<textarea id="q-code" readonly style="margin-top:10px; height:80px;"></textarea>
<button class="btn-main" style="background:#25d366; margin-top: 8px;" onclick="shareQCodeToWhatsApp()">
  Share to WhatsApp
</button>
</div>
  <div class="glass-card" style="300px: auto; margin: 10px auto;">
  <div style="display:flex; justify-content:space-between; align-items:center;">
    <h3 style="margin:0; color: var(--primary);">Attendance</h3>
    <button onclick="copyAttendanceTable()"
      style="padding:6px 14px; border-radius:8px; border:none;
             background:var(--secondary); color:white; font-weight:600; cursor:pointer;">
      Copy
    </button>
    <button onclick="shareAttendanceToWhatsApp()"
  style="padding:6px 14px; border-radius:8px; border:none; margin-left:10px;
         background:#25d366; color:white; font-weight:600; cursor:pointer;">
  Share to WhatsApp
</button>

    
  </div>

  <div class="table-container-attendance"><br>
    <table id="attendance-table"
      style="width:100%; border-collapse:collapse;">
      <thead>
        <tr style="background:#eef2ff;">
          <th onclick="sortAttendance(0)"
      style="cursor:pointer;">
      Student Name <span id="sort-name"></span>
    </th>

  <th onclick="sortAttendance(1)"
      style="cursor:pointer;">
    No. of Exams Attended <span id="sort-exams"></span>
  </th>

        </tr>
      </thead>
      <tbody id="attendance-body">
        <tr>
          <td colspan="2" style="padding:12px; text-align:center; color:#666;">
            Loading attendance…
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

</div>

</div>


    
<!-- WhatsApp Chat Button -->
<a href="https://wa.me/919497731772" target="_blank" id="whatsapp-chat-button" aria-label="Chat on WhatsApp">
  <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" alt="WhatsApp" />
</a>


<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyvR2DNBQzwtDdt6KngGABQq1yC_73tEps4d0JvFIwGG6z8jt8y227Bf7SZg8TILVTI/exec";
  
const students = [
{id:"USS001", pass:"AF1", name:"AAISHA FIDHA", class:"7", div:"D", role:"student"},
{id:"USS002", pass:"ACS2", name:"AALIYA C S", class:"7", div:"D", role:"student"},
{id:"USS003", pass:"AMS", name:"ANANDHAKRISHNAN M S", class:"7", div:"B", role:"student"},
{id:"USS004", pass:"AA4", name:"ANSHITHA ANEESH", class:"7", div:"B", role:"student"},
{id:"USS005", pass:"ATS5", name:"ANUSREE T S", class:"7", div:"B", role:"student"},
{id:"USS006", pass:"BSK6", name:"BHAGATH S KUMAR", class:"7", div:"B", role:"student"},
{id:"USS007", pass:"DTR7", name:"DEVANANDA T R", class:"7", div:"C", role:"student"},
{id:"USS008", pass:"FSKS8", name:"FATHIMATH SAHRA K S", class:"7", div:"D", role:"student"},
{id:"USS009", pass:"HNKS9", name:"HARI NARAYANAN K S", class:"7", div:"B", role:"student"},
{id:"USS010", pass:"KKN10", name:"KUNAL KIRAN NAGDA", class:"7", div:"B", role:"student"},
{id:"USS011", pass:"MNM11", name:"MALAVIKA N M", class:"7", div:"B", role:"student"},
{id:"USS012", pass:"MMH12", name:"MEENAKSHY M HEGDE", class:"7", div:"B", role:"student"},
{id:"USS013", pass:"PPS13", name:"PRATHITHA P SHENOY", class:"7", div:"B", role:"student"},
{id:"USS014", pass:"SS14", name:"SARANGI S", class:"7", div:"B", role:"student"},
{id:"USS015", pass:"SP15", name:"SREEBALA PRASANTH", class:"7", div:"B", role:"student"},
{id:"USS016", pass:"SH16", name:"SREEBHADRA H", class:"7", div:"B", role:"student"},
{id:"USS017", pass:"SSP17", name:"SUKESH S PAI", class:"7", div:"B", role:"student"},
{id:"USS018", pass:"VSB18", name:"VARALAKSHMY S BHAT", class:"7", div:"B", role:"student"},
{id:"USS019", pass:"VA", name:"AJITH V", class:"7", div:"E", role:"student"},
{id:"ADMIN", pass:"123456", name:"Teacher", class:"-", div:"-", role:"teacher"}
];

const masterBank = [

{"question":"النص الذي يُستخدم لإيصال فكرة أخلاقية بطريقة غير مباشرة هو:","options":["القصة الوصفية","المقالة العلمية","القصة الرمزية","التقرير الإخباري"],"answer":2,"subject":"lang1_arb"},
{"question":"أيُّ الجمل التالية تُعبِّر عن أسلوب النهي في اللغة العربية؟","options":["يذهبُ التلميذُ إلى المدرسة","لا تُهمِلْ واجباتِك","هل قرأتَ الدرسَ؟","ما أجملَ الصدقَ!"],"answer":1,"subject":"lang1_arb"},
{"question":"في الجملة: «الطالبُ المجتهدُ محبوبٌ عندَ المعلمين» كلمة المجتهد هي:","options":["خبر","نعت","بدل","حال"],"answer":1,"subject":"lang1_arb"},
{"question":"أيُّ مما يلي يُعدُّ قيمةً تربويةً متكررةً في دروس اللغة العربية المدرسية؟","options":["التفاخر بالمال","احترام الوقت","حبّ النزاع","إهمال الآخرين"],"answer":1,"subject":"lang1_arb"},
{"question":"اختر الكلمة التي تدل على العمل الجماعي أكثر من غيرها:","options":["التعاون","المنافسة","العزلة","السيطرة"],"answer":0,"subject":"lang1_arb"},
{"question":"أيُّ عنوانٍ أنسبُ لنصٍّ يتحدّث عن حماية البيئة والمحافظة على الطبيعة؟","options":["حياة المدينة","نعمُ الله علينا","واجبنا نحو البيئة","رحلة إلى السوق"],"answer":2,"subject":"lang1_arb"},
{"question": "أيُّ جملةٍ تَدلُّ على الاستمرار في الحاضر؟", "options": ["كَتَبَ الطالِبُ الدرسَ", "يَكْتُبُ الطالِبُ الدرسَ", "سَيَكْتُبُ الطالِبُ الدرسَ", "اكْتُبِ الدرسَ"], "answer": 1, "subject": "lang1_arb"},
{"question": "الكلمةُ التي تُعَبِّرُ عن اسمِ المكان هي:", "options": ["مَكْتَب", "كاتِب", "كِتاب", "مَكْتوب"], "answer": 0, "subject": "lang1_arb"},
{"question": "أيُّ جملةٍ فيها نَعْتٌ ومَنْعوتٌ صحيح؟", "options": ["جاءَ الطالِبُ", "الطالِبُ مُجْتَهِدٌ", "جاءَ الطالِبُ المُجْتَهِدُ", "الطالِبُ في المدرسةِ"], "answer": 2, "subject": "lang1_arb"},
{"question": "الكلمةُ التي تُعَدُّ جمعَ تكسير هي:", "options": ["مُعَلِّمون", "مُسْلِمون", "كُتُب", "طالِبات"], "answer": 2, "subject": "lang1_arb"},
{"question": "أيُّ فعلٍ يدلُّ على الأمر؟", "options": ["ذَهَبَ", "يَذْهَبُ", "اذهَبْ", "ذاهِب"], "answer": 2, "subject": "lang1_arb"},
{"question": "اختر الجملةَ الصحيحةَ نحويًّا:", "options": ["هذا طالبةٌ", "هذه طالبٌ", "هذا طالبٌ", "هذه كتابٌ"], "answer": 2, "subject": "lang1_arb"},
{"question": "ما نوعُ كلمةِ «سَريعًا» في الجملة: جاءَ القطارُ سَريعًا؟", "options": ["نَعْت", "حال", "فاعل", "مفعولٌ به"], "answer": 1, "subject": "lang1_arb"},
{"question": "أيُّ كلمةٍ هي ضميرٌ مُتَّصِل؟", "options": ["أنا", "هو", "كِتابُهُ", "هذا"], "answer": 2, "subject": "lang1_arb"},
{"question": "اختر الكلمةَ التي تدلُّ على الزمان:", "options": ["مَسْجِد", "صَباح", "طَريق", "بَيْت"], "answer": 1, "subject": "lang1_arb"},
{"question": "أيُّ جملةٍ تَحْتَوي على أُسْلوبِ نَهْي؟", "options": ["اكْتُبِ الواجبَ", "لا تَلْعَبْ في الطريقِ", "يَلْعَبُ الوَلَدُ", "سَيَلْعَبُ الوَلَدُ"], "answer": 1, "subject": "lang1_arb"},
{"question": "الكلمةُ «المُعَلِّماتُ» هي:", "options": ["مُفْرَد", "مُثَنّى", "جَمْعُ مُذَكَّرٍ سالِم", "جَمْعُ مُؤَنَّثٍ سالِم"], "answer": 3, "subject": "lang1_arb"},
{"question": "أيُّ كلمةٍ فيها «الـ» الشَّمْسِيَّة؟", "options": ["القَمَر", "الكِتاب", "الشَّمْس", "البَيْت"], "answer": 2, "subject": "lang1_arb"},
{"question": "ما الكلمةُ المناسبةُ لإكمال الجملة: ذَهَبْتُ ___ المدرسةِ؟", "options": ["إلى", "في", "على", "من"], "answer": 0, "subject": "lang1_arb"},
{"question": "أيُّ جملةٍ تَدُلُّ على المستقبل؟", "options": ["يَكْتُبُ الطالِبُ", "كَتَبَ الطالِبُ", "سَيَكْتُبُ الطالِبُ", "اكْتُبِ الطالِبُ"], "answer": 2, "subject": "lang1_arb"},
{"question": "الكلمةُ «مَفْتوح» هي:", "options": ["اسمُ فاعل", "اسمُ مفعول", "فِعْلٌ ماضٍ", "فِعْلُ أَمْر"], "answer": 1, "subject": "lang1_arb"},
{"question": "أيُّ جملةٍ تحتوي على مبتدأٍ وخبر؟", "options": ["ذَهَبَ الوَلَدُ", "الوَلَدُ ذَكِيٌّ", "اكْتُبِ الدرسَ", "في المدرسةِ"], "answer": 1, "subject": "lang1_arb"},
{"question": "ما ضدُّ كلمةِ «كَبِير»؟", "options": ["طَوِيل", "قَصِير", "صَغِير", "قَرِيب"], "answer": 2, "subject": "lang1_arb"},
{"question": "أيُّ كلمةٍ تدلُّ على اسمِ الفاعل؟", "options": ["كاتِب", "مَكْتوب", "كِتابة", "كَتَبَ"], "answer": 0, "subject": "lang1_arb"},
{"question": "اختر الجملةَ التي تُعَبِّرُ عن عادةٍ يوميّة:", "options": ["كَتَبَ الطالِبُ الدرسَ", "يَسْتَيْقِظُ الطالِبُ مُبَكِّرًا", "سَيَذْهَبُ الطالِبُ", "اكْتُبِ الدرسَ"], "answer": 1, "subject": "lang1_arb"},


{"question":"निम्नलिखितेषु कः कर्तरि प्रयोगे प्रयुक्तः वाक्यः?","options":["बालकेन पुस्तकं पठ्यते।","बालकः पुस्तकं पठति।","पुस्तकम् बालकेन पठ्यते।","पुस्तकं पठ्यते।"],"answer":1,"subject":"lang1_skt"},
{"question":"वाक्ये — “विद्यया विनयः शोभते” अस्य वाक्यस्य मुख्यभावः कः?","options":["धनस्य महत्त्वम्","बलस्य प्रभावः","शिक्षायाः नैतिकमूल्यम्","प्रतियोगितायाः आवश्यकता"],"answer":2,"subject":"lang1_skt"},
{"question":"“गच्छति” इति क्रियापदस्य लट्-लकारे उत्तमपुरुष-एकवचन-रूपं किम्?","options":["गच्छसि","गच्छामि","गच्छतः","गच्छन्ति"],"answer":1,"subject":"lang1_skt"},
{"question":"निम्नलिखितेषु कः शब्दः भाववाचक-संज्ञा अस्ति?","options":["बालकः","गमनम्","गुरुः","वृक्षः"],"answer":1,"subject":"lang1_skt"},{"question":"यदि पाठे “पर्यावरणसंरक्षणम्” विषयः वर्णितः, तर्हि मुख्यः उद्देश्यः कः भवति?","options":["वनविनाशस्य समर्थनम्","प्रकृतेः उपयोगः केवलम्","प्रकृतिसंरक्षणे छात्राणां जागरूकता","उद्योगविकासस्य प्रशंसा"],"answer":2,"subject":"lang1_skt"},
{"question":"निम्नलिखितेषु कः सुभाषितस्य सामान्यः सन्देशः?","options":["शीघ्रलाभः श्रेष्ठः","परोपकारः पुण्याय भवति","स्वार्थः एव जीवनम्","बलं सर्वस्य कारणम्"],"answer":1,"subject":"lang1_skt"},
  {"question": "‘विद्या ददाति विनयम्’ इति वाक्ये ‘विनयम्’ पदस्य विभक्तिः का?", "options": ["प्रथमा", "द्वितीया", "तृतीया", "सप्तमी"], "answer": 1, "subject": "lang1_skt"},
  {"question": "‘बालकाः उद्याने क्रीडन्ति’ इति वाक्ये कर्तृपदं किम्?", "options": ["बालकाः", "उद्याने", "क्रीडन्ति", "क्रीडा"], "answer": 0, "subject": "lang1_skt"},
  {"question": "‘फलानि’ इति पदस्य एकवचनरूपं किम्?", "options": ["फलः", "फलम्", "फले", "फलानि"], "answer": 1, "subject": "lang1_skt"},
  {"question": "‘गच्छति’ इति क्रियापदस्य कालः कः?", "options": ["भूतकालः", "भविष्यत्कालः", "वर्तमानकालः", "आज्ञार्थः"], "answer": 2, "subject": "lang1_skt"},
  {"question": "‘रामः वनं गच्छति’ इति वाक्ये कर्मपदं किम्?", "options": ["रामः", "वनं", "गच्छति", "राम"], "answer": 1, "subject": "lang1_skt"},
  {"question": "‘सुन्दरः पुष्पः’ इत्यत्र विशेषणपदं किम्?", "options": ["सुन्दरः", "पुष्पः", "सुन्दरे", "पुष्पे"], "answer": 0, "subject": "lang1_skt"},
  {"question": "‘अहं पठामि’ इति वाक्ये पुरुषः कः?", "options": ["प्रथमपुरुषः", "मध्यमपुरुषः", "उत्तमपुरुषः", "अन्यः"], "answer": 2, "subject": "lang1_skt"},
  {"question": "‘बालिकायै पुस्तकम् ददाति’ इत्यत्र ‘बालिकायै’ पदस्य विभक्तिः का?", "options": ["प्रथमा", "द्वितीया", "चतुर्थी", "षष्ठी"], "answer": 2, "subject": "lang1_skt"},
  {"question": "‘गुरवः’ इति पदस्य वचनं किम्?", "options": ["एकवचनम्", "द्विवचनम्", "बहुवचनम्", "नपुंसकलिङ्गम्"], "answer": 2, "subject": "lang1_skt"},
  {"question": "‘नदी तीरं वहति’ इति वाक्ये ‘नदी’ पदस्य लिङ्गं किम्?", "options": ["पुल्लिङ्गम्", "स्त्रीलिङ्गम्", "नपुंसकलिङ्गम्", "उभयलिङ्गम्"], "answer": 1, "subject": "lang1_skt"},
  {"question": "‘पठ’ इति पदं कस्य लकारस्य उदाहरणम्?", "options": ["लट्", "लङ्", "लृट्", "लोट्"], "answer": 3, "subject": "lang1_skt"},
  {"question": "‘विद्यालये छात्राः पठन्ति’ इति वाक्ये अधिकरणपदं किम्?", "options": ["विद्यालये", "छात्राः", "पठन्ति", "पाठः"], "answer": 0, "subject": "lang1_skt"},
  {"question": "‘सत्यं वद’ इति वाक्यं कस्य अर्थं बोधयति?", "options": ["प्रश्नः", "आदेशः", "उपदेशः", "वर्णनम्"], "answer": 2, "subject": "lang1_skt"},
  {"question": "‘जलम्’ इति पदस्य पर्यायपदं किम्?", "options": ["अग्निः", "पवनः", "तोयम्", "पृथ्वी"], "answer": 2, "subject": "lang1_skt"},
  {"question": "‘क्रीडितुम्’ इति पदं किम्?", "options": ["तिङन्तम्", "कृदन्तम्", "अव्ययम्", "संज्ञा"], "answer": 1, "subject": "lang1_skt"},
  {"question": "‘वनात् ग्रामं गच्छति’ इत्यत्र ‘वनात्’ पदस्य विभक्तिः का?", "options": ["द्वितीया", "तृतीया", "पञ्चमी", "सप्तमी"], "answer": 2, "subject": "lang1_skt"},
  {"question": "‘छात्रः परिश्रमं करोति’ इति वाक्ये ‘परिश्रमं’ पदस्य भूमिका का?", "options": ["कर्ता", "कर्म", "करणम्", "अधिकरणम्"], "answer": 1, "subject": "lang1_skt"},
  {"question": "‘माता पुत्रं स्नेहेन पालयति’ इत्यत्र ‘स्नेहेन’ पदं किम् सूचयति?", "options": ["कालम्", "स्थानम्", "करणम्", "भावम्"], "answer": 3, "subject": "lang1_skt"},
  {"question": "‘परोपकाराय फलन्ति वृक्षाः’ इति वाक्यस्य मुख्यभावः कः?", "options": ["स्वार्थः", "परोपकारः", "स्पर्धा", "आलस्यः"], "answer": 1, "subject": "lang1_skt"},



{"question":"ഒരു പാഠത്തിൽ കഥാപാത്രത്തിന്റെ മനോഭാവം പ്രവർത്തികളിലൂടെ വ്യക്തമാക്കുന്ന രചനാശൈലി ഏതാണ്?","options":["വിവരണരീതി","സംഭാഷണരീതി","ആന്തരികസംഭാഷണം","സംഭവവിവരണം"],"answer":2,"subject":"lang1_mal1"},
{"question":"“മനുഷ്യനും പ്രകൃതിയും തമ്മിലുള്ള ബന്ധം” എന്ന ആശയം ഊന്നിപ്പറയുന്ന പാഠത്തിന്റെ പ്രധാന ലക്ഷ്യം ഏത്?","options":["പ്രകൃതിയുടെ ആധിപത്യം കാണിക്കൽ","മനുഷ്യന്റെ സൗകര്യങ്ങൾ വർധിപ്പിക്കൽ","പരിസ്ഥിതിബോധം വളർത്തൽ","സാങ്കേതികവിദ്യയുടെ പ്രാധാന്യം"],"answer":2,"subject":"lang1_mal1"},
{"question":"ഒരു കവിതയിൽ പ്രതീകം ഉപയോഗിക്കുന്നതിന്റെ പ്രധാന ഉദ്ദേശ്യം എന്താണ്?","options":["വാക്കുകളുടെ എണ്ണം വർധിപ്പിക്കൽ","ആശയം ആഴത്തിൽ സൂചിപ്പിക്കൽ","വായനാസൗകര്യം കുറയ്ക്കൽ","കഥാപരിണാമം വേഗത്തിലാക്കൽ"],"answer":1,"subject":"lang1_mal1"},
{"question":"“അവൻ പറഞ്ഞത് ഹൃദയം തൊട്ടു” എന്ന വാക്യത്തിൽ ഉപയോഗിച്ചിരിക്കുന്ന ഭാഷാപ്രയോഗം ഏത്?","options":["ശബ്ദാലങ്കാരം","ഉപമ","ലാക്ഷണികപ്രയോഗം","നേരർത്ഥപ്രയോഗം"],"answer":2,"subject":"lang1_mal1"},
{"question":"ഒരു ലേഖനം വിലയിരുത്തൽ സ്വഭാവമുള്ളതാക്കാൻ ഏറ്റവും ആവശ്യമായ ഘടകം ഏത്?","options":["വ്യക്തിപരമായ അനുഭവങ്ങൾ മാത്രം","യുക്തിപരമായ വാദങ്ങളും തെളിവുകളും","സംഭവങ്ങളുടെ ക്രമാനുസരണം","സംഭാഷണങ്ങളുടെ സാന്നിധ്യം"],"answer":1,"subject":"lang1_mal1"},
{"question":"സാമൂഹിക വിഷയങ്ങൾ കൈകാര്യം ചെയ്യുന്ന പാഠങ്ങളിൽ കഥാപാത്രസംഘർഷം ഉൾപ്പെടുത്തുന്നതിന്റെ പ്രധാന ലക്ഷ്യം എന്ത്?","options":["വിനോദം നൽകാൻ മാത്രം","കഥ നീട്ടാൻ","സാമൂഹിക പ്രശ്നങ്ങളുടെ സങ്കീർണ്ണത കാണിക്കാൻ","ഭാഷാ വൈവിധ്യം പ്രദർശിപ്പിക്കാൻ"],"answer":2,"subject":"lang1_mal1"},
{"question": "“മണ്ണ് നമ്മെ പഠിപ്പിക്കുന്ന പാഠം” എന്ന പ്രയോഗത്തിൽ ‘മണ്ണ്’ സൂചിപ്പിക്കുന്നത് എന്തിനെ?", "options": ["ഭൂമിശാസ്ത്ര വസ്തു", "കൃഷിയിടം", "ജീവിതാനുഭവങ്ങൾ", "കല്ലും ചെളിയും"], "answer": 2, "subject": "lang1_mal1"},
{"question": "താഴെ നൽകിയിരിക്കുന്നവയിൽ ഉപമാലങ്കാരം ഉള്ള വാക്യം ഏത്?", "options": ["അവൻ സിംഹമാണ്", "അവൻ സിംഹത്തെപ്പോലെ ധൈര്യവാനാണ്", "അവൻ ധൈര്യവാനായി", "അവൻ ഭയമില്ലാതെ നിന്നു"], "answer": 1, "subject": "lang1_mal1"},
{"question": "“വിദ്യ മനുഷ്യനെ സ്വതന്ത്രനാക്കുന്നു” എന്ന വാക്യത്തിലെ ക്രിയ ഏത്?", "options": ["വിദ്യ", "മനുഷ്യനെ", "സ്വതന്ത്രനാക്കുന്നു", "മനുഷ്യൻ"], "answer": 2, "subject": "lang1_mal1"},
{"question": "താഴെ കൊടുത്തിരിക്കുന്നവയിൽ ഭാവനാത്മക ഭാഷ ഉപയോഗിച്ചിരിക്കുന്നത് ഏത്?", "options": ["മഴ പെയ്യുന്നു", "സൂര്യൻ ഉദിക്കുന്നു", "പ്രകൃതി പുഞ്ചിരിച്ചു", "കുട്ടി ഓടുന്നു"], "answer": 2, "subject": "lang1_mal1"},
{"question": "“അവൾ പുസ്തകം വായിച്ചു” എന്ന വാക്യത്തിൽ കർമ്മം ഏത്?", "options": ["അവൾ", "വായിച്ചു", "പുസ്തകം", "വാക്യം"], "answer": 2, "subject": "lang1_mal1"},
{"question": "താഴെ നൽകിയിരിക്കുന്നവയിൽ സാമൂഹിക മൂല്യം പ്രകടമാകുന്നത് ഏത്?", "options": ["സ്വന്തമായി വിജയിക്കുക", "മറ്റുള്ളവരെ സഹായിക്കുക", "മത്സരത്തിൽ ജയിക്കുക", "കൂടുതൽ സമ്പാദിക്കുക"], "answer": 1, "subject": "lang1_mal1"},
{"question": "“പ്രകൃതി സംരക്ഷണം നമ്മുടെ ഉത്തരവാദിത്വമാണ്” — ഈ വാക്യത്തിന്റെ മുഖ്യ ആശയം എന്ത്?", "options": ["പ്രകൃതി സുന്ദരമാണ്", "മനുഷ്യൻ ശക്തനാണ്", "ഉത്തരവാദിത്വബോധം", "സംരക്ഷണം ബുദ്ധിമുട്ടാണ്"], "answer": 2, "subject": "lang1_mal1"},
{"question": "താഴെ കൊടുത്തിരിക്കുന്നവയിൽ നാമവാചകം ഏത്?", "options": ["പഠിക്കുക", "സ്നേഹം", "ഓടുന്നു", "ചിന്തിച്ചു"], "answer": 1, "subject": "lang1_mal1"},
{"question": "“അവൻ കഠിനമായി പരിശ്രമിച്ചു” — ഇവിടെ ക്രിയാവിശേഷണം ഏത്?", "options": ["അവൻ", "പരിശ്രമിച്ചു", "കഠിനമായി", "ആയി"], "answer": 2, "subject": "lang1_mal1"},
{"question": "കഥയിലെ കഥാപാത്രത്തിന്റെ സ്വഭാവം തിരിച്ചറിയാൻ ഏറ്റവും സഹായിക്കുന്നതു ഏത്?", "options": ["സംഭവങ്ങളുടെ എണ്ണം", "സംഭാഷണങ്ങൾ", "പേജുകളുടെ എണ്ണം", "തലക്കെട്ട്"], "answer": 1, "subject": "lang1_mal1"},
{"question": "താഴെ കൊടുത്തിരിക്കുന്നവയിൽ സന്ധി ഉണ്ടായിരിക്കുന്നത് ഏത്?", "options": ["മലയാളം + ഭാഷ", "നല്ല + കുട്ടി", "രാജ + പുത്രൻ", "കുട്ടി + പുസ്തകം"], "answer": 2, "subject": "lang1_mal1"},
{"question": "“അവൾ പാടുമ്പോൾ പക്ഷികൾ നിശ്ശബ്ദമായി” — ഇതിൽ സൂചിപ്പിക്കുന്ന ഭാവം ഏത്?", "options": ["ഭയം", "ദുഃഖം", "ആസ്വാദനം", "കോപം"], "answer": 2, "subject": "lang1_mal1"},
{"question": "താഴെ കൊടുത്തിരിക്കുന്നവയിൽ വ്യക്തിവിവരണം ഉള്ളത് ഏത്?", "options": ["അവൻ ഉയരം കൂടിയവനാണ്", "മഴ ശക്തമായി പെയ്തു", "പുഴ ഒഴുകുന്നു", "വണ്ടി ഓടി"], "answer": 0, "subject": "lang1_mal1"},
{"question": "“അറിവാണ് മനുഷ്യനെ മനുഷ്യനാക്കുന്നത്” — ഇവിടെ ആവർത്തന ആശയം എന്ത്?", "options": ["അറിവിന്റെ ശക്തി", "സമ്പത്തിന്റെ മൂല്യം", "ശരീരബലം", "അധികാരം"], "answer": 0, "subject": "lang1_mal1"},
{"question": "താഴെ കൊടുത്തിരിക്കുന്നവയിൽ കവിതയുടെ പ്രത്യേകത ഏത്?", "options": ["സംഭവ വിവരണം", "നിയമ വിശദീകരണം", "ലയവും ഭാവവും", "നിർദ്ദേശങ്ങൾ"], "answer": 2, "subject": "lang1_mal1"},
{"question": "“നമ്മുടെ നാടിന്റെ ഭാവി കുട്ടികളാണ്” — വാക്യത്തിലെ പ്രമേയം ഏത്?", "options": ["നാട്", "ഭാവി", "കുട്ടികൾ", "നമ്മുടെ"], "answer": 2, "subject": "lang1_mal1"},
{"question": "താഴെ കൊടുത്തിരിക്കുന്നവയിൽ പരിസ്ഥിതി ബോധം പ്രകടമാകുന്നത് ഏത്?", "options": ["മരങ്ങൾ വെട്ടി റോഡ് പണിയുക", "പ്ലാസ്റ്റിക് ഉപയോഗം വർധിപ്പിക്കുക", "ജലസ്രോതസുകൾ സംരക്ഷിക്കുക", "വന്യജീവികളെ വേട്ടയാടുക"], "answer": 2, "subject": "lang1_mal1"},
{"question": "ഒരു ലേഖനത്തിന്റെ ഉദ്ദേശ്യം കണ്ടെത്താൻ ഏറ്റവും പ്രധാനമായത് ഏത്?", "options": ["വാക്കുകളുടെ എണ്ണം", "എഴുത്തുകാരന്റെ നിലപാട്", "അക്ഷരത്തെറ്റ്", "അച്ചടിച്ച ഫോണ്ട്"], "answer": 1, "subject": "lang1_mal1"},
{"question": "“വായന മനുഷ്യനെ സമ്പന്നനാക്കുന്നു” — ഇവിടെ ‘സമ്പന്നൻ’ സൂചിപ്പിക്കുന്നത് എന്ത്?", "options": ["ധനം", "ആഭരണങ്ങൾ", "അറിവും ചിന്തയും", "ഭൂമി"], "answer": 2, "subject": "lang1_mal1"},
{"question": "‘മനുഷ്യൻ സാമൂഹ്യജീവിയാണ്’ എന്ന വാക്യത്തിൽ അടങ്ങിയിരിക്കുന്ന മുഖ്യ ആശയം ഏത്?", "options": ["വ്യക്തിസ്വാതന്ത്ര്യം", "സഹവാസത്തിന്റെ ആവശ്യകത", "സാമ്പത്തിക പുരോഗതി", "സാംസ്‌കാരിക വൈവിധ്യം"], "answer": 1, "subject": "lang1_mal1"},
{"question": "‘കാടാണ് മനുഷ്യന്റെ ആദ്യ വിദ്യാലയം’ എന്ന പ്രസ്താവന സൂചിപ്പിക്കുന്നത് എന്ത്?", "options": ["ഔപചാരിക വിദ്യാഭ്യാസം", "പ്രകൃതിയിലൂടെ ലഭിക്കുന്ന പഠനം", "ശാസ്ത്രീയ ഗവേഷണം", "ചരിത്രപരമായ വിദ്യാഭ്യാസം"], "answer": 1, "subject": "lang1_mal1"},
{"question": "‘അവൻ മൗനമായി തലകുനിച്ചു’ എന്ന വാക്യത്തിൽ ‘മൗനമായി’ എന്ന പദത്തിന്റെ വ്യാകരണപദവി എന്ത്?", "options": ["വിശേഷണം", "ക്രിയാവിശേഷണം", "നാമം", "സർവ്വനാമം"], "answer": 1, "subject": "lang1_mal1"},
{"question": "‘ജീവിതം ഒരു യാത്രയാണ്’ എന്ന വാക്യത്തിൽ ഉപയോഗിച്ച അലങ്കാരം ഏത്?", "options": ["അതിശയോക്തി", "രൂപകം", "ഉപമ", "വിരുദ്ധാലങ്കാരം"], "answer": 1, "subject": "lang1_mal1"},
{"question": "താഴെപ്പറയുന്നവയിൽ പര്യായപദങ്ങളുടെ ശരിയായ കൂട്ടം ഏത്?", "options": ["സൂര്യൻ – ചന്ദ്രൻ", "ജലം – വെള്ളം", "ഭൂമി – ആകാശം", "പകലു – രാത്രി"], "answer": 1, "subject": "lang1_mal1"},
{"question": "‘വിദ്യ മനുഷ്യനെ സ്വതന്ത്രനാക്കുന്നു’ എന്ന വാക്യത്തിൽ ‘വിദ്യ’ എന്ന പദത്തിന്റെ കാർമ്മിക ബന്ധം ഏത്?", "options": ["കർത്താവ്", "കർമ്മം", "ക്രിയ", "വിശേഷണം"], "answer": 0, "subject": "lang1_mal1"},
{"question": "‘അവൾ പാടിക്കൊണ്ടിരിക്കുകയായിരുന്നു’ എന്ന വാക്യത്തിലെ കാലം ഏത്?", "options": ["വർത്തമാനകാലം", "ഭൂതകാലം", "ഭാവികാലം", "ഭൂതവർത്തമാനകാലം"], "answer": 3, "subject": "lang1_mal1"},
{"question": "‘മഴ പെയ്തിട്ടും അവൻ യാത്ര തുടർന്നു’ എന്ന വാക്യത്തിൽ ബന്ധകപദം ഏത്?", "options": ["മഴ", "പെയ്തിട്ടും", "അവൻ", "തുടർന്നു"], "answer": 1, "subject": "lang1_mal1"},
{"question": "‘അമ്മയുടെ വാക്കുകൾ അവനെ പ്രചോദിപ്പിച്ചു’ എന്ന വാക്യത്തിൽ ‘പ്രചോദിപ്പിച്ചു’ എന്ന ക്രിയ സൂചിപ്പിക്കുന്നത് എന്ത്?", "options": ["ശാരീരിക പ്രവർത്തനം", "മാനസിക പ്രവർത്തനം", "യാന്ത്രിക പ്രവർത്തനം", "സ്വാഭാവിക പ്രവർത്തനം"], "answer": 1, "subject": "lang1_mal1"},
{"question": "‘കഠിനാധ്വാനം വിജയം നൽകും’ എന്ന വാക്യത്തിലെ മൂല്യബോധം ഏത്?", "options": ["സമ്പത്ത്", "ഭാഗ്യം", "പരിശ്രമത്തിന്റെ മഹത്വം", "മത്സരബോധം"], "answer": 2, "subject": "lang1_mal1"},
{"question": "‘അവൻ പുസ്തകം വായിച്ചു തീർത്തു’ എന്ന വാക്യത്തിലെ ‘തീർത്തു’ എന്ന പദം സൂചിപ്പിക്കുന്നത് എന്ത്?", "options": ["തുടക്കം", "ആവർത്തനം", "പൂർത്തീകരണം", "ശ്രമം"], "answer": 2, "subject": "lang1_mal1"},
{"question": "‘നദികൾ കടലിലേക്ക് ഒഴുകുന്നു’ എന്ന വാക്യത്തിൽ പ്രകൃതിനിയമമായി അവതരിപ്പിച്ച ആശയം ഏത്?", "options": ["മനുഷ്യനിയന്ത്രണം", "പ്രകൃതിയുടെ ചക്രവാളം", "സാങ്കേതിക പുരോഗതി", "പരിപരിസ്ഥിതി മലിനീകരണം"], "answer": 1, "subject": "lang1_mal1"},
{"question": "‘വാക്കുകൾ മുറിവേൽപ്പിക്കും’ എന്ന പ്രയോഗം ഏത് തരത്തിലുള്ള അർത്ഥം വഹിക്കുന്നു?", "options": ["അക്ഷരാർത്ഥം", "വ്യഞ്ജനാർത്ഥം", "ശാബ്ദാർത്ഥം", "സാങ്കേതികാർത്ഥം"], "answer": 1, "subject": "lang1_mal1"},
{"question": "‘കുട്ടികൾ കളിച്ചുകൊണ്ടിരുന്നു’ എന്ന വാക്യത്തിൽ ‘കൊണ്ടിരുന്നു’ എന്ന ഘടകം സൂചിപ്പിക്കുന്നത് എന്ത്?", "options": ["പെട്ടെന്നുള്ള പ്രവർത്തനം", "തുടർച്ചയായ പ്രവർത്തനം", "ആജ്ഞ", "സാധ്യത്യ"], "answer": 1, "subject": "lang1_mal1"},
{"question": "‘പുസ്തകങ്ങളാണ് എന്റെ ലോകം’ എന്ന വാക്യത്തിലെ ഭാഷാശൈലി ഏത്?", "options": ["വിവരണാത്മക", "വാചകാത്മക", "വികാരാത്മക", "ആലങ്കാരിക"], "answer": 3, "subject": "lang1_mal1"},
{"question": "‘അവൾ അവന്റെ വാക്കുകൾ ഹൃദയത്തിൽ സൂക്ഷിച്ചു’ എന്ന വാക്യം സൂചിപ്പിക്കുന്നത് എന്ത്?", "options": ["മറക്കൽ", "അവഗണന", "മാനസിക സ്വീകാര്യത", "വിമർശനം"], "answer": 2, "subject": "lang1_mal1"},
{"question": "‘നല്ലത് ചെയ്യുക, നല്ലത് ചിന്തിക്കുക’ എന്ന വാക്യം ഏത് വിഭാഗത്തിൽപ്പെടുന്നു?", "options": ["ചോദ്യം", "ഉപദേശം", "വിവരണം", "വാർത്ത"], "answer": 1, "subject": "lang1_mal1"},
{"question": "‘അവന്റെ കണ്ണുകളിൽ പ്രതീക്ഷ തെളിഞ്ഞു’ എന്ന പ്രയോഗത്തിൽ ‘പ്രതീക്ഷ’ എന്തിനെ സൂചിപ്പിക്കുന്നു?", "options": ["ഭൗതിക വസ്തു", "മാനസികാവസ്ഥ", "പ്രകൃതി ഘടകം", "പ്രവർത്തനം"], "answer": 1, "subject": "lang1_mal1"},
{"question": "‘സമൂഹമില്ലാതെ വ്യക്തിയില്ല’ എന്ന വാക്യത്തിന്റെ കേന്ദ്രസങ്കൽപ്പം ഏത്?", "options": ["ব্যক্তিപരത", "സാമൂഹികബന്ധം", "സാമ്പത്തിക വളർച്ച", "രാഷ്ട്രീയ ബോധം"], "answer": 1, "subject": "lang1_mal1"},
 
 


{"question":"ഒരു പാഠത്തിൽ സാമൂഹിക അസമത്വം സൂചിപ്പിക്കാൻ എഴുത്തുകാരൻ സാധാരണയായി ഉപയോഗിക്കുന്ന രചനാരീതി ഏത്?","options":["പ്രകൃതിവിവരണം","പ്രതീകാത്മക അവതരണം","ചരിത്രവിവരണം","ശാസ്ത്രീയ വിശദീകരണം"],"answer":1,"subject":"mal2"},
{"question":"“അവൾ മൗനംകൊണ്ട് തന്നെ പ്രതിഷേധിച്ചു” എന്ന വാക്യത്തിൽ മൗനം എന്നത് ഏത് അർത്ഥത്തിൽ ഉപയോഗിച്ചിരിക്കുന്നു?","options":["നേരർത്ഥത്തിൽ","ശബ്ദാർത്ഥത്തിൽ","ലാക്ഷണിക അർത്ഥത്തിൽ","വ്യാകരണാർത്ഥത്തിൽ"],"answer":2,"subject":"mal2"},
{"question":"ഒരു കവിതയിൽ വിരുദ്ധാഭാസം (Paradox) ഉപയോഗിക്കുന്നതിന്റെ പ്രധാന ലക്ഷ്യം എന്ത്?","options":["ആശയം ലളിതമാക്കാൻ","വായനക്കാരനെ ആശയക്കുഴപ്പത്തിലാക്കാൻ","ചിന്തയെ ഉണർത്താൻ","ഭാഷയെ ദുർബലമാക്കാൻ"],"answer":2,"subject":"mal2"},
{"question":"ഒരു ലേഖനം വിമർശനാത്മക സ്വഭാവമുള്ളതാകാൻ ഏറ്റവും ആവശ്യമായ ഘടകം ഏത്?","options":["വികാരാധിഷ്ഠിത അവതരണം","വ്യക്തിപരമായ അഭിപ്രായങ്ങൾ മാത്രം","യുക്തിസഹമായ നിരീക്ഷണവും വിശകലനവും","വിവരണങ്ങളുടെ ആവർത്തനം"],"answer":2,"subject":"mal2"},{"question":"വിദ്യാഭ്യാസപരമായ പാഠങ്ങളിൽ മൂല്യബോധം ശക്തിപ്പെടുത്തുന്നതിനായി എഴുത്തുകാരൻ കൂടുതലായി ഊന്നൽ നൽകുന്നത് ഏതിനാണ്?","options":["വ്യക്തിഗത വിജയം","സാമൂഹിക ഉത്തരവാദിത്വം","മത്സരമനോഭാവം","സാമ്പത്തിക നേട്ടം"],"answer":1,"subject":"mal2"},
{"question":"സമൂഹമാറ്റത്തെ ലക്ഷ്യമിടുന്ന പാഠങ്ങളിൽ കഥാപാത്രത്തിന്റെ പരിവർത്തനം ഉൾപ്പെടുത്തുന്നത് എന്തുകൊണ്ട് പ്രധാനമാണ്?","options":["കഥ നീളാൻ","ഭാഷാസൗന്ദര്യം വർധിക്കാൻ","സാമൂഹിക സന്ദേശം വ്യക്തമാക്കാൻ","സംഭവക്രമം വേഗത്തിലാക്കാൻ"],"answer":2,"subject":"mal2"},
{"question":"‘ഭൂമിയെ സംരക്ഷിക്കുക മനുഷ്യന്റെ കടമയാണ്’ എന്ന വാക്യം ഏത് മൂല്യബോധം വ്യക്തമാക്കുന്നു?","options":["സാമ്പത്തിക വളർച്ച","പരിസ്ഥിതി ഉത്തരവാദിത്വം","വ്യക്തിസ്വാതന്ത്ര്യം","സാങ്കേതിക പുരോഗതി"],"answer":1,"subject":"mal2"},
{"question":"‘അവന്റെ വാക്കുകൾ ഹൃദയത്തെ തൊട്ടു’ എന്ന പ്രയോഗം ഏത് അർത്ഥതലത്തിൽപ്പെടുന്നു?","options":["ശാബ്ദാർത്ഥം","അക്ഷരാർത്ഥം","ব্যഞ്ജനാർത്ഥം","സാങ്കേതികാർത്ഥം"],"answer":2,"subject":"mal2"},
{"question":"‘നിലാവ് കടലിനെ വെള്ളിപ്പൂശി’ എന്ന വാക്യത്തിലെ അലങ്കാരം ഏത്?","options":["ഉപമ","രൂപകം","അതിശയോക്തി","വിരുദ്ധാലങ്കാരം"],"answer":1,"subject":"mal2"},
{"question":"‘അവൾ അറിവ് തേടി ലോകം കണ്ടു’ എന്ന വാക്യം സൂചിപ്പിക്കുന്നത് എന്ത്?","options":["വിനോദയാത്ര","അനുഭവസമ്പാദനം","സാമ്പത്തികലാഭം","മത്സരമനോഭാവം"],"answer":1,"subject":"mal2"},
{"question":"‘കാലം ആരെയും കാത്തിരിക്കില്ല’ എന്ന പ്രയോഗം എന്ത് ഓർമ്മിപ്പിക്കുന്നു?","options":["ഭാഗ്യവിശ്വാസം","സമയത്തിന്റെ മൂല്യം","പ്രകൃതിനിയമം","മനുഷ്യദൗർബല്യം"],"answer":1,"subject":"mal2"},
{"question":"‘അവൻ വാക്കുകൾ അളന്ന് സംസാരിച്ചു’ എന്ന വാക്യം സൂചിപ്പിക്കുന്ന സ്വഭാവം ഏത്?","options":["ധൈര്യം","വിവേകം","അശ്രദ്ധ","ആകസ്മികത"],"answer":1,"subject":"mal2"},
{"question":"‘വിദ്യാഭ്യാസം സാമൂഹികമാറ്റത്തിന് വഴി തുറക്കും’ എന്ന വാക്യത്തിന്റെ കേന്ദ്രസങ്കൽപ്പം ഏത്?","options":["വ്യക്തിപരവിജയം","സാമൂഹിക പുരോഗതി","സാമ്പത്തിക ശക്തി","സാംസ്‌കാരിക പൈതൃകം"],"answer":1,"subject":"mal2"},
{"question":"‘മഴയെ കാത്ത് നിലം വിങ്ങി’ എന്ന പ്രയോഗത്തിൽ ‘വിങ്ങി’ സൂചിപ്പിക്കുന്നത് എന്ത്?","options":["സന്തോഷം","പ്രതീക്ഷ","ദുഃഖം","ആകുലത"],"answer":3,"subject":"mal2"},
{"question":"‘വാക്കുകൾ പാലിക്കുക മനുഷ്യന്റെ ഗുണമാണ്’ എന്ന വാക്യം ഏത് ഗുണത്തെ ഉയർത്തിപ്പിടിക്കുന്നു?","options":["സത്യസന്ധത","ധൈര്യം","കഠിനാധ്വാനം","മത്സരം"],"answer":0,"subject":"mal2"},
{"question":"‘പ്രകൃതി മനുഷ്യന്റെ അധ്യാപികയാണ്’ എന്ന വാക്യം ഏത് ആശയം വെളിപ്പെടുത്തുന്നു?","options":["സാങ്കേതികവിദ്യ","പ്രകൃതിയിൽ നിന്നുള്ള പഠനം","നഗരവികസനം","ചരിത്രബോധം"],"answer":1,"subject":"mal2"},
{"question":"‘അവന്റെ മൗനം തന്നെ മറുപടിയായി’ എന്ന വാക്യം സൂചിപ്പിക്കുന്നത് എന്ത്?","options":["അവഗണന","സമ്മതം","അജ്ഞാനം","ഭയം"],"answer":1,"subject":"mal2"},
{"question":"‘നദികൾ നമ്മെ ജീവിതത്തിന്റെ ഒഴുക്ക് പഠിപ്പിക്കുന്നു’ എന്ന വാക്യം ഏത് തരത്തിലുള്ള അവതരണമാണ്?","options":["വിവരണാത്മക","ഉപദേശാത്മക","ആലങ്കാരിക","വാർത്താപര"],"answer":2,"subject":"mal2"},
{"question":"‘അവൾ കണ്ണുകളിൽ സ്വപ്നങ്ങൾ സൂക്ഷിച്ചു’ എന്ന പ്രയോഗം എന്തിനെ സൂചിപ്പിക്കുന്നു?","options":["ഉറക്കം","ആഗ്രഹങ്ങൾ","ഓർമ്മകൾ","ഭയം"],"answer":1,"subject":"mal2"},
{"question":"‘സമയത്തെ മാനിക്കുന്നവനാണ് വിജയി’ എന്ന വാക്യം ഏത് മനോഭാവം വളർത്തുന്നു?","options":["അലംഭാവം","ഉത്തരവാദിത്വം","മത്സരബോധം","ആകസ്മികത"],"answer":1,"subject":"mal2"},
{"question":"‘വാക്കുകൾ ആയുധങ്ങളാകാം’ എന്ന പ്രയോഗം ഏത് ആശയം ശക്തിപ്പെടുത്തുന്നു?","options":["ഭാഷയുടെ സൗന്ദര്യം","ഭാഷയുടെ ശക്തി","സാഹിത്യരസം","ശബ്ദസൗകര്യം"],"answer":1,"subject":"mal2"},
{"question":"‘അവൻ സമൂഹത്തിനായി ജീവിച്ചു’ എന്ന വാക്യം ഏത് മൂല്യത്തെ സൂചിപ്പിക്കുന്നു?","options":["സ്വാർത്ഥത","പരോപകാരം","അധികാരം","വ്യക്തിമഹത്വം"],"answer":1,"subject":"mal2"},
{"question":"‘ജീവിതപാഠങ്ങൾ പുസ്തകത്തിൽ മാത്രമല്ല’ എന്ന വാക്യം എന്ത് സൂചിപ്പിക്കുന്നു?","options":["ഔപചാരിക വിദ്യാഭ്യാസം","അനുഭവപഠനം","സാങ്കേതിക പരിശീലനം","പരീക്ഷാകേന്ദ്രിത പഠനം"],"answer":1,"subject":"mal2"},
{"question":"‘പ്രയത്നം തന്നെയാണ് പ്രതിഫലം’ എന്ന വാക്യം ഏത് ആശയത്തെ ഉന്നയിക്കുന്നു?","options":["ഭാഗ്യവിശ്വാസം","പരിശ്രമത്തിന്റെ മഹത്വം","മത്സരമനോഭാവം","ലാഭലക്ഷ്യം"],"answer":1,"subject":"mal2"},
{"question":"‘മനുഷ്യൻ പ്രകൃതിയുടെ ഭാഗമാണ്’ എന്ന വാക്യത്തിന്റെ അടിസ്ഥാനസന്ദേശം ഏത്?","options":["മനുഷ്യാധിപത്യം","പ്രകൃതിസമന്വയം","ব্যവസായവികസനം","നഗരവൽക്കരണം"],"answer":1,"subject":"mal2"},


{"question":"A number when divided by 5 leaves remainder 2, and when divided by 7 leaves remainder 4. Which of the following is the smallest such number?","options":["9","12","37","39"],"answer":2,"subject":"maths"},
{"question":"A shopkeeper marks an article 25% more than its cost price and then gives a 10% discount. What is the overall gain or loss?","options":["12.5% gain","10% gain","12.5% loss","No gain, no loss"],"answer":0,"subject":"maths"},{"question":"In a sequence: 2, 6, 12, 20, 30, ? The next number is:","options":["40","41","42","44"],"answer":2,"subject":"maths"},
{"question":"A rectangular field has length twice its breadth. If the perimeter is 72 m, what is the area of the field?","options":["192 sq.m","216 sq.m","288 sq.m","324 sq.m"],"answer":2,"subject":"maths"},
{"question":"Three numbers are in the ratio 3 : 5 : 7. If their sum is 300, the largest number is:","options":["120","100","140","150"],"answer":2,"subject":"maths"},
{"question":"The HCF of two numbers is 12 and their LCM is 180. If one number is 36, the other number is:","options":["54","72","60","48"],"answer":3,"subject":"maths"},
{"question":"A number is divisible by both 4 and 9. Which of the following must be true?","options":["It is divisible by 18","It is divisible by 36","It is divisible by 12","It is divisible by 16"],"answer":1,"subject":"maths"},
{"question":"The average of 8 consecutive natural numbers is 27.5. What is the smallest number?","options":["23","24","25","26"],"answer":1,"subject":"maths"},
{"question":"If the perimeter of a square is numerically equal to the area of the square, what is the length of one side?","options":["2 units","4 units","8 units","16 units"],"answer":1,"subject":"maths"},
{"question":"A number when multiplied by 0.25 gives 18. What is the number?","options":["4.5","36","72","90"],"answer":2,"subject":"maths"},
{"question":"How many two-digit numbers are divisible by both 3 and 5?","options":["5","6","7","8"],"answer":1,"subject":"maths"},
{"question":"In a triangle, two angles are 35° and 75°. What is the third angle?","options":["65°","70°","75°","80°"],"answer":1,"subject":"maths"},
{"question":"If 3² + 4² = 5², this relation is an example of:","options":["Linear equation","Pythagorean identity","Arithmetic progression","Ratio"],"answer":1,"subject":"maths"},
{"question":"The next number in the sequence 2, 6, 12, 20, ___ is:","options":["28","30","32","36"],"answer":1,"subject":"maths"},
{"question":"A shopkeeper gives 10% discount and still gains 8%. What is the marked price if the cost price is ₹500?","options":["₹540","₹600","₹610","₹620"],"answer":1,"subject":"maths"},
{"question":"If x : y = 4 : 7 and y : z = 14 : 15, then x : z = ?","options":["4 : 15","8 : 15","2 : 15","16 : 15"],"answer":1,"subject":"maths"},
{"question":"How many factors does the number 360 have?","options":["18","20","24","30"],"answer":2,"subject":"maths"},
{"question":"A cube has volume 125 cm³. What is the total surface area?","options":["100 cm²","150 cm²","180 cm²","300 cm²"],"answer":1,"subject":"maths"},
{"question":"If the simple interest on a sum for 3 years at 5% per annum is ₹450, what is the principal?","options":["₹2000","₹2500","₹3000","₹3500"],"answer":2,"subject":"maths"},
{"question":"Which fraction is greater?","options":["5/8","7/12","3/4","11/16"],"answer":2,"subject":"maths"},
{"question":"If the radius of a circle is doubled, the area becomes:","options":["Double","Four times","Eight times","Half"],"answer":1,"subject":"maths"},
{"question":"A clock shows 3:20. What is the smaller angle between the hands?","options":["10°","20°","30°","40°"],"answer":1,"subject":"maths"},
{"question":"A number is increased by 20% and then decreased by 20%. What is the net change?","options":["No change","2% increase","4% decrease","5% decrease"],"answer":2,"subject":"maths"},
{"question":"The sum of first n natural numbers is 210. What is n?","options":["19","20","21","22"],"answer":1,"subject":"maths"},
{"question":"A wire is bent to form a square and then a circle. Which statement is correct?","options":["Both have equal area","Square has greater area","Circle has greater area","Area depends on material"],"answer":2,"subject":"maths"},



{"question":"Choose the sentence with the correct spelling.","options":["Enviroment","Environmant","Environment","Envirronment"],"answer":2,"subject":"eng"},
{"question":"Which word is the noun in the sentence? “Honesty is the best policy.”","options":["Honest","Best","Honesty","Is"],"answer":2,"subject":"eng"},
{"question":"Choose the correct plural form of the word “child.”","options":["Childs","Childes","Children","Childrens"],"answer":2,"subject":"eng"},
{"question":"Select the sentence written in the past tense.","options":["She sings well.","She is singing well.","She sang well.","She will sing well."],"answer":2,"subject":"eng"},
{"question":"Which sentence expresses a request?","options":["Close the door.","Can you close the door, please?","The door is closed.","You closed the door."],"answer":1,"subject":"eng"},
{"question":"Choose the word that is opposite in meaning to “begin.”","options":["Start","Open","Continue","End"],"answer":3,"subject":"eng"},
{"question":"Which sentence best shows deduction rather than direct observation?","options":["The lamp is on.","She opened the door.","The lights are off, so nobody seems to be home.","The dog is barking loudly."],"answer":2,"subject":"eng"},
{"question":"Identify the option where the word “light” is used as a verb.","options":["The room needs more light.","This bag is light.","Please light the candle.","Light colours reflect heat."],"answer":2,"subject":"eng"},
{"question":"Choose the sentence that conveys meaning through contrast.","options":["He ran fast and won the race.","She smiled happily.","Though it was raining, they continued the match.","The bell rang sharply."],"answer":2,"subject":"eng"},
{"question":"Which option correctly completes the sentence? “If she had known about the meeting, she _____ attended it.”","options":["will have","would have","has","had"],"answer":1,"subject":"eng"},
{"question":"Identify the sentence where the speaker’s attitude is revealed indirectly.","options":["He said he disliked the idea.","She rolled her eyes and walked away.","The idea was unpopular.","He explained the plan."],"answer":1,"subject":"eng"},
{"question":"Which word best fits the context? “The scientist proposed a ______ solution to reduce plastic waste.”","options":["temporary","conventional","sustainable","careless"],"answer":2,"subject":"eng"},
{"question":"Choose the sentence that uses personification.","options":["The wind whispered through the trees.","The wind was strong.","The wind blew from the east.","The wind caused damage."],"answer":0,"subject":"eng"},
{"question":"Which sentence correctly uses a relative clause?","options":["This is the book which I lost it.","This is the book who I lost.","This is the book that I lost.","This is the book whom I lost."],"answer":2,"subject":"eng"},
{"question":"Identify the option that shows cause and consequence.","options":["She likes painting.","The child was tired.","He missed the bus because he woke up late.","The bus was crowded."],"answer":2,"subject":"eng"},
{"question":"Which sentence reflects the value of responsibility?","options":["He ignored the rules.","She blamed others for the mistake.","He admitted his error and corrected it.","They waited for instructions."],"answer":2,"subject":"eng"},
{"question":"Choose the word closest in meaning to “scrutinise.”","options":["Ignore","Examine closely","Destroy","Simplify"],"answer":1,"subject":"eng"},
{"question":"Identify the sentence where punctuation changes meaning.","options":["Stop eating children.","Stop eating, children.","Both A and B","Neither A nor B"],"answer":2,"subject":"eng"},
{"question":"Which option best represents optimistic tone?","options":["Nothing will improve.","The task was abandoned.","Challenges help us grow stronger.","Failure is permanent."],"answer":2,"subject":"eng"},
{"question":"Choose the correct passive form of the sentence: “They will announce the results tomorrow.”","options":["The results are announced tomorrow.","The results will be announced tomorrow.","The results were announced tomorrow.","The results have announced tomorrow."],"answer":1,"subject":"eng"},
{"question":"Which sentence uses an idiom correctly?","options":["He kicked the bucket angrily.","She spilled the beans about the surprise.","The beans fell on the floor.","He held the bucket carefully."],"answer":1,"subject":"eng"},
{"question":"Identify the sentence with logical sequencing.","options":["He slept because he was tired after working all day.","He worked all day because he slept.","He was tired because he slept.","He slept before he woke up."],"answer":0,"subject":"eng"},
{"question":"Which sentence promotes environmental awareness?","options":["Cars are faster than bicycles.","Recycling helps reduce pollution.","Roads are expanding rapidly.","Factories operate day and night."],"answer":1,"subject":"eng"},
{"question":"Choose the sentence that implies self-discipline.","options":["He waited patiently for his turn.","He shouted loudly.","He demanded immediate attention.","He ignored the instructions."],"answer":0,"subject":"eng"},
{"question":"Select the most suitable title for a passage describing curiosity, questioning, and discovery.","options":["Silent Days","The Power of Questions","Obedience and Order","A Quiet Classroom"],"answer":1,"subject":"eng"},



{"question":"Which gas do humans exhale while breathing?","options":["Oxygen","Carbon dioxide","Nitrogen","Hydrogen"],"answer":1,"subject":"bs"},
{"question":"The process of water vapor changing into liquid water is called:","options":["Evaporation","Condensation","Freezing","Melting"],"answer":1,"subject":"bs"},
{"question":"Which of the following is an insectivore?","options":["Crow","Spider","Tiger","Cow"],"answer":1,"subject":"bs"},{"question":"Which organ in humans produces insulin?","options":["Liver","Pancreas","Kidney","Heart"],"answer":1,"subject":"bs"},
{"question":"Which of the following changes is permanent?","options":["Melting ice","Boiling water","Rusting iron","Dissolving sugar in water"],"answer":2,"subject":"bs"},
{"question":"Which part of the human eye controls the amount of light entering?","options":["Cornea","Retina","Iris","Lens"],"answer":2,"subject":"bs"},
{"question":"Which process best explains how plants reduce excess water loss during hot days?","options":["Respiration","Transpiration control by stomata","Photosynthesis","Germination"],"answer":1,"subject":"bs"}, 
{"question":"A metal spoon feels colder than a wooden spoon at the same temperature because metals:","options":["absorb heat faster","reflect light better","are good conductors of heat","have higher density"],"answer":2,"subject":"bs"},
{"question":"Which change is both physical and reversible?","options":["Rusting of iron","Burning of paper","Melting of ice","Cooking of rice"],"answer":2,"subject":"bs"},
{"question":"The main function of red blood cells is to:","options":["fight infection","digest food","transport oxygen","control body temperature"],"answer":2,"subject":"bs"},
{"question":"Which combination is essential for photosynthesis to take place?","options":["Oxygen, soil, minerals","Water, carbon dioxide, sunlight","Nitrogen, oxygen, water","Soil, roots, temperature"],"answer":1,"subject":"bs"},
{"question":"If the length of a shadow decreases during the day, the Sun is moving:","options":["towards the west","lower in the sky","higher in the sky","away from Earth"],"answer":2,"subject":"bs"},
{"question":"Which adaptation helps desert plants survive long periods without water?","options":["Broad leaves","Thin stems","Thick cuticle","Soft roots"],"answer":2,"subject":"bs"},
{"question":"Sound cannot travel through:","options":["air","water","steel","vacuum"],"answer":3,"subject":"bs"},
{"question":"Which nutrient is mainly responsible for body growth and repair?","options":["Carbohydrates","Proteins","Fats","Vitamins"],"answer":1,"subject":"bs"},
{"question":"The separation technique best suited to separate salt from saltwater is:","options":["Filtration","Sieving","Evaporation","Sedimentation"],"answer":2,"subject":"bs"},
{"question":"Which organ system works together with the circulatory system to remove wastes?","options":["Digestive system","Respiratory system","Excretory system","Nervous system"],"answer":2,"subject":"bs"},
{"question":"Why are electric wires usually covered with plastic?","options":["Plastic is shiny","Plastic is cheap","Plastic is a good conductor","Plastic is an insulator"],"answer":3,"subject":"bs"},
{"question":"Which change increases the speed of evaporation?","options":["Lower temperature","Smaller surface area","Higher wind speed","Higher humidity"],"answer":2,"subject":"bs"},
{"question":"Which of the following is a renewable source of energy?","options":["Coal","Petroleum","Natural gas","Solar energy"],"answer":3,"subject":"bs"},
{"question":"In a food chain, plants are called producers because they:","options":["consume other organisms","break down dead matter","prepare their own food","depend on animals"],"answer":2,"subject":"bs"},
{"question":"Which human activity directly contributes most to air pollution?","options":["Rainfall","Photosynthesis","Burning of fossil fuels","Soil formation"],"answer":2,"subject":"bs"},
{"question":"The balance of an ecosystem is disturbed when:","options":["all organisms perform their roles","one species is removed completely","energy flows continuously","nutrients are recycled"],"answer":1,"subject":"bs"},
{"question":"Which method is most effective in preventing the spread of communicable diseases?","options":["Exercise only","Balanced diet only","Vaccination","Rest"],"answer":2,"subject":"bs"},
{"question":"Why is excessive use of chemical fertilizers harmful to soil?","options":["It increases crop yield","It improves soil texture","It kills useful microorganisms","It increases water retention"],"answer":2,"subject":"bs"},


{"question":"Who is known as the Father of the Indian Constitution?","options":["Jawaharlal Nehru","B. R. Ambedkar","Mahatma Gandhi","Sardar Patel"],"answer":1,"subject":"ss"},
{"question":"Which of the following rivers flows through Kerala?","options":["Ganga","Periyar","Yamuna","Godavari"],"answer":1,"subject":"ss"},
{"question":"Which type of government is India?","options":["Monarchy","Oligarchy","Dictatorship","Democracy"],"answer":3,"subject":"ss"},
{"question":"Kerala is famous for which traditional dance form?","options":["Bharatanatyam","Kathak","Kathakali","Kuchipudi"],"answer":2,"subject":"ss"},
{"question":"Which planet is known as the Red Planet?","options":["Mars","Jupiter","Venus","Mercury"],"answer":0,"subject":"ss"},
{"question":"Who was the first Prime Minister of India?","options":["Mahatma Gandhi","Jawaharlal Nehru","Sardar Vallabhbhai Patel","Subhas Chandra Bose"],"answer":1,"subject":"ss"},
{"question":"Which factor most directly influenced the location of early human settlements?","options":["Availability of minerals","Access to river water","Presence of forests","Climatic comfort"],"answer":1,"subject":"ss"},
{"question":"The Indus Valley cities were considered advanced mainly because they had:","options":["large armies","planned drainage systems","stone temples","written laws"],"answer":1,"subject":"ss"},
{"question":"Which statement best explains why maps use symbols instead of pictures?","options":["Symbols are decorative","Symbols reduce printing cost","Symbols make maps easier to read","Symbols increase map size"],"answer":2,"subject":"ss"},
{"question":"The main purpose of the Constitution of India is to:","options":["describe historical events","list government officers","provide rules for governance and rights","control economic activities"],"answer":2,"subject":"ss"},
{"question":"Which latitude passes almost through the middle of India?","options":["Equator","Tropic of Cancer","Arctic Circle","Prime Meridian"],"answer":1,"subject":"ss"},
{"question":"Which activity is an example of the secondary sector of the economy?","options":["Farming rice","Fishing","Making steel from iron ore","Teaching in a school"],"answer":2,"subject":"ss"},
{"question":"Why are monsoons important for Indian agriculture?","options":["They reduce soil erosion","They control population growth","They provide seasonal rainfall","They lower land prices"],"answer":2,"subject":"ss"},
{"question":"Which right allows citizens to express opinions freely?","options":["Right to Equality","Right to Freedom of Speech","Right to Religion","Right against Exploitation"],"answer":1,"subject":"ss"},
{"question":"Which resource is classified as renewable?","options":["Coal","Petroleum","Wind","Natural gas"],"answer":2,"subject":"ss"},
{"question":"A rise in population without adequate resources leads most directly to:","options":["cultural diversity","environmental pressure","political stability","technological growth"],"answer":1,"subject":"ss"},
{"question":"Which statement best explains why ancient people chose barter over money?","options":["Money was easily available","Goods were identical","Money had not yet developed","Trade was illegal"],"answer":2,"subject":"ss"},
{"question":"The main function of the Panchayati Raj system is to:","options":["control national defence","govern states","strengthen local self-government","regulate foreign trade"],"answer":2,"subject":"ss"},
{"question":"Why is soil conservation important for sustainable development?","options":["Soil increases rainfall","Soil controls temperature","Soil supports food production","Soil produces minerals"],"answer":2,"subject":"ss"},
{"question":"Which event is considered a major turning point in Indian freedom struggle?","options":["Battle of Plassey","Revolt of 1857","Formation of the UN","Green Revolution"],"answer":1,"subject":"ss"},
{"question":"Which factor most affects climate rather than weather?","options":["Daily rainfall","Hourly temperature","Long-term average conditions","Sudden storms"],"answer":2,"subject":"ss"},
{"question":"Why are forests important to human life?","options":["They increase land prices","They provide only timber","They maintain ecological balance","They reduce daylight"],"answer":2,"subject":"ss"},
{"question":"Which action best reflects responsible citizenship?","options":["Ignoring public property","Following laws and duties","Avoiding social issues","Protesting without reason"],"answer":1,"subject":"ss"},
{"question":"Which means of transport is most suitable for long-distance international trade?","options":["Roadways","Railways","Airways","Waterways"],"answer":3,"subject":"ss"},
{"question":"Sustainable use of resources means:","options":["using resources as fast as possible","avoiding all resource use","meeting present needs without harming the future","replacing natural resources completely"],"answer":2,"subject":"ss"},



{"question":"Find the next number in the sequence: 2, 4, 8, 16, ?","options":["20","24","32","36"],"answer":2,"subject":"mental"},
{"question":"A shop sells pencils at 5 for ₹10. How much will 20 pencils cost?","options":["₹30","₹40","₹50","₹60"],"answer":1,"subject":"mental"},
{"question":"If 6 workers can complete a task in 12 days, how many days will 4 workers take to complete the same task?","options":["22 days","28 days","24 days","20 days"],"answer":3,"subject":"mental"},
{"question":"Which figure completes the pattern? ▲, ▲▲, ▲▲▲, ?","options":["▲▲▲▲▲","▲▲▲▲","▲▲▲▲▲▲▲","▲▲▲▲▲"],"answer":1,"subject":"mental"},
{"question":"A cube has 6 faces. How many edges does it have?","options":["8","10","12","14"],"answer":2,"subject":"mental"},{"question":"If a clock shows 3:15, what is the angle between the hour and minute hands?","options":["0°","90°","52.5°","7.5°"],"answer":3,"subject":"mental"},
{"question":"If CAT is coded as 3120, how is DOG coded using the same rule?","options":["4157","4159","4167","4187"],"answer":1,"subject":"mental"}, {"question":"Which figure comes next in the pattern? ▲ ■ ▲ ■ ▲ ?","options":["■","▲","●","◆"],"answer":0,"subject":"mental"},
{"question":"Find the odd one out.","options":["Square","Rectangle","Triangle","Circle"],"answer":2,"subject":"mental"},
{"question":"If today is Wednesday, what day will it be after 100 days?","options":["Friday","Saturday","Sunday","Monday"],"answer":1,"subject":"mental"},
{"question":"Which number does not belong to the group?","options":["16","25","36","48"],"answer":3,"subject":"mental"},
{"question":"In a certain code, SCHOOL is written as HXRLL. How is TEACHER written?","options":["QXZEBI","QXZCFI","QXZBFI","QXABFI"],"answer":2,"subject":"mental"},
{"question":"If all roses are flowers and some flowers fade quickly, which statement is definitely true?","options":["All roses fade quickly","Some roses may fade quickly","No roses fade quickly","All flowers are roses"],"answer":1,"subject":"mental"},
{"question":"Which figure will complete the series? ● ▲ ● ▲ ● ?","options":["■","▲","●","◆"],"answer":1,"subject":"mental"},
{"question":"If A = 1, B = 2, … Z = 26, what is the value of KNOW?","options":["63","64","65","66"],"answer":2,"subject":"mental"},
{"question":"A mirror is placed to the right of an object. Which change will be seen?","options":["Top and bottom interchange","Left and right interchange","Size increases","Colour changes"],"answer":1,"subject":"mental"},
{"question":"Find the missing number: 2, 6, 12, 20, ?","options":["28","30","32","36"],"answer":1,"subject":"mental"},
{"question":"Which word does NOT belong with the others?","options":["Hearing","Seeing","Smelling","Speaking"],"answer":3,"subject":"mental"},
{"question":"If SOUTH is written as HTUOS, how is NORTH written?","options":["HTTRON","HTRON","HTORN","HTRNO"],"answer":1,"subject":"mental"},
{"question":"Choose the correct alternative: Finger : Hand :: Toe : ?","options":["Arm","Foot","Leg","Nail"],"answer":1,"subject":"mental"},
{"question":"Which number will replace the question mark? 4 → 16 5 → 25 6 → 36 7 → ?","options":["42","48","49","56"],"answer":2,"subject":"mental"},
{"question":"If it takes 5 machines 5 minutes to make 5 items, how long will 10 machines take to make 10 items?","options":["2.5 minutes","5 minutes","10 minutes","20 minutes"],"answer":1,"subject":"mental"},
{"question":"Which figure is formed by folding a square along its diagonal?","options":["Rectangle","Circle","Triangle","Trapezium"],"answer":2,"subject":"mental"},
{"question":"Which conclusion can be drawn? All birds have wings. Some animals are birds.","options":["All animals have wings","Some animals have wings","No animals have wings","All birds are animals"],"answer":1,"subject":"mental"},
{"question":"A person walks 10 m north, then 10 m east, then 10 m south. How far is he from the starting point?","options":["0 m","5 m","10 m","20 m"],"answer":2,"subject":"mental"},


{"question":"Which Indian city is known as the “Silicon Valley of India”?","options":["Mumbai","Hyderabad","Bengaluru","Pune"],"answer":2,"subject":"current"},
{"question":"Which country hosted the 2024 Summer Olympics?","options":["Japan","USA","France","China"],"answer":2,"subject":"current"},
{"question":"The Kudumbashree mission in Kerala primarily focuses on:","options":["Education","Women empowerment and poverty eradication","Health services","Tourism development"],"answer":1,"subject":"current"},
{"question":"Who is the current President of India (2026)?","options":["Ram Nath Kovind","Narendra Modi","Amith Sha","Droupadi Murmu"],"answer":3,"subject":"current"},
{"question":"Which initiative is related to clean energy promotion in India?","options":["Digital India","Swachh Bharat Mission","National Solar Mission","Make in India"],"answer":2,"subject":"current"},
{"question":"Which Indian space mission successfully demonstrated human spaceflight capability?","options":["Chandrayaan-3","Gaganyaan","Mars Orbiter Mission","Astrosat"],"answer":1,"subject":"current"},
{"question":"Kerala is frequently highlighted at the national level mainly for its achievements in:","options":["Mineral production","Literacy and public health","Heavy industries","Defence manufacturing"],"answer":1,"subject":"current"},
{"question":"The major aim of Kerala’s waste management initiatives is to promote:","options":["Centralised dumping","Incineration only","Source-level waste segregation","Export of waste"],"answer":2,"subject":"current"},
{"question":"Which natural feature plays a key role in Kerala’s monsoon rainfall pattern?","options":["Eastern Ghats","Western Ghats","Deccan Plateau","Thar Desert"],"answer":1,"subject":"current"}, 
{"question":"Kerala’s focus on public libraries mainly supports:","options":["Entertainment","Informal learning and reading culture","Tourism","Commercial publishing"],"answer":1,"subject":"current"}, 
{"question":"Flood mitigation efforts in Kerala increasingly emphasise:","options":["River deepening alone","Community participation and early warning","Deforestation","Dam removal only"],"answer":1,"subject":"current"}, 
{"question":"India’s space missions are often recognised globally because they are:","options":["The most expensive","Conducted with international funding","Cost-effective and innovative","Privately owned"],"answer":2,"subject":"current"}, 
{"question":"The primary objective of digital education initiatives in India is to:","options":["Replace teachers completely","Reduce curriculum content","Improve access and equity","Promote examinations"],"answer":2,"subject":"current"}, 
{"question":"Which renewable energy source has shown rapid expansion in India in recent years?","options":["Nuclear energy","Coal-based power","Solar energy","Diesel power"],"answer":2,"subject":"current"}, 
{"question":"India’s emphasis on millets is mainly linked to:","options":["Export promotion only","Climate resilience and nutrition","Urban food habits","Processed food industry"],"answer":1,"subject":"current"}, 
{"question":"Which institution plays a key role in conducting national-level competitive examinations?","options":["ISRO","RBI","UPSC","NITI Aayog"],"answer":2,"subject":"current"}, 
{"question":"Climate change discussions at global forums mainly focus on reducing:","options":["Forest cover","Greenhouse gas emissions","Ocean currents","Earth’s rotation"],"answer":1,"subject":"current"}, 
{"question":"International cooperation in space research is important because it:","options":["Increases competition","Reduces scientific accuracy","Shares knowledge and resources","Limits innovation"],"answer":2,"subject":"current"}, 
{"question":"Global health organisations stress vaccination primarily to:","options":["Increase medicine sales","Eliminate preventable diseases","Replace nutrition programmes","Promote tourism"],"answer":1,"subject":"current"}, 
{"question":"The growing use of electric vehicles worldwide is mainly intended to:","options":["Increase fuel consumption","Reduce air pollution","Replace public transport","Increase traffic"],"answer":1,"subject":"current"}, 
{"question":"Which global issue directly affects food security in many countries?","options":["Space exploration","Climate variability","Internet access","Urban design"],"answer":1,"subject":"current"}, 
{"question":"International sports events are often promoted among students mainly to encourage:","options":["Commercial sponsorship","Physical fitness and teamwork","Academic competition","Individualism"],"answer":1,"subject":"current"}, 
{"question":"Artificial Intelligence is increasingly used in daily life mainly to:","options":["Replace human thinking","Assist decision-making and efficiency","Eliminate employment","Control human behaviour"],"answer":1,"subject":"current"}, 
{"question":"Global efforts to protect endangered species highlight the importance of:","options":["Urban expansion","Biodiversity conservation","Industrial growth","Resource exploitation"],"answer":1,"subject":"current"}, 
{"question":"UNESCO’s role in education and culture is best described as:","options":["Conducting examinations","Preserving heritage and promoting learning","Funding private schools","Managing governments"],"answer":1,"subject":"current"}

];

let user = null; let examQs = []; let myChart = null;
let examTimer = null; let timeLeft = 900; 

function checkPersistentLogin() {
const savedUser = localStorage.getItem('uss_user');
if(savedUser) {
user = JSON.parse(savedUser);
finalizeLogin();
}
}

function showLoading(txt) {
document.getElementById('loader-text').innerText = txt;
document.getElementById('loader-content').style.display = 'flex';
document.getElementById('status-content').style.display = 'none';
document.getElementById('msg-overlay').style.display = 'flex';
}

function showStatus(title, msg, type = 'success') {
document.getElementById('loader-content').style.display = 'none';
document.getElementById('status-content').style.display = 'block';
document.getElementById('status-icon').innerText = (type === 'success' ? "" : "");
document.getElementById('status-title').innerText = title;
document.getElementById('status-title').style.color = (type === 'success' ? "var(--success)" : "var(--error)");
document.getElementById('status-msg').innerText = msg;
}

function closeMsg() { document.getElementById('msg-overlay').style.display = 'none'; }

function handleLogin() {
showLoading("Syncing...");
const idInput = document.getElementById('uid').value.toUpperCase().trim();
const passInput = document.getElementById('ups').value.trim();
const keep = document.getElementById('keep-signed').checked;

user = students.find(s => s.id === idInput && s.pass === passInput);
if(user) {
if(keep) localStorage.setItem('uss_user', JSON.stringify(user));
finalizeLogin();
} else { showStatus("", "Invalid Credentials", ""); }
}

function finalizeLogin() {
  document.getElementById('sticky-header-container').style.display = 'block';
  document.getElementById('user-profile').style.display = 'flex';
  document.getElementById('display-name').innerText = user.name;
  document.getElementById('user-initial').innerText = user.name.charAt(0);
  document.getElementById('tab1').classList.remove('active');
  document.getElementById('navbar').style.display = 'flex';

  /* 🔐 ROLE-BASED NAV */
  if (user.role === 'teacher') {
  document.getElementById('admin-nav').style.display = 'inline-block';
  document.getElementById('ins-nav').style.display = 'inline-block';
} else {
  document.getElementById('admin-nav').style.display = 'none';
  document.getElementById('ins-nav').style.display = 'none';
}

  loadAttendance();   // ✅ ADD THIS
  showTab('tab2');
  closeMsg();
}
  function hideNavForExam() {
  document.querySelectorAll('#navbar button').forEach(b => {
    b.style.display = 'none';
  });
  document.getElementById('nav-timer').style.display = 'block';
}

function restoreNavAfterExam() {
  document.getElementById('nav-tab2').style.display = 'inline-block';
  document.getElementById('nav-tab3').style.display = 'inline-block';

  if (user.role === 'teacher') {
    document.getElementById('admin-nav').style.display = 'inline-block';
    document.getElementById('ins-nav').style.display = 'inline-block';
  }

  document.getElementById('nav-timer').style.display = 'none';
}
  
function logout() {
localStorage.removeItem('uss_user');
location.reload();
}

function showTab(tid) {
document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
document.querySelectorAll('nav button').forEach(b => b.classList.remove('active-nav'));
document.getElementById(tid).classList.add('active');
if(document.getElementById('nav-'+tid)) document.getElementById('nav-'+tid).classList.add('active-nav');
if(tid === 'tab3') loadProgress();
if(tid === 'tab5') loadInspirations();
window.scrollTo({top: 0, behavior: 'smooth'});
}

function startExamWithTimer() {
  generateExam();
  document.getElementById('s-btn').style.display = 'block';

  timeLeft = 900;
  hideNavForExam();

  if (examTimer) clearInterval(examTimer);

  examTimer = setInterval(() => {
    timeLeft--;
    let min = Math.floor(timeLeft / 60);
    let sec = timeLeft % 60;
    document.getElementById('nav-timer').innerText =
      `${min}:${sec < 10 ? '0' : ''}${sec}`;

    if (timeLeft === 180) {
      document.getElementById('nav-timer').classList.add('timer-warn');
    }

    if (timeLeft <= 0) {
      clearInterval(examTimer);
      submitExam();
    }
  }, 1000);
}

function tryQuizAgain() {
  document.getElementById('exam-result-view').style.display = 'none';
  document.getElementById('exam-form').style.display = 'block';
  document.getElementById('lang-select').value = "";
  document.getElementById('quiz-load').innerHTML = "";
  document.getElementById('s-btn').style.display = 'none';

  restoreNavAfterExam();
  document.getElementById('nav-timer').classList.remove('timer-warn');
}

function generateExam() {
const lang = document.getElementById('lang-select').value;
const subs = [lang, 'mal2', 'maths', 'eng', 'bs', 'ss', 'mental', 'current'];
examQs = [];
subs.forEach(s => {
let pool = masterBank.filter(q => q.subject === s);
pool.sort(() => 0.5 - Math.random());
examQs.push(...pool.slice(0, 3));
});
renderExam();
}

function renderExam() {
let h = "";
examQs.forEach((q, i) => {

const isArabic = q.subject === "lang1_arb";
const rtlClass = isArabic ? "rtl-arabic" : "";

h += `
<div class="q-card ${rtlClass}">
<div style="font-size:0.7rem; color:var(--primary); font-weight:800; text-transform:uppercase;">
${q.subject}
</div>
<p class="${rtlClass}" style="font-weight:600; margin:10px 0;">
${i+1}. ${q.question}
</p>
`;

q.options.forEach((o, j) => {
h += `
<div class="${rtlClass}">
<input type="radio" id="q${i}_opt${j}" name="qz${i}" value="${o}">
<label for="q${i}_opt${j}" class="option-label ${rtlClass}">

${o}
</label>
</div>
`;
});

h += `</div>`;
});

document.getElementById('quiz-load').innerHTML = h || "Exam data missing...";
}

async function submitExam() {
  clearInterval(examTimer);
  restoreNavAfterExam();
  document.getElementById('nav-timer').classList.remove('timer-warn');
showLoading("Syncing...");
let sc = {lang1:0, mal2:0, maths:0, eng:0, bs:0, ss:0, mental:0, current:0};
let total = 0; let reviewHTML = "";

examQs.forEach((q, i) => {
  const sel = document.querySelector(`input[name="qz${i}"]:checked`);

  const uAnsIndex = sel ? parseInt(sel.id.split("_opt")[1], 10) : -1;
  const correctIndex = q.answer;

  const isCorrect = uAnsIndex === correctIndex;
  const userAnswerText = uAnsIndex >= 0 ? q.options[uAnsIndex] : "None";
  const correctAnswerText = q.options[correctIndex];

  if (isCorrect) {
    total++;

    // Normalize subject key
    let key = q.subject.startsWith("lang1_") ? "lang1" : q.subject;

    if (sc.hasOwnProperty(key)) {
      sc[key] += 1;
    } else {
      console.warn("Unknown subject:", q.subject);
    }
  }

  reviewHTML += `
  <div style="padding:12px; margin-bottom:8px; background:#fff; border:1px solid #eee; border-radius:10px;">
    <p style="margin:0 0 5px 0; font-size:0.9rem;">
      <b>Q${i+1}.</b> ${q.question}
    </p>

    <p style="margin:2px 0; font-size:0.85rem;">
      Your Answer: 
      <span style="color:${isCorrect ? 'var(--success)' : 'var(--error)'}; font-weight:700;">
        ${userAnswerText} ${isCorrect ? '✓' : '✗'}
      </span>
    </p>

    <p style="margin:2px 0; font-size:0.85rem;">
      Correct Answer:
      <span style="color:var(--success); font-weight:700;">
        ${correctAnswerText}
      </span>
    </p>
  </div>
`;

});


try {
const dStr = new Date().toLocaleDateString('en-GB');
const perc = (total/24)*100;
const grade = getGrade(perc);
const reviewObj = {
  date: dStr,
  total: total,
  grade: grade,
  scores: sc
};

// save to localStorage
let history = JSON.parse(localStorage.getItem("uss_reviews") || "[]");
history.push(reviewObj);
localStorage.setItem("uss_reviews", JSON.stringify(history));


await fetch(SCRIPT_URL, { method: "POST", body: JSON.stringify({
name: user.name, class: user.class, division: user.div, date: dStr, scores: sc, total: total
})});

document.getElementById('exam-form').style.display = 'none';
document.getElementById('exam-result-view').style.display = 'block';

document.getElementById('res-date').innerText = dStr;
document.getElementById('res-name').innerText = user.name;
document.getElementById('res-cl').innerText = user.class;
document.getElementById('res-dv').innerText = user.div;
document.getElementById('res-uid').innerText = user.id;
document.getElementById('res-lang1').innerText = document.getElementById('lang-select').value.split('_')[1].toUpperCase();
document.getElementById('res-total').innerText = total;
document.getElementById('res-grade-badge').innerText = grade;

let sumHTML = "";
for(let s in sc) { sumHTML += `<div style="background:white; padding:10px; border-radius:10px; border-bottom:3px solid var(--accent); text-align:center;"><div style="font-size:0.6rem; color:#888;">${s.toUpperCase()}</div><div style="font-weight:700;">${sc[s]}/3</div></div>`; }
document.getElementById('res-summary').innerHTML =
  renderPerformanceCard(reviewObj);

document.getElementById('res-review-list').innerHTML = reviewHTML;
closeMsg();
} catch(e) { showStatus("Error", "Check Connection", "error"); }
}

async function loadProgress() {
  if(SCRIPT_URL === "YOUR_WEB_APP_URL") return;
  showLoading("Syncing...");
  try {
    const res = await fetch(`${SCRIPT_URL}?name=${user.name}`);
    const data = await res.json();

    document.getElementById('summ-name').innerText = user.name;
    document.getElementById('summ-class').innerText = user.class;
    document.getElementById('summ-div').innerText = user.div;

    if(data.length > 0) {
      const values = data.map(r => r[13]);
      const grandTotal = values.reduce((a, b) => a + b, 0);
      const avg = (grandTotal / (data.length * 24)) * 100;

      document.getElementById('summ-count').innerText = data.length;
      document.getElementById('summ-grand').innerText = grandTotal;
      document.getElementById('p-grade').innerText = getGrade(avg);

      if(myChart) myChart.destroy();
      myChart = new Chart(document.getElementById('chartArea'), {
  type: 'line',
  data: { 
    labels: data.map((_, i) => `${i + 1}`), 
    datasets: [{ 
      label: 'Score', 
      data: values, 
      borderColor: '#4361ee', 
      tension: 0.4, 
      fill: true, 
      backgroundColor: 'rgba(67,97,238,0.1)' 
    }] 
  },
  options: { 
    responsive: true, 
    maintainAspectRatio: false, 
    plugins: { legend: { display: false } }, 
    scales: {
      y: {
        beginAtZero: true,
        max: data.length * 24,  // Set max as Total Exams * 24
        ticks: {
          stepSize: 10
        }
      }
    }
  }
});

    } else {
      document.getElementById('summ-count').innerText = 0;
      document.getElementById('summ-grand').innerText = 0;
      document.getElementById('p-grade').innerText = '';
      if(myChart) myChart.destroy();
    }

    // Render "My Performance and Reviews" with server data, last exam first
    const reviewBox = document.getElementById("my-performance-reviews-list");
    if (data.length === 0) {
      reviewBox.innerHTML = "<p style='color:#666; font-size:0.9rem;'>No exams attempted yet.</p>";
    } else {
      let html = "";
      // Iterate reversed (last exam first)
      for (let i = data.length -1; i >= 0; i--) {
        const r = data[i];
        const examNum = i + 1; // Assign exam 1 to oldest, exam N to latest
        const date = lockExamDateTime(r[0]);
        const scores = {
          lang1: r[5], mal2: r[6], maths: r[7], eng: r[8],
          bs: r[9], ss: r[10], mental: r[11], current: r[12]
        };
        const total = r[13];
        const grade = getGrade((total / 24) * 100);
        let grid = "";
        for (const [key, val] of Object.entries(scores)) {
          grid += `
            <div style="background:#fff; padding:8px; border-radius:10px; border-bottom:3px solid var(--accent); text-align:center;">
              <div style="font-size:0.6rem; color:#888;">${key.toUpperCase()}</div>
              <div style="font-weight:700;">${val}/3</div>
            </div>`;
        }
        html += `
          <div class="glass-card" style="margin-bottom:15px;">
            <div style="display:flex; justify-content:space-between; align-items:center;">
              <b>Exam ${examNum}</b>
              <span style="font-size:0.8rem; color:#666;">${date}</span>
            </div>
            <div style="margin:8px 0; font-size:0.9rem;">
              <b>Total:</b> ${total}/24 |
              <b>Grade:</b> <span style="color:var(--primary); font-weight:800;">${grade}</span>
            </div>
            <div class="summary-grid">${grid}</div>
          </div>`;
      }
      reviewBox.innerHTML = html;
    }

    closeMsg();
  } catch(e) {
    showStatus("Error", "Load Failed", "error");
  }
}


function renderPerformanceCard(review, index = null) {
  let grid = "";
  for (let s in review.scores) {
    grid += `
      <div style="background:white; padding:8px; border-radius:10px;
                  border-bottom:3px solid var(--accent); text-align:center;">
        <div style="font-size:0.6rem; color:#888;">${s.toUpperCase()}</div>
        <div style="font-weight:700;">${review.scores[s]}/3</div>
      </div>
    `;
  }

  return `
    <div class="glass-card" style="margin-bottom:15px;">
      <div style="display:flex; justify-content:space-between; align-items:center;">
        <b>Exam ${index !== null ? index + 1 : ""}</b>
        <span style="font-size:0.8rem; color:#666;">${review.datetime}</span>
      </div>

      <div style="margin:8px 0; font-size:0.9rem;">
        <b>Total:</b> ${review.total}/24 |
        <b>Grade:</b>
        <span style="color:var(--primary); font-weight:800;">
          ${review.grade}
        </span>
      </div>

      <div class="summary-grid">
        ${grid}
      </div>
    </div>
  `;
}


async function loadInspirations() {
if(SCRIPT_URL === "YOUR_WEB_APP_URL") return;
showLoading("Updating...");
const body = document.getElementById('ins-body');
try {
const res = await fetch(`${SCRIPT_URL}?type=allStudents`);
const data = await res.json();
const studentsMap = {};
data.forEach(row => {
const key = `${row[1]}-${row[2]}-${row[3]}`;
if(!studentsMap[key]) studentsMap[key] = { name: row[1], class: row[2], div: row[3], l1:0, m2:0, math:0, eng:0, bs:0, ss:0, ma:0, ca:0, total:0, exams:0 };
const s = studentsMap[key];
s.l1 += row[5]; s.m2 += row[6]; s.math += row[7]; s.eng += row[8];
s.bs += row[9]; s.ss += row[10]; s.ma += row[11]; s.ca += row[12];
s.total += row[13]; s.exams++;
});
populateStudentDropdown(data);
let h = "";
Object.values(studentsMap).forEach(s => {
const perc = (s.total / (s.exams * 24)) * 100;
h += `<tr><td style="font-weight:700;">${s.name}</td><td>${s.class}</td><td>${s.div}</td><td>${s.l1}</td><td>${s.m2}</td><td>${s.math}</td><td>${s.eng}</td><td>${s.bs}</td><td>${s.ss}</td><td>${s.ma}</td><td>${s.ca}</td><td>${s.exams}</td><td style="color:var(--primary); font-weight:700;">${s.total}</td><td>${getGrade(perc)}</td></tr>`;
});
body.innerHTML = h; closeMsg();
loadSubjectPointer();

} catch(e) { showStatus("Error", "Load Error", "error"); }

  
}

function getGrade(p) {
if(p >= 80) return "A"; if(p >= 60) return "B"; if(p >= 40) return "C";
if(p >= 30) return "D"; if(p >= 29) return "E"; return "E";
}

function sortTable(n) {
const table = document.getElementById("ins-table");
let rows, switching, i, x, y, shouldSwitch, dir, switchcount = 0;
switching = true; dir = "desc";
while (switching) {
switching = false; rows = table.rows;
for (i = 1; i < (rows.length - 1); i++) {
shouldSwitch = false;
x = rows[i].getElementsByTagName("TD")[n];
y = rows[i + 1].getElementsByTagName("TD")[n];
let xVal = isNaN(x.innerText) ? x.innerText.toLowerCase() : parseFloat(x.innerText);
let yVal = isNaN(y.innerText) ? y.innerText.toLowerCase() : parseFloat(y.innerText);
if (dir == "asc") { if (xVal > yVal) { shouldSwitch = true; break; } }
else { if (xVal < yVal) { shouldSwitch = true; break; } }
}
if (shouldSwitch) { rows[i].parentNode.insertBefore(rows[i + 1], rows[i]); switching = true; switchcount ++; }
else { if (switchcount == 0 && dir == "desc") { dir = "asc"; switching = true; } }
}
}

function makeQ() {
    const qSub = document.getElementById('qs').value; 
    const qText = document.getElementById('qt').value;
    const opt1 = document.getElementById('o1').value;
    const opt2 = document.getElementById('o2').value;
    const opt3 = document.getElementById('o3').value;
    const opt4 = document.getElementById('o4').value;
    const qAnsIndex = parseInt(document.getElementById('qa').value, 10);

    // Validate answer index
    if (isNaN(qAnsIndex) || qAnsIndex < 0 || qAnsIndex > 3) {
        showStatus("Warning", "Correct answer must be 0, 1, 2, or 3", "error");
        return;
    }

    // Validate essential fields
    if(!qText || !opt1 || !opt2 || !opt3 || !opt4) {
        showStatus("Warning", "Please fill all question and option fields", "error");
        return;
    }

    // Create question object with answer as the index
    const q = {
        question: qText,
        options: [opt1, opt2, opt3, opt4],
        answer: qAnsIndex,   // Store index instead of option text
        subject: qSub
    };

    const generatedCode = JSON.stringify(q) + ",";
    const textArea = document.getElementById('q-code');
    textArea.value += generatedCode;

    // Copy to clipboard
    navigator.clipboard.writeText(textArea.value).then(() => {
        // Clear fields
        document.getElementById('qt').value = "";
        document.getElementById('o1').value = "";
        document.getElementById('o2').value = "";
        document.getElementById('o3').value = "";
        document.getElementById('o4').value = "";
        document.getElementById('qa').value = "";

        showStatus("Success", "Code generated and copied to clipboard!");
    }).catch(err => {
        showStatus("Copy Error", "Failed to auto-copy code.", "error");
    });
}

  
 function lockExamDateTime(value) {
  // Case 1: Google Sheets serial (number)
  if (typeof value === "number") {
    const date = new Date(Math.floor((value - 25569) * 86400 * 1000));
    const time = (value % 1) * 24 * 60 * 60 * 1000;
    // Subtract 8 hours in milliseconds
    const adjustedDate = new Date(date.getTime() + time - (8 * 60 * 60 * 1000));
    return adjustedDate.toLocaleString("en-GB", {
      day: "2-digit",
      month: "short",
      year: "numeric",
      hour: "2-digit",
      minute: "2-digit",
      hour12: true
    });
  }

  // Case 2: ISO string with timezone (Z / +xx)
  if (typeof value === "string" && value.includes("T")) {
    const clean = value.replace("Z", "").split(".")[0];
    const [date, time] = clean.split("T");
    const [y, m, d] = date.split("-");
    const [h, min] = time.split(":");
    // Create date then subtract 8 hours
    const dt = new Date(y, m - 1, d, h, min);
    const adjustedDate = new Date(dt.getTime() - (8 * 60 * 60 * 1000));
    return adjustedDate.toLocaleString("en-GB", {
      day: "2-digit",
      month: "short",
      year: "numeric",
      hour: "2-digit",
      minute: "2-digit",
      hour12: true
    });
  }

  // Case 3: Plain string → display as-is
  return value;
}

  
  
 function populateStudentDropdown(data) {
  const select = document.getElementById("student-select");
  select.innerHTML = `<option value="">-- Choose Student --</option>`;

  const seen = new Set();

  data.forEach(row => {
    const name = row[1];
    if (!seen.has(name)) {
      seen.add(name);
      const opt = document.createElement("option");
      opt.value = name;
      opt.textContent = name;
      select.appendChild(opt);
    }
  });
}
  
  let studentChart = null;

async function loadStudentExams() {
  const studentName = document.getElementById("student-select").value;
  if (!studentName) return;

  showLoading("Loading Student Exams...");

  try {
    const res = await fetch(`${SCRIPT_URL}?name=${studentName}`);
    const data = await res.json();

    const labels = [];
    const totals = [];
    let html = "";

    // Reverse order: latest exam first
// Reverse order: last exam first
const reversedData = [...data].reverse();

reversedData.forEach((r, i) => {
  const dateTime = lockExamDateTime(r[0]);
  const scores = {
    L1: r[5], M2: r[6], Math: r[7], Eng: r[8],
    BS: r[9], SS: r[10], MA: r[11], CA: r[12]
  };
  const total = r[13];
  const grade = getGrade((total / 24) * 100);

  html += `
    <div class="glass-card">
      <b>Exam ${reversedData.length - i}</b> – ${dateTime}<br>
      <b>Total:</b> ${total}/24 |
      <b>Grade:</b>
      <span style="font-weight:800;color:var(--primary)">${grade}</span>

      <div class="summary-grid" style="margin-top:10px;">
        ${Object.entries(scores).map(([k,v]) => `
          <div style="background:#fff;padding:8px;border-radius:10px;text-align:center;">
            <div style="font-size:0.6rem;color:#888">${k}</div>
            <b>${v}</b>
          </div>
        `).join("")}
      </div>
    </div>
  `;
});

	
    document.getElementById("student-exam-list").innerHTML = html;

    if (studentChart) studentChart.destroy();
    studentChart = new Chart(
      document.getElementById("studentExamChart"), {
        type: "bar",
        data: {
          labels,
          datasets: [{
            label: "Total Score",
            data: totals,
            backgroundColor: "rgba(67,97,238,0.6)"
          }]
        },
        options: {
          responsive: true,
          plugins: { legend: { display: false } },
          scales: { y: { beginAtZero: true, max: 24 } }
        }
      }
    );

    closeMsg();
  } catch (e) {
    showStatus("Error", "Unable to load student exams", "error");
    console.log("RAW EXAM DATE:", r[0], typeof r[0]);
  }
}

  
  async function loadAttendance() {
  const tbody = document.getElementById("attendance-body");
  tbody.innerHTML = `
    <tr>
      <td colspan="2" style="padding:12px;text-align:center;">Loading…</td>
    </tr>`;

  try {
    // Fetch all exam records
    const res = await fetch(`${SCRIPT_URL}?type=allStudents`);
    const data = await res.json();

    // Count exams per student name
    const examCount = {};
    data.forEach(row => {
      const name = row[1]; // student name
      examCount[name] = (examCount[name] || 0) + 1;
    });

    // Build table using const students
    let html = "";
    students
      .filter(s => s.role === "student")
      .forEach(s => {
        html += `
          <tr>
            <td style="padding:10px; border:1px solid #ddd; text-align:left;">
              ${s.name}
            </td>
            <td style="padding:10px; border:1px solid #ddd; text-align:center; font-weight:700;">
              ${examCount[s.name] || 0}
            </td>
          </tr>`;
      });

    tbody.innerHTML = html;

  } catch (e) {
    tbody.innerHTML = `
      <tr>
        <td colspan="2" style="padding:12px;color:red;text-align:center;">
          Failed to load attendance
        </td>
      </tr>`;
  }
}
  
  


 function copyAttendanceTable() {
  const rows = document.querySelectorAll("#attendance-table tr");
  let text = "";

  rows.forEach(row => {
    const cols = row.querySelectorAll("th, td");
    const line = Array.from(cols).map(c => c.innerText).join("\t");
    text += line + "\n";
  });

  navigator.clipboard.writeText(text).then(() => {
    alert("Attendance table copied!");
  });
}

let attendanceSort = {
  column: null,
  asc: true
};

function sortAttendance(colIndex) {
  const tbody = document.getElementById("attendance-body");
  const rows = Array.from(tbody.querySelectorAll("tr"));

  // Toggle sort direction
  if (attendanceSort.column === colIndex) {
    attendanceSort.asc = !attendanceSort.asc;
  } else {
    attendanceSort.column = colIndex;
    attendanceSort.asc = true;
  }

  rows.sort((a, b) => {
    let A = a.children[colIndex].innerText.trim();
    let B = b.children[colIndex].innerText.trim();

    // Number sort for exam count
    if (colIndex === 1) {
      A = Number(A);
      B = Number(B);
    } else {
      A = A.toLowerCase();
      B = B.toLowerCase();
    }

    if (A < B) return attendanceSort.asc ? -1 : 1;
    if (A > B) return attendanceSort.asc ? 1 : -1;
    return 0;
  });

  tbody.innerHTML = "";
  rows.forEach(r => tbody.appendChild(r));

  updateSortIcons();
}

  
function updateSortIcons() {
  document.getElementById("sort-name").innerText = "";
  document.getElementById("sort-exams").innerText = "↕";

  const icon = attendanceSort.asc ? "" : "";
  if (attendanceSort.column === 0) {
    document.getElementById("sort-name").innerText = icon;
  }
  if (attendanceSort.column === 1) {
    document.getElementById("sort-exams").innerText = icon;
  }
}

function shareAttendanceToWhatsApp() {
  const rows = document.querySelectorAll("#attendance-table tr");
  let lines = [];

  rows.forEach(row => {
    const cols = row.querySelectorAll("th, td");
    // Join columns with ' | ' for readable table format in WhatsApp
    let line = Array.from(cols).map(c => c.innerText.trim()).join(" | ");
    lines.push(line);
  });

  const message = encodeURIComponent(lines.join("\n"));

  // Open Whatsapp share with formatted message
  window.open("https://wa.me/?text=" + message, "_blank");
}



function shareQCodeToWhatsApp() {
  const code = document.getElementById('q-code').value.trim();
  if (!code) {
    alert("No generated code to share!");
    return;
  }

  // Your WhatsApp number with country code
  const waNumber = "919497731772";

  // URL encode the message
  const message = encodeURIComponent("Generated Question Code:\n" + code);

  // Open chat to your WhatsApp number
  const url = `https://wa.me/${waNumber}?text=${message}`;
  window.open(url, "_blank");
}


let subjectwiseSort = { column: null, asc: true };

async function loadSubjectwiseData() {
  const subject = document.getElementById("subjectwise-select").value;
  const tbody = document.getElementById("subjectwise-body");
  const container = tbody.parentElement; // .table-container

  // Create spinner overlay if doesn't exist
  let loader = container.querySelector(".spinner-overlay");
  if (!loader) {
    loader = document.createElement("div");
    loader.className = "spinner-overlay";
    loader.style = `
      position: absolute;
      inset: 0;
      background: rgba(255, 255, 255, 0.7);
      display: flex;
      justify-content: center;
      align-items: center;
      border-radius: 15px;
      z-index: 10;
    `;
    loader.innerHTML = `<div class="spinner" style="width:30px; height:30px; border-width: 4px; border-top-color: var(--primary);"></div>`;
    container.style.position = "relative";
    container.appendChild(loader);
  }

  if (!subject) {
    tbody.innerHTML = `<tr><td colspan="4" style="text-align:center; padding:10px; color:#666;">Select a subject to view data</td></tr>`;
    loader.remove();
    return;
  }

  tbody.innerHTML = `<tr><td colspan="4" style="text-align:center; padding:10px;">Loading…</td></tr>`;

  // Allowed students per subject for filtering
  const allowedStudents = {
    "lang1_arb": ["AAISHA FIDHA", "AALIYA C S", "FATHIMATH SAHRA K S"],
    "lang1_skt": [
      "ANANDHAKRISHNAN M S", "ANSHITHA ANEESH", "ANUSREE T S", "BHAGATH S KUMAR",
      "HARI NARAYANAN K S", "KUNAL KIRAN NAGDA", "MALAVIKA N M", "MEENAKSHY M HEGDE",
      "PRATHITHA P SHENOY", "SARANGI S", "SREEBALA PRASANTH", "SREEBHADRA H",
      "SUKESH S PAI",  "VARALAKSHMY S BHAT"
    ],
    "lang1_mal1": ["DEVANANDA T R"]
  };

  try {
    const res = await fetch(`${SCRIPT_URL}?type=allStudents`);
    const data = await res.json();

    const performanceMap = {};

    data.forEach(row => {
      const name = row[1];

      // For Arabic, Sanskrit, Malayalam I, filter students as per allowedStudents
      if (allowedStudents.hasOwnProperty(subject)) {
        if (!allowedStudents[subject].includes(name)) {
          return; // skip this record (student)
        }
      }

      if (!performanceMap[name]) performanceMap[name] = { exams: 0, totalScore: 0 };
      performanceMap[name].exams++;

      // Map subject to column index
      const subjIndexMap = {
        "lang1_arb": 5, "lang1_skt": 5, "lang1_mal1": 5,
        "mal2": 6, "maths": 7, "eng": 8, "bs": 9, "ss": 10,
        "mental": 11, "current": 12
      };

      let col = subjIndexMap[subject];
      if (col === undefined) col = 5; // fallback to language 1

      let score = 0;
      // For lang1_* ensure score from col 5
      if (subject.startsWith("lang1_")) {
        score = row[5];
      } else {
        score = row[col];
      }

      performanceMap[name].totalScore += score;
    });

    let html = "";
    for (const [name, perf] of Object.entries(performanceMap)) {
      const avgScore = perf.totalScore;
      const exams = perf.exams;
      const gradePercent = exams > 0 ? (avgScore / (exams * 3)) * 100 : 0;
      const grade = getGrade(gradePercent);
      html += `
        <tr>
          <td style="text-align:left; padding:8px;">${name}</td>
          <td style="text-align:center; padding:8px;">${exams}</td>
          <td style="text-align:center; padding:8px;">${avgScore}</td>
          <td style="text-align:center; padding:8px;">${grade}</td>
        </tr>`;
    }

    tbody.innerHTML = html || `<tr><td colspan="4" style="text-align:center; padding:10px; color:#666;">No data available.</td></tr>`;
    loader.remove();
  } catch (e) {
    tbody.innerHTML = `<tr><td colspan="4" style="text-align:center; padding:10px; color:red;">Failed to load data</td></tr>`;
    if(loader) loader.remove();
  }
}



function sortSubjectwiseTable(colIndex) {
  const tbody = document.getElementById("subjectwise-body");
  const rows = Array.from(tbody.querySelectorAll("tr"));
  if (rows.length === 0) return;

  if (subjectwiseSort.column === colIndex) {
    subjectwiseSort.asc = !subjectwiseSort.asc;
  } else {
    subjectwiseSort.column = colIndex;
    subjectwiseSort.asc = true;
  }

  rows.sort((a, b) => {
    let A = a.children[colIndex].innerText.trim();
    let B = b.children[colIndex].innerText.trim();

    // Number columns for exams and score
    if (colIndex === 1 || colIndex === 2) {
      A = Number(A);
      B = Number(B);
    }

    if (colIndex === 3) {
      // Grade sort by letter, so convert letter grades to comparable ranks
      const gradeRank = { "A": 1, "B": 2, "C": 3, "D": 4, "E": 5 };
      A = gradeRank[A] || 999;
      B = gradeRank[B] || 999;
    }

    if (A < B) return subjectwiseSort.asc ? -1 : 1;
    if (A > B) return subjectwiseSort.asc ? 1 : -1;
    return 0;
  });

  rows.forEach(r => tbody.appendChild(r));
}

let subjectPointerChart = null;

async function loadSubjectPointer() {
  if(SCRIPT_URL === "YOUR_WEB_APP_URL") return;

  const container = document.getElementById("subjectPointerChart").parentElement;
  // Show loading spinner
  let loader = container.querySelector(".spinner-overlay");
  if (!loader) {
    loader = document.createElement("div");
    loader.className = "spinner-overlay";
    loader.style = `
      position: absolute;
      inset: 0;
      background: rgba(255, 255, 255, 0.7);
      display: flex;
      justify-content: center;
      align-items: center;
      border-radius: 15px;
      z-index: 10;
    `;
    loader.innerHTML = `<div class="spinner" style="width:30px; height:30px; border-width: 4px; border-top-color: var(--primary);"></div>`;
    container.style.position = "relative";
    container.appendChild(loader);
  }

  try {
    const res = await fetch(`${SCRIPT_URL}?type=allStudents`);
    const data = await res.json();
  
    const subjects = ["lang1_arb", "lang1_skt", "lang1_mal1", "mal2", "maths", "eng", "bs", "ss", "mental", "current"];
    const shortNames = ["Arb", "Skt", "MI", "MII", "MM", "E", "BS", "SS", "MA", "CA"];

    const totals = new Array(subjects.length).fill(0);
    let totalExams = 0;

    const subjectIndexMap = {
      "lang1_arb": 5, "lang1_skt": 5, "lang1_mal1": 5,
      "mal2": 6, "maths":7, "eng":8, "bs":9, "ss":10,
      "mental":11, "current":12
    };

    // Count total exams (most consistent way)
    const examsPerName = {};
    data.forEach(row => {
      totalExams++; // count all records
      const subjTotals = {}; // temp per this row
      subjects.forEach((subj, i) => {
        if(subj.startsWith("lang1_")) {
          // Give all lang1 variants same column 5
          subjTotals[subj] = row[5];
        } else {
          const col = subjectIndexMap[subj];
          subjTotals[subj] = row[col] || 0;
        }
      });
      // Sum totals for each subject cumulatively
      subjects.forEach((subj, i) => {
        totals[i] += subjTotals[subj];
      });
    });

    document.getElementById("total-exams-count").innerText = `Total Exams: ${totalExams}`;

   // Replace near bottom of loadSubjectPointer()
if(subjectPointerChart) subjectPointerChart.destroy();

subjectPointerChart = new Chart(document.getElementById("subjectPointerChart"), {
  type: "line",
  data: {
    labels: shortNames,
    datasets: [{
      label: "Total Score",
      data: totals,
      borderColor: "var(--primary)",
      backgroundColor: "rgba(67,97,238,0.1)",
      tension: 0.4,
      fill: true,
      pointRadius: 5,
      pointHoverRadius: 7
    }]
  },
  options: {
    responsive: true,
    maintainAspectRatio: false,
    scales: {
      y: {
        beginAtZero: true,
        max: totalExams * 3,  // Set max dynamically here
        ticks: {
          stepSize: 10
        }
      }
    },
    plugins: {
      legend: {
        display: false
      }
    }
  }
});

    if (loader) loader.remove();
  } catch(e) {
    console.error("Error loading Subject Pointer:", e);
  }
}

async function loadSubjectProgress() {
  if (SCRIPT_URL === "YOUR_WEB_APP_URL") return;
  if (!user) return;
  showSubjectProgressLoading(true);  // Show spinner

  try {
    const res = await fetch(`${SCRIPT_URL}?name=${user.name}`);
    const data = await res.json();

    // Subject keys in fixed order and their short names
    const subjects = ["lang1_arb", "lang1_skt", "lang1_mal1", "mal2", "maths", "eng", "bs", "ss", "mental", "current"];
    const shortNames = ["Arb", "Skt", "MI", "MII", "MM", "E", "BS", "SS", "MA", "CA"];

    // Determine student's selected Language I from last exam if possible
    let selectedLangI = null;
    if (data.length > 0) {
      // Typically the subject lang1_* where user took exam 
      // Find the first non-zero in lang1_arb, lang1_skt, lang1_mal1 scores in last exam
      const lastExam = data[data.length - 1];
      const l1scores = {
        lang1_arb: lastExam[5],
        lang1_skt: lastExam[5],
        lang1_mal1: lastExam[5]
      };
      if(lastExam[5] > 0) {
        // We only know total L1 score, but assume all are the same column
        // We prompt Lang I selection from user for exact data, but we lack here
        selectedLangI = "lang1_arb"; // default
      }
    }

    // Prepare the data object with total scores per subject (sum over all exams)
    const totalScores = new Array(subjects.length).fill(0);
    const examCount = data.length;

    // Only include the selected Lang I, omit other lang1 variants
    // Determine which lang1 subject to consider based on last exam or user select
    // Here just take lang1_arb as default, you can enhance by integrating with current lang-select
    // We'll pick first lang1 with non-zero
    const lang1Subjects = ["lang1_arb", "lang1_skt", "lang1_mal1"];
    let selectedLangIndex = 0; // arb default
    for (let i = 0; i < lang1Subjects.length; i++) {
      const subj = lang1Subjects[i];
      // If user selected the same language in UI currently, use that
      const currentLang = document.getElementById("lang-select").value;
      if (currentLang && currentLang.startsWith(subj)) {
        selectedLangIndex = i;
        break;
      }
    }
    selectedLangI = lang1Subjects[selectedLangIndex];

    // Loop through exams, sum scores for all subjects but only add the selected language I score,
    // excluding the others
    const subjectColIndex = {
      lang1_arb: 5, lang1_skt: 5, lang1_mal1: 5,
      mal2: 6, maths: 7, eng: 8, bs: 9, ss: 10, mental: 11, current: 12
    };

    data.forEach(exam => {
      subjects.forEach((subj, i) => {
        if (lang1Subjects.includes(subj)) {
          if (subj !== selectedLangI) return; // skip other Lang I except selected
          totalScores[i] += exam[subjectColIndex[subj]] || 0;
        } else {
          totalScores[i] += exam[subjectColIndex[subj]] || 0;
        }
      });
    });

    // Filter the subjects to only include selectedLangI variant, not others
    // Actually totalScores already has zeros for skipped lang1, so just replace zeros with null for chart
    const chartLabels = [];
    const chartValues = [];
    subjects.forEach((subj, i) => {
      if(lang1Subjects.includes(subj)) {
        if(subj === selectedLangI) {
          chartLabels.push(shortNames[i]);
          chartValues.push(totalScores[i]);
        }
      } else {
        chartLabels.push(shortNames[i]);
        chartValues.push(totalScores[i]);
      }
    });

    // Show total exams outside chart
    document.getElementById("subject-progress-exams-count").innerText = `Total Exams: ${examCount}`;

    if(subjectProgressChart) subjectProgressChart.destroy();

    subjectProgressChart = new Chart(document.getElementById("subjectProgressChart"), {
  type: "line",
  data: {
    labels: chartLabels,
    datasets: [{
      label: "Total Score",
      data: chartValues,
      borderColor: "var(--primary)",
      backgroundColor: "rgba(67,97,238,0.1)",
      tension: 0.4,
      fill: true,
      pointRadius: 5,
      pointHoverRadius: 7
    }]
  },
  options: {
    responsive: true,
    maintainAspectRatio: false,
    scales: {
      y: {
        beginAtZero: true,
        max: examCount * 3,  // Set max dynamically here
        ticks: {
          stepSize: 10
        }
      }
    },
    plugins: {
      legend: {
        display: false
      }
    }
  }
});

    
    showSubjectProgressLoading(false); // Hide 

  } catch(e) {
    console.error("Error loading Subject Progress:", e);
  }
}

let subjectProgressChart = null;

// Modify showTab to load subject progress when tab5 is shown
const originalShowTab = showTab;
showTab = function(tid) {
  originalShowTab(tid);
  if(tid === "tab3") {
    loadSubjectProgress();
  }
};

function showSubjectProgressLoading(show) {
  const container = document.getElementById("subjectProgressChart").parentElement;
  let loader = container.querySelector(".spinner-overlay");
  if (show) {
    if (!loader) {
      loader = document.createElement("div");
      loader.className = "spinner-overlay";
      loader.style = `
        position: absolute;
        inset: 0;
        background: rgba(255, 255, 255, 0.7);
        display: flex;
        justify-content: center;
        align-items: center;
        border-radius: 15px;
        z-index: 10;
      `;
      loader.innerHTML = `<div class="spinner" style="width:30px; height:30px; border-width: 4px; border-top-color: var(--primary);"></div>`;
      container.style.position = "relative";
      container.appendChild(loader);
    }
  } else {
    if (loader) loader.remove();
  }
}


  
</script>
</body>
</html>
